import{i as B,k as y,r as a,m as O,o as R,j as e,b as w,A as N,B as f,d as U,q as z,s as re}from"./index-Cb3AN3R3.js";import{R as D}from"./index-C-hq6bKM.js";import{D as oe}from"./DeleteModal-De28Bu6M.js";import{S as V}from"./SavaCancel-CuKZ8TfL.js";import{P as ne}from"./Pagination-ClPqWgoN.js";import{S as ce}from"./SearchHeader-Cu036AJA.js";import"./index-Du0g9a49.js";import"./index-BK6gNoz8.js";const de=/^#([0-9A-F]{3}){1,2}$/i,ie=B().shape({status_name:y().required("status is required").lowercase(),color:y().matches(de,"Enter a valid hex color code").required("Color is required")}),xe=s=>{const[h,i]=a.useState(!1),{register:c,formState:{errors:o},handleSubmit:x,watch:n}=O({resolver:R(ie),mode:"all"}),j=async S=>{const d={...S,status:"active",created_by_user:localStorage.getItem("name")};try{i(!0);const m=localStorage.getItem("token"),u=await w.post(`${N}/status/post`,d,{headers:{Authorization:`Bearer ${m}`}});u.status===200?(f.success(" created Successfully"),i(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",u),i(!1),f.error("Failed to Upload"))}catch(m){console.error("Error in posting data",m),i(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Status"})}),e.jsxs("form",{onSubmit:x(j),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"status_name",children:"Status"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"status_name",type:"text",placeholder:"Status",...c("status_name")}),o.status_name&&e.jsx("p",{className:"text-red-500",children:o.status_name.message})]}),e.jsxs("div",{className:"mx-6 my-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"color",children:"Color"}),e.jsx("input",{className:"w-1/2 rounded-full outline-none bg-transparent",id:"color",type:"color",list:"allowed-colors",...c("color")}),e.jsxs("datalist",{id:"allowed-colors",children:[e.jsx("option",{value:"#111827"}),e.jsx("option",{value:"#14532d"}),e.jsx("option",{value:"#eab308"}),e.jsx("option",{value:"#1e40af"}),e.jsx("option",{value:"#65a30d"})]}),o.color&&e.jsx("p",{className:"text-red-500",children:o.color.message})]}),e.jsx(V,{onCancel:s.toggleModal,isLoading:h})]})]})})},me=/^#([0-9A-F]{3}){1,2}$/i,ue=B().shape({status_name:y().required("status is required").lowercase(),color:y().matches(me,"Enter a valid hex color code").required("Color is required"),status:y().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),he=s=>{const{status_id:h}=s,[i,c]=a.useState(!1),o=localStorage.getItem("token"),{register:x,formState:{errors:n},handleSubmit:j,watch:S,setValue:d}=O({resolver:R(ue),mode:"all"});a.useEffect(()=>{(async()=>{try{const g=await w.get(`${N}/status/getbyid?status_id=${h}`,{headers:{Authorization:`Bearer ${o}`}}),l=U(g.data.data);d("status_name",l.status_name),d("color",l.color),d("status",l.status)}catch(g){console.error("Error fetching data",g)}})()},[h,d]);const m=async u=>{const g={...u};try{c(!0);const l=await w.post(`${N}/status/update?status_id=${h}`,g,{headers:{Authorization:`Bearer ${o}`}});l.status===200?(f.success(" Updated Successfully"),c(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",l),c(!1),f.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l),c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 ",children:"Edit status"})}),e.jsxs("form",{onSubmit:j(m),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"status_name",children:"Status"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"status_name",type:"text",placeholder:"status ",...x("status_name")}),n.status_name&&e.jsx("p",{className:"text-red-500",children:n.status_name.message})]}),e.jsxs("div",{className:"mx-6 my-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"color",children:"Color"}),e.jsx("input",{className:"w-1/2 rounded-full outline-none bg-transparent",id:"color",type:"color",list:"allowed-colors",...x("color")}),e.jsxs("datalist",{id:"allowed-colors",children:[e.jsx("option",{value:"#111827"}),e.jsx("option",{value:"#14532d"}),e.jsx("option",{value:"#eab308"}),e.jsx("option",{value:"#1e40af"}),e.jsx("option",{value:"#65a30d"})]}),n.color&&e.jsx("p",{className:"text-red-500",children:n.color.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-4",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...x("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),n.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-2 mb-2 ",children:n.status.message})]}),e.jsx(V,{onCancel:s.toggleModal,isLoading:i})]})]})})},ve=({permissions:s})=>{const h=s==null?void 0:s.includes("create"),i=s==null?void 0:s.includes("edit"),c=s==null?void 0:s.includes("delete"),[o,x]=a.useState(!1),[n,j]=a.useState(!1),[S,d]=a.useState(null),[m,u]=a.useState(!1),[g,l]=a.useState(null),[v,T]=a.useState(""),[_,H]=a.useState(1),[p]=a.useState(8),[$,G]=a.useState(1),[ge,J]=a.useState([]),[A,K]=a.useState([]),[E,Q]=a.useState(null),M=localStorage.getItem("token"),I=t=>{Q(E===t?null:t)},W=t=>E===t;a.useEffect(()=>{C()},[v,_]);const X=t=>{t>0&&t<=$&&H(t)},C=()=>{w.get(`${N}/status/get`,{headers:{Authorization:`Bearer ${M}`}}).then(t=>{const r=U(t.data.data);K(r);const L=r.filter(ae=>Object.values(ae).some(le=>le.toString().toLowerCase().includes(v.toLowerCase())));G(Math.ceil(L.length/p));const q=_*p,se=q-p;J(L.slice(se,q))}).catch(t=>{console.error(t)})},Y=()=>{x(!o)},Z=()=>{j(!n),d(null)},P=()=>{u(!m),l(null)},k=_*p,b=k-p,F=A.filter(t=>Object.values(t).some(r=>r.toString().toLowerCase().includes(v.toLowerCase()))),ee=F.slice().reverse().slice(b,k),te=async()=>{try{await w.delete(`${N}/status/delete?status_id=${g}`,{headers:{Authorization:`Bearer ${M}`}}),P(),C(),f.success("Deleted successfully")}catch{f.error("Failed to delete")}};return e.jsxs(a.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen mt-10",children:[e.jsx(ce,{title:"Status",hasCreatePermission:h,onClick:()=>x(!0),searchValue:v,setSearchValue:T}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto  no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Status Name",e.jsx(D,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(D,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(D,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["UpdatedAt ",e.jsx(D,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 font-semibold font-lexend whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:ee.map((t,r)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-center whitespace-nowrap text-sm text-gray-700",children:b+r+1<10?`0${b+r+1}`:b+r+1})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:z(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:z(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(re,{onClick:()=>I(r)}),W(r)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[i&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{j(!0),d(t.status_id),I()},children:"Edit"}),c&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{u(!0),l(t.status_id),I()},children:"Delete"})]})]})})]},r))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsx(ne,{Length:A.length,currentPage:_,totalPages:$,firstIndex:b,lastIndex:k,paginate:X,hasNextPage:k>=F.length})})]})}),o&&e.jsx(xe,{toggleModal:Y,handlerefresh:C}),n&&e.jsx(he,{toggleModal:Z,handlerefresh:C,status_id:S}),m&&e.jsx(oe,{toggleDeleteModal:P,delete:te})]})};export{ve as default};
