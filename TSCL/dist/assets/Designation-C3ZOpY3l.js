import{i as X,k as P,r as n,m as ee,o as te,j as e,b as _,B as w,d as z,w as Ie,z as Pe,s as Oe,v as Te}from"./index-Cb3AN3R3.js";import{R as A}from"./index-C-hq6bKM.js";import{D as Ce}from"./DeleteModal-De28Bu6M.js";import{S as Ae,D as ke,E as Ge}from"./DocumentDownload-A0b-q8L_.js";import{S as ae}from"./SavaCancel-CuKZ8TfL.js";import{A as g}from"./ApiClient-w4qWO__2.js";import{B as Fe}from"./BulkUploadButton-C25cRLG1.js";import{P as Be}from"./Pagination-ClPqWgoN.js";import{F as Ue}from"./FileUploadButton-DWkzr3As.js";import{H as ze}from"./HeaderButton-By5upfsz.js";import"./index-Du0g9a49.js";import"./index-CmROlnnr.js";import"./index-BK6gNoz8.js";const Le=X().shape({org_name:P().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:P().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:P().required("Designation is required")}),Me=({ExistingOrganiZations:a,ExistingDepartments:O,toggleModal:S,handlerefresh:k})=>{const[v,h]=n.useState(!1),{register:u,formState:{errors:m},handleSubmit:N}=ee({resolver:te(Le),mode:"all"}),T=async o=>{const i={...o,status:"active",created_by_user:localStorage.getItem("name")};try{h(!0);const l=await _.post(g.POST_DESIGANATION.url,i,{headers:g.POST_DESIGANATION.headers});l.status===200?(w.success("Designatiom created Successfully"),h(!1),S(),k()):(console.error("Error in posting data",l),h(!1),w.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l),h(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[460px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-8 pb-2",children:"Add Desgination"})}),e.jsxs("form",{onSubmit:N(T),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...u("org_name"),children:[e.jsx("option",{value:"",children:"Select Organization"}),a.map((o,i)=>e.jsx("option",{value:o.org_name,children:o.org_name},i))]}),m.org_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.org_name.message})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...u("dept_name"),children:[e.jsx("option",{value:"",children:"Select Department"}),O.map((o,i)=>e.jsx("option",{value:o.dept_name,children:o.dept_name},i))]}),m.dept_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.dept_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Designation"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Designation Name",...u("designation")}),m.designation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.designation.message})]})]}),e.jsx(ae,{onCancel:S,isLoading:v})]})]})})},Ve=X().shape({org_name:P().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:P().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:P().required("Designation is required"),status:P().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),Re=({ExistingOrganiZations:a,ExistingDepartments:O,toggleModal:S,handlerefresh:k,desgId:v})=>{const[h,u]=n.useState(null),[m,N]=n.useState(null),[T,o]=n.useState(!1),{register:i,formState:{errors:l},handleSubmit:L,setValue:y,watch:M}=ee({resolver:te(Ve),mode:"all"});n.useEffect(()=>{(async()=>{try{const x=g.FETCH_DESIGNATION(v),p=await _.get(x.url,{headers:x.headers}),f=z(p.data.data);y("org_name",f.org_name),u(f.org_name),y("dept_name",f.dept_name),N(f.dept_name),y("designation",f.designation),y("status",f.status)}catch(x){console.error("Error fetching data",x)}})()},[v,y]);const V=async r=>{const x={...r};try{o(!0);const p=g.UPDATE_DESIGNATION(v),f=await _.post(p.url,x,{headers:p.headers});f.status===200?(w.success("Desgination Updated Successfully"),o(!1),u(null),N(null),S(),k()):(console.error("Error in posting data",f),o(!1),w.error("Failed to Upload"))}catch(p){console.error("Error in posting data",p),o(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[420px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Desgination"})}),e.jsxs("form",{onSubmit:L(V),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...i("org_name"),onChange:r=>u(r.target.value),children:[e.jsx("option",{value:h,disabled:!0,children:h}),a.map((r,x)=>e.jsx("option",{value:r.org_name,children:r.org_name},x))]}),l.org_name&&e.jsx("p",{className:"text-red-500",children:l.org_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...i("dept_name"),onChange:r=>N(r.target.value),children:[e.jsx("option",{value:m,disabled:!0,children:m}),O.map((r,x)=>e.jsx("option",{value:r.dept_name,children:r.dept_name},x))]}),l.dept_name&&e.jsx("p",{className:"text-red-500",children:l.dept_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Desgination"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Desgination Name",...i("designation")}),l.designation&&e.jsx("p",{className:"text-red-500",children:l.designation.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...i("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),l.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:l.status.message})]})]}),e.jsx(ae,{onCancel:S,isLoading:T})]})]})})},$e=`designation,dept_name,org_name,status,created_by_user
Designation,Department,Organization,active,admin`,ot=({permissions:a})=>{const O=a==null?void 0:a.includes("create"),S=a==null?void 0:a.includes("edit"),k=a==null?void 0:a.includes("delete"),v=a==null?void 0:a.includes("download"),[h,u]=n.useState(!1),[m,N]=n.useState(!1),[T,o]=n.useState(!1),[i,l]=n.useState(null),[L,y]=n.useState(null),[M,V]=n.useState(null),[r,x]=n.useState(null),[p,f]=n.useState(""),[B,$]=n.useState(1),[E,se]=n.useState(10),[q,ne]=n.useState(1),[qe,le]=n.useState([]),[j,H]=n.useState([]),[Z,oe]=n.useState(null);localStorage.getItem("token");const[re,Y]=n.useState(null),[J,K]=n.useState("Bulk Upload"),[ce,ie]=n.useState(null),R=t=>{oe(Z===t?null:t)},de=t=>Z===t;n.useEffect(()=>{G(),ue(),pe()},[p,B,E]);const me=t=>{t>0&&t<=q&&$(t)},G=()=>{_.get(g.GET_DESIGNATION.url,{headers:g.GET_DESIGNATION.headers}).then(t=>{const s=z(t.data.data);H(s);const D=s.filter(c=>Object.values(c).some(d=>d.toString().toLowerCase().includes(p.toLowerCase())));ne(Math.ceil(D.length/E));const b=B*E,I=b-E;le(D.slice(I,b))})},xe=()=>{u(!h)},ge=()=>{N(!m),y(null)},he=()=>{u(!h)},Q=()=>{o(!T),l(null)},ue=async()=>{try{const t=await _.get(g.GET_ORG_DESIGNATIONACTIVE.url,{headers:g.GET_ORG_DESIGNATIONACTIVE.headers}),s=z(t.data.data);V(s)}catch(t){console.error("Error fetching existing Organisations:",t)}},pe=async()=>{try{const t=await _.get(g.GET_DEPT_DESIGNATIONACTIVE.url,{headers:g.GET_DEPT_DESIGNATIONACTIVE.headers}),s=z(t.data.data);x(s)}catch(t){console.error("Error fetching existing Departments:",t)}},U=B*E,F=U-E,W=j.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(p.toLowerCase()))),fe=W.slice().reverse().slice(F,U),je=async()=>{try{const t=g.DELETE_DESIGNATION(i);await _.delete(t.url,{headers:t.headers}),Q(),G(),H(j.filter(s=>j.desgination_id!==i)),w.success("Deleted successfully")}catch{w.error("Failed to delete")}},be=t=>{Y(t.target.files[0]),K("Upload")},Ne=()=>{J==="Bulk Upload"?document.getElementById("fileInput").click():ye(re)},ye=async t=>{try{const s=new FormData;s.append("file",t),(await _.post(g.UPLOAD_DESIGNATION.url,s,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(K("Bulk Upload"),Y(null),G(),w.success("Data Uploaded Successfully")):w.error("Data failed to Upload")}catch(s){console.log(s)}},De=t=>{ie(t.target.value)},_e=async t=>{if(t==="csv"){const s=j.map(d=>({desgination_id:d.desgination_id,designation:d.designation,dept_name:d.dept_name,org_name:d.org_name,status:d.status,created_by_user:d.created_by_user})),D=[Object.keys(s[0]).join(","),...s.map(d=>Object.values(d).join(","))].join(`
`),b=new Blob([D],{type:"text/csv;charset=utf-8;"}),I=window.URL.createObjectURL(b),c=document.createElement("a");c.setAttribute("href",I),c.setAttribute("download","Designation_data.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}else if(t==="pdf")try{const D=Math.ceil(j.length/30),b=new Ge("l","mm","a4");let I=0;for(let c=1;c<=D;c++){const d=(c-1)*30,ve=Math.min(d+30,j.length),Ee=j.slice(d,ve).map(C=>[C.desgination_id,C.designation,C.dept_name,C.org_name,C.status,C.created_by_user]);b.text(`Page ${c}`,10,I+10),b.autoTable({startY:I+15,head:[["Designation ID","Designation","DeptName","OrgName","Status","createdBy"]],body:Ee,theme:"striped"}),c<D&&(b.addPage(),I=10)}b.save("Designation_data.pdf")}catch(s){console.error("Error exporting data:",s)}},we=()=>{Te($e)},Se=t=>{const s=parseInt(t.target.value,10);se(s),$(1)};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-2 mx-8 flex-wrap",children:[e.jsx(Ae,{value:p,onChange:t=>f(t.target.value),placeholder:"Search Designation"}),O&&e.jsx(Ue,{onChange:be,buttonText:J,accept:".csv",onClick:Ne}),v&&e.jsx(ke,{selectedDoc:ce,onChange:De,exportData:_e})]}),e.jsx(ze,{title:"Designation",hasCreatePermission:O,onClick:()=>u(!0)}),e.jsxs("div",{className:`bg-white  mx-4 rounded-lg overflow-x-auto mt-1  p-3 ${j.length<5?"h-3/5":"h-fit"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mx-3",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"font-medium text-gray-600",children:"Page Entries"}),e.jsxs("select",{id:"itemsPerPage",value:E,onChange:Se,className:" p-1 outline-none text-sm rounded px-2",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]}),e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Designation ",e.jsx(A,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Department Name ",e.jsx(A,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Org Name ",e.jsx(A,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold  whitespace-nowrap",children:["Status ",e.jsx(A,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(A,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(A,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-semibold font-lexend  whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:fe.map((t,s)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center text-gray-800",children:F+s+1<10?`0${F+s+1}`:F+s+1})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.designation})}),e.jsx("td",{children:e.jsxs("div",{className:"flex  gap-2 items-center justify-start mx-3 my-3  text-sm text-gray-800",children:[e.jsx("img",{src:Ie,alt:"logo",className:"w-8 h-8"}),e.jsxs("p",{className:"font-lexend whitespace-nowrap capitalize   text-gray-800",children:[" ",t.dept_name]})]})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.org_name})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2  font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-800 ",children:Pe(t.createdAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Oe,{onClick:()=>R(s)}),de(s)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[S&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{N(!0),y(t.desgination_id),R()},children:"Edit"}),k&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{o(!0),l(t.desgination_id),R()},children:"Delete"})]})]})})]},s))})]})]}),e.jsxs("div",{className:" my-2 mb-5 mx-7",children:[e.jsx(Fe,{handleDownload:we}),e.jsx(Be,{Length:j.length,currentPage:B,totalPages:q,firstIndex:F,lastIndex:U,paginate:me,hasNextPage:U>=W.length})]})]})}),h&&e.jsx(Me,{toggleModal:xe,toggleCloseModal:he,ExistingOrganiZations:M,ExistingDepartments:r,handlerefresh:G}),m&&e.jsx(Re,{toggleModal:ge,handlerefresh:G,ExistingOrganiZations:M,ExistingDepartments:r,desgId:L}),T&&e.jsx(Ce,{toggleDeleteModal:Q,delete:je})]})};export{ot as default};
