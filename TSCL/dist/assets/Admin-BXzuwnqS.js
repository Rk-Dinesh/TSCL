import{c as J,a as c,r,u as K,o as Q,j as e,b as N,A as y,B as $,d as q,I as ce,F as H,R as xe,e as f,g as me,D as he}from"./index-B6bLt-HT.js";const pe=J().shape({user_name:c().required("User Name is required"),dept_name:c().required("Department is required"),phone:c().required("Phone Number is required"),email:c().required("Email Id  is required"),address:c().required("Address is required"),login_password:c().required("Password is required"),pincode:c().required("Pincode is required"),role:c().test("not-select","Please select a Role",a=>a!==""&&a!=="Role")}),ue=a=>{const{ExistingRoles:g,ExistingDept:v}=a,[j,w]=r.useState(""),{register:x,formState:{errors:l},handleSubmit:b}=K({resolver:Q(pe),mode:"all"}),k=d=>{const m=d.target.value,n=g.find(h=>h.role_name===m);w(n?n.role_id:"")},_=async d=>{const m={...d,status:"active",created_by_user:"admin",role_id:j},n=sessionStorage.getItem("token");try{const h=await N.post(`${y}/user/post`,m,{headers:{Authorization:`Bearer ${n}`}});h.status===200?($.success(h.data.message),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",h),$.error("Failed to Upload"))}catch(h){console.error("Error in posting data",h)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center",children:e.jsx("div",{className:"bg-white w-fit h-fit font-lexend m-2",children:e.jsxs("form",{onSubmit:b(_),children:[e.jsxs("div",{className:"border-b-2 border-gray-300 mx-10 my-5",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"block text-black text-lg font-medium mb-2 col-span-1 whitespace-nowrap",htmlFor:"user_name",children:"Name:"}),e.jsx("input",{type:"text",id:"user_name",className:"mx-2 font-lexend px-2 text-sm text-end outline-none col-span-2",placeholder:"User Name",...x("user_name")})]}),l.user_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.user_name.message})]}),e.jsxs("div",{className:"flex flex-col gap-3 mx-10 my-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-2",htmlFor:"dept_name",children:"Department:"}),e.jsxs("select",{className:"text-sm text-black border border-gray-900 rounded-lg border-none outline-none",id:"dept_name",...x("dept_name"),children:[e.jsx("option",{value:"",children:"Department"}),v.map(d=>e.jsx("option",{value:d.dept_name,children:d.dept_name},d.dept_id))]})]}),l.dept_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.dept_name.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-1",htmlFor:"phone",children:"Phone:"}),e.jsx("input",{type:"text",id:"phone",className:"w-6/5 text-end outline-none col-span-2",placeholder:"Phone Number",...x("phone")})]}),l.phone&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.phone.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-1",htmlFor:"email",children:"Email Id:"}),e.jsx("input",{type:"email",id:"email",className:"text-end outline-none col-span-2",placeholder:"abc@gmail.com",...x("email")})]}),l.email&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.email.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-1",htmlFor:"address",children:"Address:"}),e.jsx("input",{type:"text",id:"address",className:"text-end outline-none col-span-2",placeholder:"Address",...x("address")})]}),l.address&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.address.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-1",htmlFor:"pincode",children:"Pincode:"}),e.jsx("input",{type:"text",id:"pincode",className:"text-end outline-none col-span-2",placeholder:"Pincode",...x("pincode")})]}),l.pincode&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.pincode.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-2",htmlFor:"role",children:"Role:"}),e.jsxs("select",{className:"text-sm text-black border border-gray-900 rounded-lg border-none outline-none",id:"role",...x("role"),onChange:k,children:[e.jsx("option",{value:"",children:"Role"}),g.map(d=>e.jsx("option",{value:d.role_name,children:d.role_name},d.role_id))]})]}),l.role&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.role.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"text-black text-lg font-medium mb-2 col-span-1",htmlFor:"login_password",children:"Password:"}),e.jsx("input",{type:"password",id:"login_password",className:"text-end outline-none col-span-2",placeholder:"Password",...x("login_password")})]}),l.login_password&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:l.login_password.message})]})]}),e.jsxs("div",{className:"flex justify-end py-6 mx-10 my-3 gap-5",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleModal,children:"Cancel"}),e.jsx("button",{className:"text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})})})},ge=J().shape({user_name:c().required("User Name is required"),dept_name:c().required("Department is required"),address:c().required("Address is required"),pincode:c().required("Pincode is required"),status:c().test("not-select","Please select an Status",a=>a!==""&&a!=="Status"),role:c().test("not-select","Please select an Role",a=>a!==""&&a!=="Role")}),je=a=>{const{ExistingRoles:g,ExistingDept:v,adminId:j}=a,[w,x]=r.useState(null),[l,b]=r.useState(null),[k,_]=r.useState(null),d=sessionStorage.getItem("token"),{register:m,formState:{errors:n},handleSubmit:h,setValue:p,watch:U}=K({resolver:Q(ge),mode:"all"});r.useEffect(()=>{(async()=>{try{const u=await N.get(`${y}/user/getbyid?user_id=${j}`,{headers:{Authorization:`Bearer ${d}`}}),s=q(u.data.data);p("user_name",s.user_name),p("dept_name",s.dept_name),x(s.dept_name),p("address",s.address),p("pincode",s.pincode),b(s.role),p("role_id",s.role_id),p("role",s.role),p("status",s.status)}catch(u){console.error("Error fetching data",u)}})()},[j,p]);const E=i=>{const u=i.target.value,s=g.find(M=>M.role_name===u);s&&_(s.role_id)},F=async i=>{const u={...i,role_id:k};try{const s=await N.post(`${y}/user/update?user_id=${j}`,u,{headers:{Authorization:`Bearer ${d}`}});s.status===200?($.success(s.data.message),x(null),b(null),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",s),$.error("Failed to Upload"))}catch(s){console.error("Error in posting data",s)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsx("div",{className:"bg-white w-fit h-fit  font-lexend m-2",children:e.jsxs("form",{onSubmit:h(F),children:[e.jsxs("div",{className:"border-b-2 border-gray-300 mx-10 my-5",children:[e.jsxs("div",{className:" grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"block text-black text-lg font-medium mb-2 col-span-1 whitespace-nowrap",htmlFor:"user_name",children:"Name :"}),e.jsx("input",{type:"text",id:"user_name",className:"mx-2 font-lexend px-2 text-sm text-end outline-none col-span-2",placeholder:"User Name",...m("user_name")})]}),n.user_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.user_name.message})]}),e.jsxs("div",{className:" flex flex-col gap-3 mx-10 my-1 ",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-2",htmlFor:"dept_name",children:"Department :"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"dept_name",...m("dept_name"),children:[e.jsx("option",{value:w,hidden:!0,children:w}),v.map(i=>e.jsx("option",{value:i.dept_name,children:i.dept_name},i.dept_id))]})]}),n.dept_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.dept_name.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"address",children:"Address :"}),e.jsx("input",{type:"text",id:"address",className:" text-end outline-none col-span-2",placeholder:"Address",...m("address")})]}),n.address&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.address.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"pincode",children:"Pincode :"}),e.jsx("input",{type:"text",id:"pincode",className:" text-end outline-none col-span-2",placeholder:"Pincode ",...m("pincode")})]}),n.pincode&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.pincode.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-2",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...m("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),n.status&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.status.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-2",htmlFor:"role",children:"Role:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"role",...m("role"),onChange:E,children:[e.jsx("option",{value:l,hidden:!0,children:l}),g.map(i=>e.jsx("option",{value:i.role_name,children:i.role_name},i.role_name))]})]}),n.role&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:n.role.message})]})]}),e.jsxs("div",{className:"flex justify-end  py-6 mx-10 my-3 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})})})},Ne=({permissions:a})=>{const[g,v]=r.useState(!1),j=a==null?void 0:a.includes("create"),w=a==null?void 0:a.includes("edit"),x=a==null?void 0:a.includes("delete"),[l,b]=r.useState(!1),[k,_]=r.useState(null),[d,m]=r.useState(!1),[n,h]=r.useState(null),[p,U]=r.useState(null),[E,F]=r.useState(null),[i,u]=r.useState(""),[s,M]=r.useState(1),[S]=r.useState(8),[D,W]=r.useState(1),[be,X]=r.useState([]),[z,Y]=r.useState([]),[L,Z]=r.useState(null),P=sessionStorage.getItem("token"),B=t=>{Z(L===t?null:t)},ee=t=>L===t;r.useEffect(()=>{I(),ae(),le()},[i,s]);const A=t=>{t>0&&t<=D&&M(t)},I=()=>{N.get(`${y}/user/get`,{headers:{Authorization:`Bearer ${P}`}}).then(t=>{const o=q(t.data.data);Y(o);const T=o.filter(ie=>Object.values(ie).some(oe=>oe.toString().toLowerCase().includes(i.toLowerCase())));W(Math.ceil(T.length/S));const G=s*S,de=G-S;X(T.slice(de,G))}).catch(t=>{console.error(t)})},te=()=>{v(!g)},se=()=>{b(!l),_(null)},O=()=>{m(!d),h(null)},ae=async()=>{try{const t=await N.get(`${y}/role/getactive`,{headers:{Authorization:`Bearer ${P}`}}),o=q(t.data.data);U(o)}catch(t){console.error("Error fetching existing Roles:",t)}},le=async()=>{try{const t=await N.get(`${y}/department/getactive`,{headers:{Authorization:`Bearer ${P}`}}),o=q(t.data.data);F(o)}catch(t){console.error("Error fetching existing Department:",t)}},R=s*S,C=R-S,V=z.filter(t=>Object.values(t).some(o=>o.toString().toLowerCase().includes(i.toLowerCase()))),re=V.slice(C,R),ne=async()=>{try{await N.delete(`${y}/user/delete?user_id=${n}`,{headers:{Authorization:`Bearer ${P}`}}),O(),I(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(r.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("p",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-full",children:[e.jsx(ce,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Admin",value:i,onChange:t=>u(t.target.value)})]}),j&&e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 border-blue-500  font-lexend bg-slate-100 text-blue-500 rounded-full px-3 py-1.5 justify-center",children:[" ",e.jsx(H,{}),"Bulk Upload"]})}),e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 bg-slate-100  font-lexend text-black rounded-full px-3 py-1.5 w-28 justify-between",children:[" ","CSV ",e.jsx(xe,{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-2xl text-lg font-medium   font-lexend",children:"TSCL User"}),j&&e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex flex-row-2 gap-2  items-center border-2  font-lexend bg-blue-500 text-white rounded-full p-2.5 w-fit justify-between md:text-base text-sm",onClick:()=>v(!0),children:[e.jsx(H,{})," Add User"]})})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3  h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Username ",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Department",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-3  my-2 font-lexend font-semibold whitespace-nowrap",children:["Phone",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Email",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Status",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Role",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["CreatedBy",e.jsx(f,{})]})}),e.jsx("th",{children:e.jsx("div",{className:"mx-1 my-3 text-start font-lexend font-semibold whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:re.map((t,o)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsxs("p",{className:"text-center text-sm mx-4 my-2 font-lexend whitespace-nowrap",children:[" ",C+o+1<10?`0${C+o+1}`:C+o+1]})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize",children:t.user_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm  mx-1  my-2  font-lexend whitespace-nowrap capitalize",children:t.dept_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-3  my-2 font-lexend whitespace-nowrap capitalize",children:t.phone})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1  my-2 font-lexend whitespace-nowrap capitalize",children:t.email})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1  my-2 font-lexend whitespace-nowrap capitalize",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1  my-2 font-lexend whitespace-nowrap capitalize",children:t.role})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1  my-2 font-lexend whitespace-nowrap capitalize",children:t.created_by_user})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(me,{onClick:()=>B(o)}),ee(o)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[w&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{b(!0),_(t.user_id),B()},children:"Edit"}),x&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{m(!0),h(t.user_id),B()},children:"Delete"})]})]})})]},o))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[C+1," to ",Math.min(R,z.length)]})," ","of ",e.jsxs("span",{className:"text-gray-900",children:[z.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>A(1),disabled:s===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(s-1),disabled:s===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:D},(t,o)=>o+1).slice(Math.max(0,s-2),Math.min(D,s+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>A(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${s===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(s+1),disabled:R>=V.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(D),disabled:s===D,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),g&&e.jsx(ue,{toggleModal:te,handlerefresh:I,ExistingRoles:p,ExistingDept:E}),l&&e.jsx(je,{toggleModal:se,handlerefresh:I,ExistingRoles:p,ExistingDept:E,adminId:k}),d&&e.jsx(he,{toggleDeleteModal:O,delete:ne})]})};export{Ne as default};
