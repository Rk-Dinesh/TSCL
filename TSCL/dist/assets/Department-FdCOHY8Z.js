import{c as H,a as O,r as a,u as J,o as K,j as e,b as v,A as _,B as M,d as F,I as de,F as T,R as ie,e as w,l as me,f as G,g as xe,D as he}from"./index-Ck5knsAu.js";const pe=H().shape({org_name:O().test("not-select","Please select an Organization",s=>s!==""&&s!=="Select  Organization"),dept_name:O().required("Department is required")}),ge=({ExistingOrganiZations:s,toggleModal:g,handlerefresh:S})=>{const[b,y]=a.useState(null),[i,m]=a.useState(null),{register:p,formState:{errors:x},handleSubmit:u,watch:h}=J({resolver:K(pe),mode:"all"});a.useEffect(()=>{if(i){const r=s.find(j=>j.org_name===i);r&&y(r.org_id)}},[i,s]);const N=async r=>{const j={...r,org_id:b,status:"active",created_by_user:"admin"};try{const f=sessionStorage.getItem("token"),n=await v.post(`${_}/department/post`,j,{headers:{Authorization:`Bearer ${f}`}});n.status===200?(M.success("Department created Successfully"),g(),S()):(console.error("Error in posting data",n),M.error("Failed to Upload"))}catch(f){console.error("Error in posting data",f)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Department"})}),e.jsxs("form",{onSubmit:u(N),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...p("org_name"),onChange:r=>m(r.target.value),children:[e.jsx("option",{value:"",children:"Select Organization"}),s.map(r=>e.jsx("option",{value:r.org_name,children:r.org_name},r.org_id))]}),x.org_name&&e.jsx("p",{className:"text-red-500",children:x.org_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"dept_name",children:"Department Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",type:"text",placeholder:"Department Name",...p("dept_name")}),x.dept_name&&e.jsx("p",{className:"text-red-500",children:x.dept_name.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10 gap-5",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:g,children:"Cancel"}),e.jsx("button",{className:"text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},ue=H().shape({org_name:O().test("not-select","Please select an Organization",s=>s!==""&&s!=="Select  Organization"),dept_name:O().required("Department is required"),status:O().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),fe=({ExistingOrganiZations:s,toggleModal:g,handlerefresh:S,deptId:b})=>{const[y,i]=a.useState(null),[m,p]=a.useState(null),x=sessionStorage.getItem("token"),{register:u,formState:{errors:h},handleSubmit:N,setValue:r,watch:j}=J({resolver:K(ue),mode:"all"});a.useEffect(()=>{(async()=>{try{const o=await v.get(`${_}/department/getbyid?dept_id=${b}`,{headers:{Authorization:`Bearer ${x}`}}),c=F(o.data.data);r("org_name",c.org_name),p(c.org_name),r("dept_name",c.dept_name),r("status",c.status)}catch(o){console.error("Error fetching data",o)}})()},[b,r]),a.useEffect(()=>{if(m){const n=s.find(o=>o.org_name===m);n&&i(n.org_id)}},[m,s]);const f=async n=>{const o={...n};try{const c=await v.post(`${_}/department/update?dept_id=${b}`,o,{headers:{Authorization:`Bearer ${x}`}});c.status===200?(M.success("Department Updated Successfully"),p(null),i(null),g(),S()):(console.error("Error in posting data",c),M.error("Failed to Upload"))}catch(c){console.error("Error in posting data",c)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Department"})}),e.jsxs("form",{onSubmit:N(f),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...u("org_name"),onChange:n=>p(n.target.value),children:[e.jsx("option",{value:m,children:m}),s.map(n=>e.jsx("option",{value:n.org_name,children:n.org_name},n.org_id))]}),h.org_name&&e.jsx("p",{className:"text-red-500",children:h.org_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",type:"text",placeholder:"Department Name",...u("dept_name")}),h.dept_name&&e.jsx("p",{className:"text-red-500",children:h.dept_name.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...u("status"),children:[e.jsx("option",{value:"",children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),h.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:h.status.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10 gap-5",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:g,children:"Cancel"}),e.jsx("button",{className:"text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},ye=({permissions:s})=>{const g=s==null?void 0:s.includes("create"),S=s==null?void 0:s.includes("edit"),b=s==null?void 0:s.includes("delete"),[y,i]=a.useState(!1),[m,p]=a.useState(!1),[x,u]=a.useState(!1),[h,N]=a.useState(null),[r,j]=a.useState(null),[f,n]=a.useState(null),[o,c]=a.useState(""),[d,Q]=a.useState(1),[D]=a.useState(8),[k,W]=a.useState(1),[be,X]=a.useState([]),[C,B]=a.useState([]),[L,Y]=a.useState(null),P=sessionStorage.getItem("token"),z=t=>{Y(L===t?null:t)},Z=t=>L===t;a.useEffect(()=>{$(),ae()},[o,d]);const I=t=>{t>0&&t<=k&&Q(t)},$=()=>{v.get(`${_}/department/get`,{headers:{Authorization:`Bearer ${P}`}}).then(t=>{const l=F(t.data.data);B(l);const q=l.filter(oe=>Object.values(oe).some(ce=>ce.toString().toLowerCase().includes(o.toLowerCase())));W(Math.ceil(q.length/D));const R=d*D,le=R-D;X(q.slice(le,R))})},ee=()=>{i(!y)},te=()=>{p(!m),j(null)},se=()=>{i(!y)},U=()=>{u(!x),N(null)},ae=async()=>{try{const t=await v.get(`${_}/organization/getactive`,{headers:{Authorization:`Bearer ${P}`}}),l=F(t.data.data);n(l)}catch(t){console.error("Error fetching existing Organisations:",t)}},E=d*D,A=E-D,V=C.filter(t=>Object.values(t).some(l=>l.toString().toLowerCase().includes(o.toLowerCase()))),re=V.slice(A,E),ne=async()=>{try{await v.delete(`${_}/department/delete?dept_id=${h}`,{headers:{Authorization:`Bearer ${P}`}}),U(),$(),B(C.filter(t=>C.dept_id!==h)),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(a.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white py-1.5 px-3 rounded-full",children:[e.jsx(de,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Department",value:o,onChange:t=>c(t.target.value)})]}),g&&e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2  items-center border-2 font-lexend border-blue-500 bg-slate-100 text-blue-500 rounded-full px-3 py-1.5 justify-center",children:[" ",e.jsx(T,{}),"Bulk Upload"]})}),e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 font-lexend bg-slate-100 text-black rounded-full p-2 w-32 justify-between",children:[" ","CSV ",e.jsx(ie,{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium  font-lexend",children:"Department"}),g&&e.jsxs("button",{className:"flex  gap-2  items-center border-2 bg-blue-500 text-white font-lexend rounded-full p-2 w-fit justify-between",onClick:()=>i(!0),children:[e.jsx(T,{})," Add Department"]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 overflow-x-auto h-3/5 no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Department Name ",e.jsx(w,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Org Name ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold  whitespace-nowrap",children:["Status ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Last UpdatedAt ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-semibold font-lexend  whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:re.map((t,l)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center",children:A+l+1<10?`0${A+l+1}`:A+l+1})}),e.jsx("td",{children:e.jsxs("div",{className:"flex  gap-2 items-center justify-start mx-5 my-3  text-sm",children:[e.jsx("img",{src:me,alt:"logo",className:"w-8 h-8"}),e.jsxs("p",{className:"font-lexend whitespace-nowrap  ",children:[" ",t.dept_name]})]})}),e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm",children:t.org_name})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1.5  my-2  font-lexend text-start whitespace-nowrap text-sm",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm ",children:G(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm",children:G(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(xe,{onClick:()=>z(l)}),Z(l)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[S&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{p(!0),j(t.dept_id),z()},children:"Edit"}),b&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{u(!0),N(t.dept_id),z()},children:"Delete"})]})]})})]},l))})]})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[A+1," to ",Math.min(E,C.length)]})," ","of"," ",e.jsxs("span",{className:"text-gray-900",children:[C.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>I(1),disabled:d===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>I(d-1),disabled:d===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:k},(t,l)=>l+1).slice(Math.max(0,d-2),Math.min(k,d+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>I(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${d===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>I(d+1),disabled:E>=V.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>I(k),disabled:d===k,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),y&&e.jsx(ge,{toggleModal:ee,toggleCloseModal:se,ExistingOrganiZations:f,handlerefresh:$}),m&&e.jsx(fe,{toggleModal:te,handlerefresh:$,ExistingOrganiZations:f,deptId:r}),x&&e.jsx(he,{toggleDeleteModal:U,delete:ne})]})};export{ye as default};
