import{i as V,k as x,q as se,r as o,l as re,o as ne,j as e,I as oe,b as D,A as S,B as C,d as H,n as Pe}from"./index-B-YhHBab.js";import{R as N,P as Le}from"./Pagination-DoNtECT-.js";import{D as Te}from"./DeleteModal-BhbeyLgd.js";import{S as $e,D as Re,E as Me}from"./DocumentDownload-C6yILlzs.js";import{F as Ie,B as ze}from"./FileUploadButton-CZ7XzdX5.js";import{H as Be}from"./HeaderButton-DsXCe15j.js";import"./index-BnDzthMN.js";import"./index-DCU07Eno.js";import"./index-D011Getu.js";const q=[{id:1,title:"Complaint Details"},{id:2,title:"Escalation Details"}],ae=V().shape({complaint_type_title:x().required("complaint_type is required"),dept_name:x().test("not-select","select an Department",a=>a!==""&&a!=="Select an Department"),tat_type:x().test("not-select","select an TAT Type",a=>a!==""&&a!=="Select Type"),tat_duration:x().required("Duration is required"),priority:x().required("Priority is required")}),Ae=V().shape({escalation_type:x().test("not-select","select an Type",a=>a!==""&&a!=="Select Type"),escalation_l1:se().required("L1 duration is required"),role_l1:x().test("not-select","select an L1 role",a=>a!==""&&a!=="Select an Role"),escalation_l2:x().optional(),role_l2:x().optional(),escalation_l3:x().optional(),role_l3:x().optional()}),Ue=a=>{const[c,E]=o.useState(0),{ExistingDept:$,ExistingRoles:F}=a;let f;switch(c){case 0:f=ae;break;case 1:f=Ae;break;default:f=ae}o.useEffect(()=>{},[c]);const{register:h,formState:{errors:l},handleSubmit:R}=re({resolver:ne(f),mode:"all"}),P=async d=>{if(c!==q.length-1)E(c+1);else{const j={...d,status:"active",created_by_user:sessionStorage.getItem("name")};try{const k=sessionStorage.getItem("token"),w=await D.post(`${S}/complaint/post`,j,{headers:{Authorization:`Bearer ${k}`}});w.status===200?(C.success("Complaint created Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",w),C.error("Failed to Upload"))}catch(k){console.error("Error in posting data",k)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center flex-wrap",children:e.jsx("div",{className:"overflow-hidden shadow-lg bg-white flex items-end justify-between relative font-alegerya mx-2 ",children:e.jsx("div",{className:"min-w-[390px] min-h-[350px] ",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center px-5 text-white bg-primary h-12 flex-wrap",children:[e.jsx("p",{className:"",children:"New Complaint"}),e.jsx("button",{onClick:a.toggleModal,className:"",children:e.jsx(oe,{className:"text-2xl"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-9 relative justify-center mx-60 py-1 rounded-full bg-slate-200 mt-4",children:q.map((d,j)=>e.jsxs("div",{className:"relative items-center item flex last:flex-none group",children:[e.jsx("div",{className:`${c>=j?"bg-black text-white":"bg-white text-slate-900"} transition duration-150 icon-box h-8 w-8 rounded-full flex flex-col items-center justify-center relative z-[66] text-base font-medium`,children:e.jsx("span",{children:j+1})}),j!==q.length-1&&e.jsx("div",{className:`${c>j?"bg-green-900":"bg-[#E0EAFF]"} absolute top-1/2 h-[2px] w-full z-[65]`})]},j))}),e.jsx("div",{className:"conten-box mx-8 my-4",children:e.jsxs("form",{onSubmit:R(P),children:[c===0&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Create Complaint"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"complaint_type_title",children:"Complaint"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline  col-span-2",id:"complaint_type_title",type:"text",placeholder:"Complaint",...h("complaint_type_title")}),l.complaint_type_title&&e.jsx("p",{className:"text-red-500 text-sm text-start -mt-3",children:l.complaint_type_title.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"dept_name",children:"Department"}),e.jsxs("select",{className:"col-span-2  block outline-none px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("dept_name"),id:"dept_name",children:[e.jsx("option",{value:"",children:"Select an Department"}),$.map(d=>e.jsx("option",{value:d.dept_name,children:d.dept_name},d.dept_id))]}),l.dept_name&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.dept_name.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_type",children:"TAT Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("tat_type"),id:"tat_type",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),l.tat_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.tat_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_duration",children:"Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"tat_duration",type:"text",placeholder:"Duration",...h("tat_duration")}),l.tat_duration&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.tat_duration.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"priority",children:"Priority"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("priority"),id:"priority",children:[e.jsx("option",{value:"",children:"Select Priority"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),l.priority&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.priority.message})]})]})}),c===1&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Escalation Details"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_type",children:"Escalation Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("escalation_type"),id:"escalation_type",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),l.escalation_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.escalation_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l1",children:"L1 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l1",type:"number",placeholder:"L1 Duration",...h("escalation_l1")}),l.escalation_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.escalation_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l1",children:"L1 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l1"),id:"role_l1",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(d=>e.jsx("option",{value:d.role_name,children:d.role_name},d.role_id))]}),l.role_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.role_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l2",children:"L2 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l2",type:"number",placeholder:"L2 Duration",...h("escalation_l2")}),l.escalation_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.escalation_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l2",children:"L2 Role"}),e.jsxs("select",{className:"col-span-2  outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l2"),id:"role_l2",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(d=>e.jsx("option",{value:d.role_name,children:d.role_name},d.role_id))]}),l.role_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.role_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l3",children:"L3 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l3",type:"number",placeholder:"L3 Duration",...h("escalation_l3")}),l.escalation_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.escalation_l3.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l3",children:"L3 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l3"),id:"role_l3",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(d=>e.jsx("option",{value:d.role_name,children:d.role_name},d.role_id))]}),l.role_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:l.role_l3.message})]})]})}),e.jsxs("div",{className:"footer flex justify-between items-center py-4 px-12",children:[e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-4 py-1.5 rounded-full",type:"button",onClick:()=>E(c-1),disabled:c===0,children:"Previous"})}),e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-6 py-1.5 rounded-full",type:"submit",children:c===q.length-1?"Save":"Next"})})]})]})})]})]})})})})},O=[{id:1,title:"Complaint Details"},{id:2,title:"Escalation Details"}],le=V().shape({complaint_type_title:x().required("complaint_type is required"),dept_name:x().test("not-select","select an Department",a=>a!==""&&a!=="Select an Department"),tat_type:x().test("not-select","select an TAT Type",a=>a!==""&&a!=="Select Type"),tat_duration:x().required("Duration is required"),priority:x().required("Priority is required")}),qe=V().shape({escalation_type:x().test("not-select","select an Type",a=>a!==""&&a!=="Select Type"),escalation_l1:se().required("L1 duration is required"),role_l1:x().test("not-select","select an L1 role",a=>a!==""&&a!=="Select an Role"),escalation_l2:x().optional(),role_l2:x().optional(),escalation_l3:x().optional(),role_l3:x().optional(),status:x().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),Oe=a=>{const[c,E]=o.useState(0),[$,F]=o.useState(null),[f,h]=o.useState(null),[l,R]=o.useState(null),[P,d]=o.useState(null),j=sessionStorage.getItem("token"),{ExistingDept:k,ExistingRoles:w,comptId:M}=a;let L;switch(c){case 0:L=le;break;case 1:L=qe;break;default:L=le}o.useEffect(()=>{},[c]);const{register:u,formState:{errors:s},handleSubmit:Y,setValue:p}=re({resolver:ne(L),mode:"all"});o.useEffect(()=>{(async()=>{try{const b=await D.get(`${S}/complaint/getbyid?complaint_id=${M}`,{headers:{Authorization:`Bearer ${j}`}}),n=H(b.data.data);p("complaint_type_title",n.complaint_type_title),p("dept_name",n.dept_name),F(n.dept_name),p("tat_type",n.tat_type),p("tat_duration",n.tat_duration),p("priority",n.priority),p("escalation_type",n.escalation_type),p("escalation_l1",n.escalation_l1),p("role_l1",n.role_l1),h(n.role_l1),p("escalation_l2",n.escalation_l2),p("role_l2",n.role_l2),R(n.role_l2),p("escalation_l3",n.escalation_l3),p("role_l3",n.role_l3),d(n.role_l3),p("status",n.status)}catch(b){console.error("Error fetching data",b)}})()},[M,p]);const G=async i=>{if(c!==O.length-1)E(c+1);else{const b={...i};try{const n=await D.post(`${S}/complaint/update?complaint_id=${M}`,b,{headers:{Authorization:`Bearer ${j}`}});n.status===200?(C.success("Complaint Updated Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",n),C.error("Failed to Upload"))}catch(n){console.error("Error in posting data",n)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center flex-wrap",children:e.jsx("div",{className:"overflow-hidden shadow-lg bg-white flex items-end justify-between relative font-alegerya mx-2 ",children:e.jsx("div",{className:"min-w-[390px] min-h-[350px] ",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center px-5 text-white bg-primary h-12 flex-wrap",children:[e.jsx("p",{className:"",children:"New Complaint"}),e.jsx("button",{onClick:a.toggleModal,className:"",children:e.jsx(oe,{className:"text-2xl"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-9 relative justify-center mx-60 py-1 rounded-full bg-slate-200 mt-4",children:O.map((i,b)=>e.jsxs("div",{className:"relative items-center item flex last:flex-none group",children:[e.jsx("div",{className:`${c>=b?"bg-black text-white":"bg-white text-slate-900"} transition duration-150 icon-box h-8 w-8 rounded-full flex flex-col items-center justify-center relative z-[66] text-base font-medium`,children:e.jsx("span",{children:b+1})}),b!==O.length-1&&e.jsx("div",{className:`${c>b?"bg-green-900":"bg-[#E0EAFF]"} absolute top-1/2 h-[2px] w-full z-[65]`})]},b))}),e.jsx("div",{className:"conten-box mx-8 my-4",children:e.jsxs("form",{onSubmit:Y(G),children:[c===0&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Create Complaint"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"complaint_type_title",children:"Complaint"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline  col-span-2",id:"complaint_type_title",type:"text",placeholder:"Complaint",...u("complaint_type_title")}),s.complaint_type_title&&e.jsx("p",{className:"text-red-500 text-sm text-start -mt-3",children:s.complaint_type_title.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"dept_name",children:"Department"}),e.jsxs("select",{className:"col-span-2  block outline-none px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("dept_name"),id:"dept_name",children:[e.jsx("option",{value:$,children:$}),k.map(i=>e.jsx("option",{value:i.dept_name,children:i.dept_name},i.dept_id))]}),s.dept_name&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.dept_name.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_type",children:"TAT Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("tat_type"),id:"tat_type",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),s.tat_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.tat_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_duration",children:"Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"tat_duration",type:"text",placeholder:"Duration",...u("tat_duration")}),s.tat_duration&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.tat_duration.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"priority",children:"Priority"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("priority"),id:"priority",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Priority"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),s.priority&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.priority.message})]})]})}),c===1&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Escalation Details"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_type",children:"Escalation Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("escalation_type"),id:"escalation_type",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),s.escalation_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.escalation_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l1",children:"L1 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l1",type:"number",placeholder:"L1 Duration",...u("escalation_l1")}),s.escalation_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.escalation_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l1",children:"L1 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("role_l1"),id:"role_l1",children:[e.jsx("option",{value:f,disabled:!0,children:f}),w.map(i=>e.jsx("option",{value:i.role_name,children:i.role_name},i.role_id))]}),s.role_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.role_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l2",children:"L2 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l2",type:"number",placeholder:"L2 Duration",...u("escalation_l2")}),s.escalation_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.escalation_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l2",children:"L2 Role"}),e.jsxs("select",{className:"col-span-2  outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("role_l2"),id:"role_l2",children:[e.jsx("option",{value:l,disabled:!0,children:l}),w.map(i=>e.jsx("option",{value:i.role_name,children:i.role_name},i.role_id))]}),s.role_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.role_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l3",children:"L3 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l3",type:"number",placeholder:"L3 Duration",...u("escalation_l3")}),s.escalation_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.escalation_l3.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l3",children:"L3 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...u("role_l3"),id:"role_l3",children:[e.jsx("option",{value:P,disabled:!0,children:P}),w.map(i=>e.jsx("option",{value:i.role_name,children:i.role_name},i.role_id))]}),s.role_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:s.role_l3.message})]}),e.jsxs("div",{className:" grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",id:"status",...u("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),s.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:s.status.message})]})]})}),e.jsxs("div",{className:"footer flex justify-between items-center py-4 px-12",children:[e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-4 py-1.5 rounded-full",type:"button",onClick:()=>E(c-1),disabled:c===0,children:"Previous"})}),e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-6 py-1.5 rounded-full",type:"submit",children:c===O.length-1?"Save":"Next"})})]})]})})]})]})})})})},He=`complaint_type_title,dept_name,tat_type,tat_duration,priority,escalation_type,escalation_l1,role_l1,escalation_l2,role_l2,escalation_l3,role_l3,status,created_by_user
Title,Department,duration,Type,Priority,Type,duration1,role1,duration2,role2,duration3,role3,status,admin
`,at=({permissions:a})=>{const c=a==null?void 0:a.includes("create"),E=a==null?void 0:a.includes("edit"),$=a==null?void 0:a.includes("delete"),F=a==null?void 0:a.includes("download"),[f,h]=o.useState(!1),[l,R]=o.useState(!1),[P,d]=o.useState(!1),[j,k]=o.useState(null),[w,M]=o.useState(null),[L,u]=o.useState(null),[s,Y]=o.useState(null),[p,G]=o.useState(""),[i,b]=o.useState(1),[n]=o.useState(8),[K,ce]=o.useState(1),[Ve,ie]=o.useState([]),[I,de]=o.useState([]),[Q,xe]=o.useState(null),A=sessionStorage.getItem("token"),[me,W]=o.useState(null),[X,Z]=o.useState("Bulk Upload"),[pe,he]=o.useState(null),J=t=>{xe(Q===t?null:t)},ue=t=>Q===t;o.useEffect(()=>{z(),be(),ye()},[p,i]);const ge=t=>{t>0&&t<=K&&b(t)},z=()=>{D.get(`${S}/complaint/get`,{headers:{Authorization:`Bearer ${A}`}}).then(t=>{const r=H(t.data.data);de(r);const _=r.filter(y=>Object.values(y).some(m=>m.toString().toLowerCase().includes(p.toLowerCase())));ce(Math.ceil(_.length/n));const v=i*n,T=v-n;ie(_.slice(T,v))}).catch(t=>{console.error(t)})},ye=async()=>{try{const t=await D.get(`${S}/role/getactive`,{headers:{Authorization:`Bearer ${A}`}}),r=H(t.data.data);u(r)}catch(t){console.error("Error fetching existing Roles:",t)}},be=async()=>{try{const t=await D.get(`${S}/department/getactive`,{headers:{Authorization:`Bearer ${A}`}}),r=H(t.data.data);Y(r)}catch(t){console.error("Error fetching existing Department:",t)}},je=()=>{h(!f)},_e=()=>{R(!l),M(null)},ee=()=>{d(!P),k(null)},U=i*n,B=U-n,te=I.filter(t=>Object.values(t).some(r=>r.toString().toLowerCase().includes(p.toLowerCase()))),fe=te.slice().reverse().slice(B,U),Ne=async()=>{try{await D.delete(`${S}/complaint/delete?complaint_id=${j}`,{headers:{Authorization:`Bearer ${A}`}}),ee(),z(),C.success("Deleted successfully")}catch{C.error("Failed to delete")}},ve=t=>{W(t.target.files[0]),Z("Upload")},ke=()=>{X==="Bulk Upload"?document.getElementById("fileInput").click():we(me)},we=async t=>{try{const r=new FormData;r.append("file",t),(await D.post(`${S}/complaint/uploadcsv`,r,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(Z("Bulk Upload"),W(null),z(),C.success("Data Uploaded Successfully")):C.error("Data failed to Upload")}catch(r){console.log(r)}},De=t=>{he(t.target.value)},Se=async t=>{if(t==="csv"){const r=I.map(m=>({complaint_id:m.complaint_id,complaint_type_title:m.complaint_type_title,dept_name:m.dept_name,tat_type:m.tat_type,tat_duration:m.tat_duration,priority:m.priority,escalation_type:m.escalation_type,escalation_l1:m.escalation_l1,role_l1:m.role_l1,escalation_l2:m.escalation_l2,role_l2:m.role_l2,escalation_l3:m.escalation_l3,role_l3:m.role_l3,status:m.status,created_by_user:m.created_by_user})),_=[Object.keys(r[0]).join(","),...r.map(m=>Object.values(m).join(","))].join(`
`),v=new Blob([_],{type:"text/csv;charset=utf-8;"}),T=window.URL.createObjectURL(v),y=document.createElement("a");y.setAttribute("href",T),y.setAttribute("download","Complaint_data.csv"),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)}else if(t==="pdf")try{const _=Math.ceil(I.length/30),v=new Me("l","mm","a4");let T=0;for(let y=1;y<=_;y++){const m=(y-1)*30,Ee=Math.min(m+30,I.length),Fe=I.slice(m,Ee).map(g=>[g.complaint_id,g.complaint_type_title,g.dept_name,g.tat_type,g.tat_duration,g.priority,g.escalation_type,g.escalation_l1,g.role_l1,g.escalation_l2,g.role_l2,g.escalation_l3,g.role_l3,g.status,g.created_by_user]);v.text(`Page ${y}`,10,T+10),v.autoTable({startY:T+15,head:[["complaint_id","complaint_type_title","dept_name","tat_type","tat_duration","priority","escalation_type","escalation_l1","role_l1","escalation_l2","role_l2","escalation_l3","role_l3","Status","createdBy"]],body:Fe,theme:"striped"}),y<_&&(v.addPage(),T=10)}v.save("Complaint_data.pdf")}catch(r){console.error("Error exporting data:",r)}},Ce=()=>{const t=new Blob([He],{type:"text/csv"}),r=URL.createObjectURL(t),_=document.createElement("a");_.href=r,_.download="bulkupload_template.csv",_.click(),URL.revokeObjectURL(r)};return e.jsxs(o.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsx($e,{value:p,onChange:t=>G(t.target.value),placeholder:"Search Complaint"}),c&&e.jsx(Ie,{onChange:ve,buttonText:X,accept:".csv",onClick:ke}),F&&e.jsx(Re,{selectedDoc:pe,onChange:De,exportData:Se})]}),e.jsx(Be,{title:"Complaint",hasCreatePermission:c,onClick:()=>h(!0)}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 overflow-x-auto h-3/5 no-scrollbar",children:e.jsxs("table",{className:"w-full  ",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-300 py-1",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Complaint ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Department",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["TAT Type",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Duration",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Priority",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-1",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-2",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-3",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Status",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["CreatedBy",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-3 my-3 text-center font-lexend font-semibold whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:fe.map((t,r)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{children:e.jsxs("p",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap text-gray-700",children:[" ",B+r+1<10?`0${B+r+1}`:B+r+1]})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.complaint_type_title})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2  font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.dept_name})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2  font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.tat_type})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.tat_duration})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.priority})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start text-sm font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap  bg-gray-100 px-2 py-1 rounded-full capitalize text-gray-700",children:t.escalation_l1}),e.jsx("p",{className:"  whitespace-nowrap text-start text-sm capitalize  text-gray-700",children:t.role_l1})]})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start  font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap bg-gray-100 px-2 py-1 rounded-full text-start text-sm capitalize text-gray-700",children:t&&t.escalation_l2?t.escalation_l2:"---"}),e.jsx("p",{className:" whitespace-nowrap text-sm capitalize text-gray-700",children:t&&t.role_l2?t.role_l2:"---"})]})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start  font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap bg-gray-100 px-2 py-1 rounded-full text-start text-sm capitalize text-gray-700",children:t&&t.escalation_l3?t.escalation_l3:"---"}),e.jsx("p",{className:" whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t&&t.role_l3?t.role_l3:"---"})]})}),e.jsx("td",{children:e.jsx("div",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"fmx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Pe,{onClick:()=>J(r)}),ue(r)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[E&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{R(!0),M(t.complaint_id),J()},children:"Edit"}),$&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{d(!0),k(t.complaint_id),J()},children:"Delete"})]})]})})]},r))})]})}),e.jsxs("div",{className:" my-3 mb-5 mx-7",children:[e.jsx(ze,{handleDownload:Ce}),e.jsx(Le,{Length:I.length,currentPage:i,totalPages:K,firstIndex:B,lastIndex:U,paginate:ge,hasNextPage:U>=te.length})]})]})}),f&&e.jsx(Ue,{toggleModal:je,handlerefresh:z,ExistingDept:s,ExistingRoles:L}),l&&e.jsx(Oe,{toggleModal:_e,handlerefresh:z,ExistingDept:s,ExistingRoles:L,comptId:w}),P&&e.jsx(Te,{toggleDeleteModal:ee,delete:Ne})]})};export{at as default};
