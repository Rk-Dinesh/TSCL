import{c as T,a as E,r,u as G,o as H,j as e,b as k,A as C,B as $,d as B,I as ce,F as q,R as ie,e as N,f as R,g as xe,D as me}from"./index-B6bLt-HT.js";const he=T().shape({ward_name:E().test("not-select","Please select a ward",s=>s!==""&&s!=="Select Street"),street_name:E().required("street_name is required")}),ue=s=>{const{ExistingWards:x}=s,[g,S]=r.useState(null),[p,u]=r.useState(null),[v,f]=r.useState(null),[b,j]=r.useState(null),{register:c,formState:{errors:i},handleSubmit:y,watch:m}=G({resolver:H(he),mode:"all"});r.useEffect(()=>{if(b){const n=x.find(o=>o.ward_name===b);n&&(S(n.zone_id),u(n.ward_id),f(n.zone_name))}},[b,x]);const _=async n=>{const o={...n,zone_id:g,ward_id:p,zone_name:v,status:"active",created_by_user:"admin"};try{const w=sessionStorage.getItem("token"),a=await k.post(`${C}/street/post`,o,{headers:{Authorization:`Bearer ${w}`}});a.status===200?($.success("Street created Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",a),$.error("Failed to Upload"))}catch(w){console.error("Error in posting data",w)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Street"})}),e.jsxs("form",{onSubmit:y(_),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"ward_name",children:"Ward Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"ward_name",...c("ward_name"),onChange:n=>j(n.target.value),children:[e.jsx("option",{value:"",children:"Select Street"}),x.map(n=>e.jsx("option",{value:n.ward_name,children:n.ward_name},n.ward_id))]}),i.ward_name&&e.jsx("p",{className:"text-red-500",children:i.ward_name.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"street_name",children:"Street Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"street_name",type:"text",placeholder:"Street Name",...c("street_name")}),i.street_name&&e.jsx("p",{className:"text-red-500",children:i.street_name.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10  gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleCloseModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},ge=T().shape({ward_name:E().test("not-select","Please select a ward",s=>s!==""&&s!=="Select Street"),street_name:E().required("street_name is required"),status:E().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),pe=s=>{const{ExistingWards:x,streetId:g}=s,S=sessionStorage.getItem("token"),[p,u]=r.useState(null),[v,f]=r.useState(null),[b,j]=r.useState(null),[c,i]=r.useState(null),{register:y,formState:{errors:m},handleSubmit:_,watch:n,setValue:o}=G({resolver:H(ge),mode:"all"});r.useEffect(()=>{(async()=>{try{const h=await k.get(`${C}/street/getbyid?street_id=${g}`,{headers:{Authorization:`Bearer ${S}`}}),l=B(h.data.data);i(l.ward_name),o("ward_name",l.ward_name),o("street_name",l.street_name),o("status",l.status)}catch(h){console.error("Error fetching data",h)}})()},[g,o]),r.useEffect(()=>{if(c){const a=x.find(h=>h.ward_name===c);a&&(u(a.zone_id),f(a.ward_id),j(a.zone_name))}},[c,x]);const w=async a=>{const h={...a,zone_id:p,ward_id:v,zone_name:b};try{const l=await k.post(`${C}/street/update?street_id=${g}`,h,{headers:{Authorization:`Bearer ${S}`}});l.status===200?($.success("Street updated Successfully"),u(null),f(null),j(null),i(null),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",l),$.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Street"})}),e.jsxs("form",{onSubmit:_(w),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"ward_name",children:"Ward Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"ward_name",...y("ward_name"),onChange:a=>i(a.target.value),children:[e.jsx("option",{value:c,disabled:!0,children:c}),x.map(a=>e.jsx("option",{value:a.ward_name,children:a.ward_name},a.ward_id))]}),m.ward_name&&e.jsx("p",{className:"text-red-500",children:m.ward_name.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"street_name",children:"Street Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"street_name",type:"text",placeholder:"Street Name",...y("street_name")}),m.street_name&&e.jsx("p",{className:"text-red-500",children:m.street_name.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...y("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),m.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:m.status.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10  gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},je=({permissions:s})=>{const x=s==null?void 0:s.includes("create"),g=s==null?void 0:s.includes("edit"),S=s==null?void 0:s.includes("delete"),[p,u]=r.useState(!1),[v,f]=r.useState(!1),[b,j]=r.useState(null),[c,i]=r.useState(!1),[y,m]=r.useState(null),[_,n]=r.useState(null),[o,w]=r.useState(""),[a,h]=r.useState(1),[l]=r.useState(8),[I,J]=r.useState(1),[fe,K]=r.useState([]),[W,Q]=r.useState([]),[L,X]=r.useState(null),P=sessionStorage.getItem("token"),F=t=>{X(L===t?null:t)},Y=t=>L===t;r.useEffect(()=>{M(),ae()},[o,a]);const z=t=>{t>0&&t<=I&&h(t)},M=()=>{k.get(`${C}/street/get`,{headers:{Authorization:`Bearer ${P}`}}).then(t=>{const d=B(t.data.data);Q(d);const V=d.filter(de=>Object.values(de).some(oe=>oe.toString().toLowerCase().includes(o.toLowerCase())));J(Math.ceil(V.length/l));const Z=a*l,le=Z-l;K(V.slice(le,Z))})},ee=()=>{u(!p)},te=()=>{f(!v),j(null)},se=()=>{u(!p)},O=()=>{i(!c),m(null)},ae=async()=>{try{const t=await k.get(`${C}/ward/getactive`,{headers:{Authorization:`Bearer ${P}`}}),d=B(t.data.data);n(d)}catch(t){console.error("Error fetching existing roles:",t)}},A=a*l,D=A-l,U=W.filter(t=>Object.values(t).some(d=>d.toString().toLowerCase().includes(o.toLowerCase()))),re=U.slice(D,A),ne=async()=>{try{await k.delete(`${C}/street/delete?street_id=${y}`,{headers:{Authorization:`Bearer ${P}`}}),O(),M(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(r.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-full",children:[e.jsx(ce,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Street",value:o,onChange:t=>w(t.target.value)})]}),x&&e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 border-blue-500 font-lexend bg-slate-100 text-blue-500 rounded-full px-3 py-1.5 justify-center",children:[" ",e.jsx(q,{}),"Bulk Upload"]})}),e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 bg-slate-100  font-lexend text-black rounded-full px-3 py-1.5 w-28 justify-between",children:[" ","CSV ",e.jsx(ie,{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:"Street"}),x&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-2 px-3 justify-between md:text-base text-sm",onClick:()=>u(!0),children:[e.jsx(q,{})," Add Street"]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3  h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Street ",e.jsx(N,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Ward ",e.jsx(N,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Zone ",e.jsx(N,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Status ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedBy ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedAt",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["UpdatedAt",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-lexend font-semibold",children:"Action"})})]})}),e.jsx("tbody",{children:re.map((t,d)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center",children:D+d+1<10?`0${D+d+1}`:D+d+1})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5 my-2 font-lexend whitespace-nowrap capitalize",children:t.street_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5 my-2 font-lexend whitespace-nowrap capitalize",children:t.ward_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5 my-2 font-lexend whitespace-nowrap capitalize",children:t.zone_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5 my-2 font-lexend whitespace-nowrap capitalize",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5  my-2 font-lexend whitespace-nowrap capitalize",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5 my-2  font-lexend whitespace-nowrap capitalize",children:R(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1.5  my-2 font-lexend whitespace-nowrap capitalize",children:R(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(xe,{onClick:()=>F(d)}),Y(d)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[g&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{f(!0),j(t.street_id),F()},children:"Edit"}),S&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{i(!0),m(t.street_id),F()},children:"Delete"})]})]})})]}))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[D+1," to ",Math.min(A,W.length)]})," ","of ",e.jsxs("span",{className:"text-gray-900",children:[W.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>z(1),disabled:a===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(a-1),disabled:a===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:I},(t,d)=>d+1).slice(Math.max(0,a-2),Math.min(I,a+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>z(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${a===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(a+1),disabled:A>=U.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(I),disabled:a===I,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),p&&e.jsx(ue,{toggleModal:ee,toggleCloseModal:se,ExistingWards:_,handlerefresh:M}),v&&e.jsx(pe,{toggleModal:te,handlerefresh:M,ExistingWards:_,streetId:b}),c&&e.jsx(me,{toggleDeleteModal:O,delete:ne})]})};export{je as default};
