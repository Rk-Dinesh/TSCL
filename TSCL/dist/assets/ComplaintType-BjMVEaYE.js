import{i as Y,k as E,l as F,o as U,j as e,b,B as S,r as a,d as z,m as k,n as le}from"./index-B6yk0xO3.js";import{R as j,P as re}from"./Pagination-BU_bAkPA.js";import{S as q}from"./SavaCancel-CwerLI5p.js";import{A as p}from"./ApiClient-Cqu6SrPX.js";import{D as ne}from"./DeleteModal-DjtI9iZz.js";import{S as oe}from"./SearchHeader-BsgZgAN8.js";import"./index-GsfYLfvr.js";import"./index-BCuu-0DM.js";const ce=Y().shape({complaint_type:E().required("complaint_type is required")}),de=s=>{const{register:m,formState:{errors:x},handleSubmit:c,watch:u}=F({resolver:U(ce),mode:"all"}),f=async d=>{const h={...d,status:"active",created_by_user:sessionStorage.getItem("name")};try{const r=await b.post(p.POST_COMPLAINTTYPE.url,h,{headers:p.POST_COMPLAINTTYPE.headers});r.status===200?(S.success(" created Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",r),S.error("Failed to Upload"))}catch(r){console.error("Error in posting data",r)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Complaint Type"})}),e.jsxs("form",{onSubmit:c(f),children:[e.jsxs("div",{className:"mx-6 my-10",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...m("complaint_type")}),x.complaint_type&&e.jsx("p",{className:"text-red-500",children:x.complaint_type.message})]}),e.jsx(q,{onCancel:s.toggleModal})]})]})})},ie=Y().shape({complaint_type:E().required("complaint_type is required"),status:E().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),me=s=>{const{comptId:m}=s,{register:x,formState:{errors:c},handleSubmit:u,watch:f,setValue:d}=F({resolver:U(ie),mode:"all"});a.useEffect(()=>{(async()=>{try{const n=p.FETCH_COMPLAINTTYPE(m),o=await b.get(n.url,{headers:n.headers}),i=z(o.data.data);d("complaint_type",i.complaint_type),d("status",i.status)}catch(n){console.error("Error fetching data",n)}})()},[m,d]);const h=async r=>{const n={...r};try{const o=p.UPDATE_COMPLAINTTYPE(m),i=await b.post(o.url,n,{headers:o.headers});i.status===200?(S.success(" created Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",i),S.error("Failed to Upload"))}catch(o){console.error("Error in posting data",o)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Edit Complaint Type"})}),e.jsxs("form",{onSubmit:u(h),children:[e.jsxs("div",{className:"mx-6 my-4",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...x("complaint_type")}),c.complaint_type&&e.jsx("p",{className:"text-red-500",children:c.complaint_type.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-4",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...x("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),c.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-2 mb-2 ",children:c.status.message})]}),e.jsx(q,{onCancel:s.toggleModal})]})]})})},Ne=({permissions:s})=>{const m=s==null?void 0:s.includes("create"),x=s==null?void 0:s.includes("edit"),c=s==null?void 0:s.includes("delete"),[u,f]=a.useState(!1),[d,h]=a.useState(!1),[r,n]=a.useState(null),[o,i]=a.useState(!1),[B,_]=a.useState(null),[N,V]=a.useState(""),[w,$]=a.useState(1),[y]=a.useState(8),[v,G]=a.useState(1),[xe,R]=a.useState([]),[I,H]=a.useState([]),[D,J]=a.useState(null);sessionStorage.getItem("token");const P=t=>{J(D===t?null:t)},K=t=>D===t;a.useEffect(()=>{C()},[N,w]);const Q=t=>{t>0&&t<=v&&$(t)},C=()=>{b.get(p.GET_COMPLAINTTYPE.url,{headers:p.GET_COMPLAINTTYPE.headers}).then(t=>{const l=z(t.data.data);H(l);const O=l.filter(se=>Object.values(se).some(ae=>ae.toString().toLowerCase().includes(N.toLowerCase())));G(Math.ceil(O.length/y));const L=w*y,te=L-y;R(O.slice(te,L))}).catch(t=>{console.error(t)})},W=()=>{f(!u)},X=()=>{h(!d),n(null)},M=()=>{i(!o),_(null)},T=w*y,g=T-y,A=I.filter(t=>Object.values(t).some(l=>l.toString().toLowerCase().includes(N.toLowerCase()))),Z=A.slice().reverse().slice(g,T),ee=async()=>{try{const t=p.DELETE_COMPLAINTTYPE(B);await b.delete(t.url,{headers:t.headers}),M(),C(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(a.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen mt-10",children:[e.jsx(oe,{title:"Complaint Type",hasCreatePermission:m,onClick:()=>f(!0),searchValue:N,setSearchValue:V}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto  no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Complaint Type",e.jsx(j,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Status",e.jsx(j,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(j,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(j,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["UpdatedAt ",e.jsx(j,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 font-semibold font-lexend whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:Z.map((t,l)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-center whitespace-nowrap text-sm text-gray-700",children:g+l+1<10?`0${g+l+1}`:g+l+1})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.complaint_type})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:k(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:k(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(le,{onClick:()=>P(l)}),K(l)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[x&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{h(!0),n(t.compliant_type_id),P()},children:"Edit"}),c&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{i(!0),_(t.compliant_type_id),P()},children:"Delete"})]})]})})]},l))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsx(re,{Length:I.length,currentPage:w,totalPages:v,firstIndex:g,lastIndex:T,paginate:Q,hasNextPage:T>=A.length})})]})}),u&&e.jsx(de,{toggleModal:W,handlerefresh:C}),d&&e.jsx(me,{toggleModal:X,handlerefresh:C,comptId:r}),o&&e.jsx(ne,{toggleDeleteModal:M,delete:ee})]})};export{Ne as default};
