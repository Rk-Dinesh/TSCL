import{c as K,a as B,u as Q,o as W,j as e,b as w,A as k,B as p,r as n,d as X,I as ve,F as G,f as J,e as Ne}from"./index-B-0fny-6.js";import{R as I}from"./index-BhEqOQck.js";import{D as we}from"./DeleteModal-B8xG_S-n.js";import{P as ke,a as Se}from"./index-DcwmNplq.js";import{H as _e,E as De}from"./jspdf.plugin.autotable-CHAoQbKv.js";const ze=K().shape({zone_name:B().required("Zone_name is required")}),Ce=s=>{const{register:x,formState:{errors:g},handleSubmit:v,watch:b}=Q({resolver:W(ze),mode:"all"}),N=async S=>{const m={...S,status:"active",created_by_user:"admin"};try{const h=sessionStorage.getItem("token"),f=await w.post(`${k}/zone/post`,m,{headers:{Authorization:`Bearer ${h}`}});f.status===200?(p.success("Zone created Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",f),p.error("Failed to Upload"))}catch(h){console.error("Error in posting data",h)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[340px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Zone"})}),e.jsxs("form",{onSubmit:v(N),children:[e.jsxs("div",{className:"mx-6 my-10",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"zone_name",children:"Zone Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"zone_name",type:"text",placeholder:"Zone Name",...x("zone_name")}),g.zone_name&&e.jsx("p",{className:"text-red-500",children:g.zone_name.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},Pe=K().shape({zone_name:B().required("Zone_name is required"),status:B().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),Ie=s=>{const{zoneId:x}=s,g=sessionStorage.getItem("token"),{register:v,formState:{errors:b},handleSubmit:N,watch:S,setValue:m}=Q({resolver:W(Pe),mode:"all"});n.useEffect(()=>{(async()=>{try{const u=await w.get(`${k}/zone/getbyid?zone_id=${x}`,{headers:{Authorization:`Bearer ${g}`}}),d=X(u.data.data);m("zone_name",d.zone_name),m("status",d.status)}catch(u){console.error("Error fetching data",u)}})()},[x,m]);const h=async f=>{const u={...f};try{const d=await w.post(`${k}/zone/update?zone_id=${x}`,u,{headers:{Authorization:`Bearer ${g}`}});d.status===200?(p.success("Zone Updated Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",d),p.error("Failed to Upload"))}catch(d){console.error("Error in posting data",d)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[340px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Edit Zone"})}),e.jsxs("form",{onSubmit:N(h),children:[e.jsxs("div",{className:"mx-8 my-6",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"zone_name",children:"Zone Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"zone_name",type:"text",placeholder:"Zone Name",...v("zone_name")}),b.zone_name&&e.jsx("p",{className:"text-red-500",children:b.zone_name.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-6",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...v("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),b.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-4 mb-2 ",children:b.status.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},Ze=`zone_name,status,created_by_user
ZoneName,active,admin`,Oe=({permissions:s})=>{const x=s==null?void 0:s.includes("create"),g=s==null?void 0:s.includes("edit"),v=s==null?void 0:s.includes("delete"),b=s==null?void 0:s.includes("download"),[N,S]=n.useState(!1),[m,h]=n.useState(!1),[f,u]=n.useState(null),[d,U]=n.useState(!1),[ee,F]=n.useState(null),[Z,te]=n.useState(""),[o,ae]=n.useState(1),[_]=n.useState(8),[D,se]=n.useState(1),[Me,ne]=n.useState([]),[j,re]=n.useState([]),[O,le]=n.useState(null),L=sessionStorage.getItem("token"),[oe,R]=n.useState(null),[T,V]=n.useState("Bulk Upload"),[A,ce]=n.useState(null),$=t=>{le(O===t?null:t)},de=t=>O===t;n.useEffect(()=>{C()},[Z,o]);const z=t=>{t>0&&t<=D&&ae(t)},C=()=>{w.get(`${k}/zone/get`,{headers:{Authorization:`Bearer ${L}`}}).then(t=>{const a=X(t.data.data);re(a);const l=a.filter(r=>Object.values(r).some(c=>c.toString().toLowerCase().includes(Z.toLowerCase())));se(Math.ceil(l.length/_));const i=o*_,y=i-_;ne(l.slice(y,i))})},ie=()=>{S(!N)},xe=()=>{h(!m),u(null)},q=()=>{U(!d),F(null)},M=o*_,P=M-_,H=j.filter(t=>Object.values(t).some(a=>a.toString().toLowerCase().includes(Z.toLowerCase()))),me=H.slice().reverse().slice(P,M),he=async()=>{try{await w.delete(`${k}/zone/delete?zone_id=${ee}`,{headers:{Authorization:`Bearer ${L}`}}),q(),C(),p.success("Deleted successfully")}catch{p.error("Failed to delete")}},ue=t=>{R(t.target.files[0]),V("Upload")},pe=()=>{T==="Bulk Upload"?document.getElementById("fileInput").click():ge(oe)},ge=async t=>{try{const a=new FormData;a.append("file",t),(await w.post(`${k}/zone/uploadcsv`,a,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(V("Bulk Upload"),R(null),C(),p.success("Data Uploaded Successfully")):p.error("Data failed to Upload")}catch(a){console.log(a)}},be=t=>{ce(t.target.value)},Y=async t=>{if(t==="csv"){const a=j.map(c=>({zone_id:c.zone_id,zone_name:c.zone_name,status:c.status,created_by_user:c.created_by_user})),l=[Object.keys(a[0]).join(","),...a.map(c=>Object.values(c).join(","))].join(`
`),i=new Blob([l],{type:"text/csv;charset=utf-8;"}),y=window.URL.createObjectURL(i),r=document.createElement("a");r.setAttribute("href",y),r.setAttribute("download","Zone_data.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}else if(t==="pdf")try{const l=Math.ceil(j.length/30),i=new De("l","mm","a4");let y=0;for(let r=1;r<=l;r++){const c=(r-1)*30,je=Math.min(c+30,j.length),ye=j.slice(c,je).map(E=>[E.zone_id,E.zone_name,E.status,E.created_by_user]);i.text(`Page ${r}`,10,y+10),i.autoTable({startY:y+15,head:[["Zone_Id","Zone_Name","Status","createdBy"]],body:ye,theme:"striped"}),r<l&&(i.addPage(),y=10)}i.save("Zone_data.pdf")}catch(a){console.error("Error exporting data:",a)}},fe=()=>{const t=new Blob([Ze],{type:"text/csv"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="bulkupload_template.csv",l.click(),URL.revokeObjectURL(a)};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen ",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-full",children:[e.jsx(ve,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Zone",value:Z,onChange:t=>te(t.target.value)})]}),x&&e.jsxs("div",{className:"relative text-center   hover:text-white py-1.5 rounded-full",children:[e.jsx("input",{type:"file",id:"fileInput",className:"hidden",onChange:ue,accept:".csv"}),e.jsxs("button",{className:"flex items-center gap-2 justify-center border-primary border-2 font-normal text-base w-36 py-1.5  rounded-full text-primary hover:text-white hover:bg-primary  ",onClick:pe,children:[e.jsx(G,{}),T]})]}),b&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("form",{children:e.jsxs("select",{className:"block w-full py-2 px-2  text-sm border-2 text-gray-400  border-gray-300 rounded-full bg-gray-50 outline-none",onChange:be,children:[e.jsx("option",{hidden:!0,children:"Download"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"pdf",children:"PDF"})]})}),A===null&&e.jsx(_e,{className:"text-2xl text-gray-500"}),A==="csv"&&e.jsx(ke,{className:"text-3xl text-gray-500",onClick:()=>Y("csv")}),A==="pdf"&&e.jsx(Se,{className:"text-3xl text-gray-500",onClick:()=>Y("pdf")})]})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 flex-wrap gap-1",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:"Zone"}),x&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-2 px-3 justify-between md:text-base text-sm",onClick:()=>S(!0),children:[e.jsx(G,{})," Add Zone"]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3  h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto no-scrollbar ",children:e.jsxs("table",{className:"w-full mt-3 ",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Zone ",e.jsx(I,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold  whitespace-nowrap",children:["Status ",e.jsx(I,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedBy ",e.jsx(I,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedAt",e.jsx(I,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["UpdatedAt",e.jsx(I,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-lexend font-semibold",children:"Action"})})]})}),e.jsx("tbody",{children:me.map((t,a)=>e.jsxs("tr",{className:"border-b-2 border-gray-300 ",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-cente text-gray-700",children:P+a+1<10?`0${P+a+1}`:P+a+1})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize text-start mx-1.5 my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.zone_name})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize  text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2  font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:J(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:J(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Ne,{onClick:()=>$(a)}),de(a)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[g&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{h(!0),u(t.zone_id),$()},children:"Edit"}),v&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{U(!0),F(t.zone_id),$()},children:"Delete"})]})]})})]},a))})]})})}),e.jsxs("div",{className:" my-3 mb-5 mx-7",children:[e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"bg-primary px-3 py-2 rounded-full text-white text-sm font-alegerya",onClick:fe,children:"Bulk Upload Template"})}),e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[P+1," to ",Math.min(M,j.length)]})," ","of ",e.jsxs("span",{className:"text-gray-900",children:[j.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>z(1),disabled:o===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(o-1),disabled:o===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:D},(t,a)=>a+1).slice(Math.max(0,o-2),Math.min(D,o+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>z(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${o===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(o+1),disabled:M>=H.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>z(D),disabled:o===D,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})]})]})}),N&&e.jsx(Ce,{toggleModal:ie,handlerefresh:C}),m&&e.jsx(Ie,{toggleModal:xe,handlerefresh:C,zoneId:f}),d&&e.jsx(we,{toggleDeleteModal:q,delete:he})]})};export{Oe as default};
