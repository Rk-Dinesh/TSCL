import{C as M,r as a,u as R,b as y,A as w,d as N,j as e,z as T}from"./index-Cb3AN3R3.js";import{R as n}from"./index-C-hq6bKM.js";import{P as G}from"./Pagination-ClPqWgoN.js";import{S as O}from"./SearchHeader-Cu036AJA.js";import"./index-BK6gNoz8.js";const K=()=>{var g;const b=(g=M().state)==null?void 0:g.endpoint,[l,v]=a.useState(""),[o,S]=a.useState(1),[r]=a.useState(8),[h,C]=a.useState(1),[H,P]=a.useState([]),[p,I]=a.useState([]),u=localStorage.getItem("token"),z=R(),[V,_]=a.useState([]),[j,A]=a.useState({});a.useEffect(()=>{y.get(`${w}/new-grievance/${b}`,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{const s=N(t.data.data);I(s);const x=s.filter($=>Object.values($).some(E=>E.toString().toLowerCase().includes(l.toLowerCase())));C(Math.ceil(x.length/r));const i=o*r,m=i-r;P(x.slice(m,i))}).catch(t=>{console.error(t)}),L()},[l,o]);const L=async()=>{try{const t=await y.get(`${w}/status/get`,{headers:{Authorization:`Bearer ${u}`}}),s=N(t.data.data),x=s.reduce((i,m)=>(i[m.status_name]=m.color,i),{});_(s),A(x)}catch(t){console.error("Error fetching existing ActiveStatus:",t)}},k=t=>{t>0&&t<=h&&S(t)},d=o*r,c=d-r,f=p.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(l.toLowerCase()))),D=f.slice().reverse().slice(c,d);return e.jsx(a.Fragment,{children:e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsx("div",{className:"mt-14",children:e.jsx(O,{title:"Grievances",onClick:()=>setIsModal(!0),searchValue:l,setSearchValue:v})}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 py-3 overflow-x-auto h-3/5 no-scrollbar ",children:e.jsxs("table",{className:"w-full mt-2 ",children:[e.jsx("thead",{className:" border-b border-gray-300  ",children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend font-medium whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 text-start font-lexend font-medium  whitespace-nowrap",children:"Complaint No"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Raised by ",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint Type ",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Department",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Assigned JE ",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Date and Time ",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Priority ",e.jsx(n,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Status ",e.jsx(n,{})]})})]})}),e.jsx("tbody",{children:D.map((t,s)=>e.jsxs("tr",{className:" border-b border-gray-300  ",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap text-gray-700",children:c+s+1<10?`0${c+s+1}`:c+s+1})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 border-slate-900 rounded-lg text-center py-1 my-1   text-slate-900",onClick:()=>z("/view",{state:{grievanceId:t.grievance_id}}),children:t.grievance_id})}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.public_user_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.complaint_type_title})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.dept_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.assign_username?t.assign_username:"Yet to be assigned"})]}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:T(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:`border-2 w-26 rounded-full text-center py-1.5 mx-2 text-sm font-medium capitalize  ${t.priority==="High"?"text-red-500 border-red-500":t.priority==="Medium"?"text-sky-500 border-sky-500":t.priority==="Low"?"text-green-500 border-green-500":""}`,children:t.priority})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 rounded-full text-center py-1 tex-sm font-normal mx-2 capitalize  ",style:{borderColor:j[t.status]||"gray",color:j[t.status]||"black",fontSize:14},children:t.status})})]},s))})]})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsx(G,{Length:p.length,currentPage:o,totalPages:h,firstIndex:c,lastIndex:d,paginate:k,hasNextPage:d>=f.length})})]})})})};export{K as default};
