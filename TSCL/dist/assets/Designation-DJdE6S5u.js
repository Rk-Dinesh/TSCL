import{i as Q,k as v,m as W,o as X,j as e,b as D,B as _,r as n,d as M,x as Ee,D as ve,y as Ie,q as T,C as Oe,N as Te,v as Pe,w as Ce,E as Ae,z as ke}from"./index-tsgvEHmX.js";import{D as Ge}from"./DeleteModal-DJp1pd7G.js";import{S as ee}from"./SavaCancel-r2kPCP2i.js";import{A as g}from"./ApiClient-w4qWO__2.js";import{F as Fe,B as Be}from"./FileUploadButton-C5ckz8lU.js";const Ue=Q().shape({org_name:v().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:v().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:v().required("Designation is required")}),ze=({ExistingOrganiZations:a,ExistingDepartments:I,toggleModal:w,handlerefresh:P})=>{const{register:u,formState:{errors:i},handleSubmit:p}=W({resolver:X(Ue),mode:"all"}),S=async o=>{const d={...o,status:"active",created_by_user:localStorage.getItem("name")};try{const l=await D.post(g.POST_DESIGANATION.url,d,{headers:g.POST_DESIGANATION.headers});l.status===200?(_.success("Designatiom created Successfully"),w(),P()):(console.error("Error in posting data",l),_.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[460px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-8 pb-2",children:"Add Desgination"})}),e.jsxs("form",{onSubmit:p(S),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...u("org_name"),children:[e.jsx("option",{value:"",children:"Select Organization"}),a.map((o,d)=>e.jsx("option",{value:o.org_name,children:o.org_name},d))]}),i.org_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.org_name.message})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...u("dept_name"),children:[e.jsx("option",{value:"",children:"Select Department"}),I.map((o,d)=>e.jsx("option",{value:o.dept_name,children:o.dept_name},d))]}),i.dept_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.dept_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Designation"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Designation Name",...u("designation")}),i.designation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.designation.message})]})]}),e.jsx(ee,{onCancel:w})]})]})})},Me=Q().shape({org_name:v().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:v().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:v().required("Designation is required"),status:v().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),Le=({ExistingOrganiZations:a,ExistingDepartments:I,toggleModal:w,handlerefresh:P,desgId:u})=>{const[i,p]=n.useState(null),[S,o]=n.useState(null),{register:d,formState:{errors:l},handleSubmit:G,setValue:b,watch:V}=W({resolver:X(Me),mode:"all"});n.useEffect(()=>{(async()=>{try{const x=g.FETCH_DESIGNATION(u),f=await D.get(x.url,{headers:x.headers}),h=M(f.data.data);b("org_name",h.org_name),p(h.org_name),b("dept_name",h.dept_name),o(h.dept_name),b("designation",h.designation),b("status",h.status)}catch(x){console.error("Error fetching data",x)}})()},[u,b]);const F=async r=>{const x={...r};try{const f=g.UPDATE_DESIGNATION(u),h=await D.post(f.url,x,{headers:f.headers});h.status===200?(_.success("Desgination Updated Successfully"),p(null),o(null),w(),P()):(console.error("Error in posting data",h),_.error("Failed to Upload"))}catch(f){console.error("Error in posting data",f)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[420px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Desgination"})}),e.jsxs("form",{onSubmit:G(F),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...d("org_name"),onChange:r=>p(r.target.value),children:[e.jsx("option",{value:i,disabled:!0,children:i}),a.map((r,x)=>e.jsx("option",{value:r.org_name,children:r.org_name},x))]}),l.org_name&&e.jsx("p",{className:"text-red-500",children:l.org_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...d("dept_name"),onChange:r=>o(r.target.value),children:[e.jsx("option",{value:S,disabled:!0,children:S}),I.map((r,x)=>e.jsx("option",{value:r.dept_name,children:r.dept_name},x))]}),l.dept_name&&e.jsx("p",{className:"text-red-500",children:l.dept_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Desgination"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Desgination Name",...d("designation")}),l.designation&&e.jsx("p",{className:"text-red-500",children:l.designation.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...d("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),l.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:l.status.message})]})]}),e.jsx(ee,{onCancel:w})]})]})})},Ve=`designation,dept_name,org_name,status,created_by_user
Designation,Department,Organization,active,admin`,Ke=({permissions:a})=>{const I=a==null?void 0:a.includes("create"),w=a==null?void 0:a.includes("edit"),P=a==null?void 0:a.includes("delete"),u=a==null?void 0:a.includes("download"),[i,p]=n.useState(!1),[S,o]=n.useState(!1),[d,l]=n.useState(!1),[G,b]=n.useState(null),[V,F]=n.useState(null),[r,x]=n.useState(null),[f,h]=n.useState(null),[B,te]=n.useState(""),[U,ae]=n.useState(1),[C]=n.useState(8),[R,se]=n.useState(1),[Re,ne]=n.useState([]),[N,q]=n.useState([]),[$,le]=n.useState(null);localStorage.getItem("token");const[re,Z]=n.useState(null),[H,Y]=n.useState("Bulk Upload"),[oe,ce]=n.useState(null),L=t=>{le($===t?null:t)},ie=t=>$===t;n.useEffect(()=>{A(),he(),ue()},[B,U]);const de=t=>{t>0&&t<=R&&ae(t)},A=()=>{D.get(g.GET_DESIGNATION.url,{headers:g.GET_DESIGNATION.headers}).then(t=>{const s=M(t.data.data);q(s);const y=s.filter(c=>Object.values(c).some(m=>m.toString().toLowerCase().includes(B.toLowerCase())));se(Math.ceil(y.length/C));const j=U*C,E=j-C;ne(y.slice(E,j))})},me=()=>{p(!i)},xe=()=>{o(!S),F(null)},ge=()=>{p(!i)},J=()=>{l(!d),b(null)},he=async()=>{try{const t=await D.get(g.GET_ORG_DESIGNATIONACTIVE.url,{headers:g.GET_ORG_DESIGNATIONACTIVE.headers}),s=M(t.data.data);x(s)}catch(t){console.error("Error fetching existing Organisations:",t)}},ue=async()=>{try{const t=await D.get(g.GET_DEPT_DESIGNATIONACTIVE.url,{headers:g.GET_DEPT_DESIGNATIONACTIVE.headers}),s=M(t.data.data);h(s)}catch(t){console.error("Error fetching existing Departments:",t)}},z=U*C,k=z-C,K=N.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(B.toLowerCase()))),pe=K.slice().reverse().slice(k,z),fe=async()=>{try{const t=g.DELETE_DESIGNATION(G);await D.delete(t.url,{headers:t.headers}),J(),A(),q(N.filter(s=>N.desgination_id!==G)),_.success("Deleted successfully")}catch{_.error("Failed to delete")}},je=t=>{Z(t.target.files[0]),Y("Upload")},be=()=>{H==="Bulk Upload"?document.getElementById("fileInput").click():Ne(re)},Ne=async t=>{try{const s=new FormData;s.append("file",t),(await D.post(g.UPLOAD_DESIGNATION.url,s,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(Y("Bulk Upload"),Z(null),A(),_.success("Data Uploaded Successfully")):_.error("Data failed to Upload")}catch(s){console.log(s)}},ye=t=>{ce(t.target.value)},De=async t=>{if(t==="csv"){const s=N.map(m=>({desgination_id:m.desgination_id,designation:m.designation,dept_name:m.dept_name,org_name:m.org_name,status:m.status,created_by_user:m.created_by_user})),y=[Object.keys(s[0]).join(","),...s.map(m=>Object.values(m).join(","))].join(`
`),j=new Blob([y],{type:"text/csv;charset=utf-8;"}),E=window.URL.createObjectURL(j),c=document.createElement("a");c.setAttribute("href",E),c.setAttribute("download","Designation_data.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}else if(t==="pdf")try{const y=Math.ceil(N.length/30),j=new Ae("l","mm","a4");let E=0;for(let c=1;c<=y;c++){const m=(c-1)*30,we=Math.min(m+30,N.length),Se=N.slice(m,we).map(O=>[O.desgination_id,O.designation,O.dept_name,O.org_name,O.status,O.created_by_user]);j.text(`Page ${c}`,10,E+10),j.autoTable({startY:E+15,head:[["Designation ID","Designation","DeptName","OrgName","Status","createdBy"]],body:Se,theme:"striped"}),c<y&&(j.addPage(),E=10)}j.save("Designation_data.pdf")}catch(s){console.error("Error exporting data:",s)}},_e=()=>{ke(Ve)};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-2 mx-8 flex-wrap",children:[e.jsx(Ee,{value:B,onChange:t=>te(t.target.value),placeholder:"Search Designation"}),I&&e.jsx(Fe,{onChange:je,buttonText:H,accept:".csv",onClick:be}),u&&e.jsx(ve,{selectedDoc:oe,onChange:ye,exportData:De})]}),e.jsx(Ie,{title:"Designation",hasCreatePermission:I,onClick:()=>p(!0)}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-2 overflow-x-auto h-3/5 no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Designation ",e.jsx(T,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Department Name ",e.jsx(T,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Org Name ",e.jsx(T,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold  whitespace-nowrap",children:["Status ",e.jsx(T,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(T,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(T,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-semibold font-lexend  whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:pe.map((t,s)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center text-gray-800",children:k+s+1<10?`0${k+s+1}`:k+s+1})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.designation})}),e.jsx("td",{children:e.jsxs("div",{className:"flex  gap-2 items-center justify-start mx-3 my-3  text-sm text-gray-800",children:[e.jsx("img",{src:Oe,alt:"logo",className:"w-8 h-8"}),e.jsxs("p",{className:"font-lexend whitespace-nowrap capitalize   text-gray-800",children:[" ",t.dept_name]})]})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.org_name})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2  font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-800 ",children:Te(t.createdAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Pe,{onClick:()=>L(s)}),ie(s)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[w&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{o(!0),F(t.desgination_id),L()},children:"Edit"}),P&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{l(!0),b(t.desgination_id),L()},children:"Delete"})]})]})})]},s))})]})}),e.jsxs("div",{className:" my-2 mb-5 mx-7",children:[e.jsx(Be,{handleDownload:_e}),e.jsx(Ce,{Length:N.length,currentPage:U,totalPages:R,firstIndex:k,lastIndex:z,paginate:de,hasNextPage:z>=K.length})]})]})}),i&&e.jsx(ze,{toggleModal:me,toggleCloseModal:ge,ExistingOrganiZations:r,ExistingDepartments:f,handlerefresh:A}),S&&e.jsx(Le,{toggleModal:xe,handlerefresh:A,ExistingOrganiZations:r,ExistingDepartments:f,desgId:V}),d&&e.jsx(Ge,{toggleDeleteModal:J,delete:fe})]})};export{Ke as default};
