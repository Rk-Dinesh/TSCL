import{u as S,r as h,j as e,b as E,A as P,B as x}from"./index-DP2NNKOn.js";const I=()=>{const g=localStorage.getItem("token"),k=S(),[f,j]=h.useState(""),[l,d]=h.useState([]),[r,b]=h.useState([{name:"Dashboard",value:"dashboard",checked:!1},{name:"Organization",value:"organization",checked:!1},{name:"Department",value:"department",checked:!1},{name:"Zone",value:"zone",checked:!1},{name:"Ward",value:"ward",checked:!1},{name:"Street",value:"street",checked:!1},{name:"Complaint",value:"complaint",checked:!1},{name:"Complaint Type",value:"complainttype",checked:!1},{name:"Designation",value:"designation",checked:!1},{name:"Employee",value:"emp",checked:!1},{name:"AdminUser",value:"admin",checked:!1},{name:"PublicUser",value:"user",checked:!1},{name:"Status",value:"status",checked:!1},{name:"Setting",value:"setting",checked:!1},{name:"Template",value:"template",checked:!1},{name:"Escalation",title:!0},{name:"Escalation",value:"escalate",checked:!1},{name:"Escalation Commissioner",value:"escalation",checked:!1},{name:"Grievance",title:!0},{name:"SuperAdmin",value:"grievance",checked:!1},{name:"Commissioner",value:"requestview4",checked:!1},{name:"Department Admin",value:"requestview2",checked:!1},{name:"Engineer",value:"requestview3",checked:!1},{name:"Operator",value:"requestview1",checked:!1}]),[u,N]=h.useState({roleName:"",featurePermissions:""}),w=a=>{j(a.target.value)},y=a=>{const s=[...r];s[a].checked=!s[a].checked,s[a].checked?d([...l,{feature:s[a].value,permissions:[]}]):d(l.filter(t=>t.feature!==s[a].value)),b(s)},m=(a,s)=>{const t=[...l],c=t.findIndex(o=>o.feature===r[a].value);t[c].permissions.includes(s)?t[c].permissions=t[c].permissions.filter(o=>o!==s):t[c].permissions.push(s),d(t)},C=a=>{const s=[...l],t=s.findIndex(c=>c.feature===r[a].value);s[t].permissions.length===5?s[t].permissions=[]:s[t].permissions=["view","create","edit","delete","download"],d(s)},A=async a=>{a.preventDefault();let s=!0;const t={roleName:"",featurePermissions:""};if(f.trim()===""&&(t.roleName="Role name is required.",s=!1),l.forEach(i=>{i.permissions.length===0&&(t.featurePermissions="Please select at least one permission for each selected feature.",s=!1)}),N(t),!s)return;const c=[...l],o={role_name:f,accessLevels:c,status:"active",created_by_user:localStorage.getItem("name")};try{const i=await E.post(`${P}/role/post`,o,{headers:{Authorization:`Bearer ${g}`}});i.status===200?(x.success("Role created Successfully"),k("/setting")):(console.error("Error in posting data",i),x.error("Failed to Upload"))}catch(i){console.error("Error in posting data",i)}};return e.jsx("div",{className:"md:mx-6 mx-1 my-3 font-lexend overflow-y-auto no-scrollbar bg-white rounded-lg",children:e.jsx("div",{className:"px-6 py-6 overflow-auto no-scrollbar",children:e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"flex gap-6 text-base items-center ",children:[e.jsx("label",{children:"Role Name:"}),e.jsx("input",{type:"text",value:f,onChange:w,className:"w-80 text-start border  rounded-lg ml-2 px-3 py-1 outline-none"})]}),u.roleName&&e.jsx("p",{className:"error mt-3 text-red-500",children:u.roleName}),e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"mt-6 mb-3 text-base text-primary ",children:"Access Levels:"}),r.map((a,s)=>{var t,c,o,i,p,v;return a.title?e.jsxs("div",{className:" flex gap-2 items-center mb-4",children:[e.jsx("h3",{className:"text-base text-primary",children:a.name}),e.jsx("p",{className:"text-red-500 text-sm",children:"( Select one option from the list )"})]},s):e.jsxs("div",{className:"md:grid md:grid-cols-3 mb-3 text-base ",children:[e.jsxs("div",{className:"col-span-1 flex gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.checked,onChange:()=>y(s)}),e.jsx("label",{children:a.name})]}),a.checked&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx("label",{className:"mx-4 md:text-base text-sm ",children:"Permissions:"}),e.jsx("input",{type:"checkbox",value:"view",checked:((t=l.find(n=>n.feature===r[s].value))==null?void 0:t.permissions.includes("view"))||!1,onChange:()=>m(s,"view")}),e.jsx("label",{className:"text-sm",children:"View"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:"create",checked:((c=l.find(n=>n.feature===r[s].value))==null?void 0:c.permissions.includes("create"))||!1,onChange:()=>m(s,"create")}),e.jsx("label",{children:"Create"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:"edit",checked:((o=l.find(n=>n.feature===r[s].value))==null?void 0:o.permissions.includes("edit"))||!1,onChange:()=>m(s,"edit")}),e.jsx("label",{children:"Edit"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:"delete",checked:((i=l.find(n=>n.feature===r[s].value))==null?void 0:i.permissions.includes("delete"))||!1,onChange:()=>m(s,"delete")}),e.jsx("label",{children:"Delete"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:"download",checked:((p=l.find(n=>n.feature===r[s].value))==null?void 0:p.permissions.includes("download"))||!1,onChange:()=>m(s,"download")}),e.jsx("label",{children:"Download"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:"all",checked:((v=l.find(n=>n.feature===r[s].value))==null?void 0:v.permissions.length)===5||!1,onChange:()=>C(s)}),e.jsx("label",{children:"All"})]})]})]},s)}),u.featurePermissions&&e.jsx("p",{className:"error text-center text-red-500",children:u.featurePermissions})]}),e.jsx("div",{className:"flex justify-center mt-3 mb-6",children:e.jsx("button",{type:"submit",className:"text-center px-3 py-1.5 bg-primary text-white rounded-full",children:"Save Role Access Level"})})]})})})};export{I as default};
