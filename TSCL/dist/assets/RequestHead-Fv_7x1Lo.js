import{r as a,u as De,b as c,A as i,d as o,j as t,m as $e}from"./index-B-YhHBab.js";import{R as n,P as ke}from"./Pagination-DoNtECT-.js";const Le=()=>{const[b,Pe]=a.useState(""),[u,J]=a.useState(1),[p]=a.useState(10),[L,F]=a.useState(1),[Me,G]=a.useState([]),[T,K]=a.useState([]),[B,Q]=a.useState([]),[R,X]=a.useState([]),[Z,ee]=a.useState([]),[W,te]=a.useState([]),[H,se]=a.useState([]),[U,ae]=a.useState([]),[Y,ne]=a.useState([]),r=sessionStorage.getItem("token"),le=sessionStorage.getItem("dept"),re=De(),[O,ce]=a.useState("All"),[V,ie]=a.useState({}),[N,S]=a.useState(null),[f,A]=a.useState(null),[g,j]=a.useState(null),[_,y]=a.useState(null),[z,C]=a.useState(null),[D,$]=a.useState(null),[k,P]=a.useState(null),[w,M]=a.useState(null);a.useEffect(()=>{c.get(`${i}/new-grievance/get`,{headers:{Authorization:`Bearer ${r}`}}).then(e=>{const s=o(e.data.data);ae(s);const x=s.filter(E=>Object.values(E).some(I=>I.toString().toLowerCase().includes(b.toLowerCase())));F(Math.ceil(x.length/p));const d=u*p,m=d-p;G(x.slice(m,d))}).catch(e=>{console.error(e)}),me(),oe(),de(),xe(),pe(),ue(),he()},[b,u]);const oe=async()=>{try{const e=await c.get(`${i}/zone/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);ee(s)}catch(e){console.error("Error fetching existing Dept:",e)}},de=async()=>{try{const e=await c.get(`${i}/ward/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);te(s)}catch(e){console.error("Error fetching existing Dept:",e)}},xe=async()=>{try{const e=await c.get(`${i}/street/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);se(s)}catch(e){console.error("Error fetching existing Dept:",e)}},me=async()=>{try{const e=await c.get(`${i}/department/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);X(s)}catch(e){console.error("Error fetching existing Dept:",e)}},pe=async()=>{try{const e=await c.get(`${i}/status/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data),x=s.reduce((d,m)=>(d[m.status_name]=m.color,d),{});K(s),ie(x)}catch(e){console.error("Error fetching existing ActiveStatus:",e)}},he=async()=>{try{const e=await c.get(`${i}/user/getbydept?dept_name=${le}`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);ne(s)}catch(e){sconsole.error("Error fetching existing ActiveStatus:",e)}},ue=async()=>{try{const e=await c.get(`${i}/complainttype/get`,{headers:{Authorization:`Bearer ${r}`}}),s=o(e.data.data);Q(s)}catch(e){console.error("Error fetching existing Complainttype:",e)}},l=e=>{e>0&&e<=L&&J(e)},v=u*p,h=v-p,q=U.filter(e=>Object.values(e).some(s=>s.toString().toLowerCase().includes(b.toLowerCase()))),fe=e=>{ce(e),S(null),A(null),j(null),C(null),$(null),P(null),M(null),l(1)},ge=e=>{S(e==="All"?null:e),l(1)},je=e=>{e==="All"?A(null):(A(e),j(null),y(null)),l(1)},ye=e=>{e==="All"?j(null):(j(e),y(null)),l(1)},we=e=>{y(e==="All"?null:e),l(1)},ve=e=>{C(e==="All"?null:e),l(1)},be=e=>{$(e==="All"?null:e),l(1)},Ne=e=>{P(e==="All"?null:e),l(1)},Se=e=>{M(e==="All"?null:e),l(1)},Ae=q.slice().reverse().filter(e=>{const s=O==="All"?!0:"",x=N===null?!0:e.dept_name===N,d=f===null?!0:e.zone_name===f,m=g===null?!0:e.ward_name===g,E=_===null?!0:e.street_name===_,I=z===null?!0:e.status===z,_e=D===null?!0:e.complaint_type_title===D,ze=k===null?!0:e.priority===k,Ce=w===null?!0:w==="Yet to be Assigned"?!e.assign_username:e.assign_username===w;return s&&I&&x&&d&&m&&E&&_e&&ze&&Ce}).slice(h,v);return t.jsx("div",{className:"overflow-y-auto no-scrollbar",children:t.jsxs("div",{className:"  font-lexend h-screen ",children:[t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 mx-4",children:[t.jsx("button",{className:`w-20  py-1 ${O==="All"?"bg-primary text-white":"bg-white text-black"} rounded-full`,onClick:()=>fe("All"),children:"All"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>ge(e.target.value),value:N||"",children:[t.jsx("option",{hidden:!0,children:"Department"}),t.jsx("option",{value:"All",children:"All"}),R&&R.map(e=>t.jsx("option",{value:e.dept_name,children:e.dept_name},e.dept_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>je(e.target.value),value:f||"",children:[t.jsx("option",{hidden:!0,children:"Zone"}),t.jsx("option",{value:"All",children:"All"}),Z&&Z.map(e=>t.jsx("option",{value:e.zone_name,children:e.zone_name},e.zone_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>ye(e.target.value),value:g||"",children:[t.jsx("option",{hidden:!0,children:"ward"}),t.jsx("option",{value:"All",children:"All"}),W&&W.filter(e=>e.zone_name===f).map(e=>t.jsx("option",{value:e.ward_name,children:e.ward_name},e.ward_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>we(e.target.value),value:_||"",children:[t.jsx("option",{hidden:!0,children:"Area"}),t.jsx("option",{value:"All",children:"All"}),H&&H.filter(e=>e.ward_name===g).map(e=>t.jsx("option",{value:e.street_name,children:e.street_name},e.street_id))]})})]}),t.jsxs("div",{className:"bg-white h-4/5 mx-3 rounded-lg mt-4  p-3",children:[t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center md:gap-6 gap-2 md:mt-2 mx-3",children:[t.jsx("div",{className:"flex flex-wrap gap-3",children:t.jsx("p",{className:"md:text-lg text-sm whitespace-nowrap",children:"View Report"})}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>Se(e.target.value),value:w||"",children:[t.jsx("option",{hidden:!0,children:"Select Assign"}),t.jsx("option",{value:"All",children:"All"}),t.jsx("option",{value:"Yet to be Assigned",children:"Yet to be Assigned"}),Y&&Y.map(e=>t.jsx("option",{value:e.user_name,children:e.user_name},e.user_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>Ne(e.target.value),value:k||"",children:[t.jsx("option",{hidden:!0,children:"Priority"}),t.jsx("option",{value:"All",children:"All"}),t.jsx("option",{value:"High",children:"High"}),t.jsx("option",{value:"Medium",children:"Medium"}),t.jsx("option",{value:"Low",children:"Low"})]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>ve(e.target.value),value:z||"",children:[t.jsx("option",{hidden:!0,children:"Status"}),t.jsx("option",{value:"All",children:"All"}),T&&T.map(e=>t.jsx("option",{value:e.status_name,children:e.status_name},e.status_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>be(e.target.value),value:D||"",children:[t.jsx("option",{hidden:!0,children:"Complaint Type"}),t.jsx("option",{value:"All",children:"All"}),B&&B.map(e=>t.jsx("option",{value:e.complaint_type,children:e.complaint_type},e.compliant_type_id))]})})]})]}),t.jsx("div",{className:" rounded-lg  md:py-3 py-1 overflow-x-auto no-scrollbar",children:t.jsxs("table",{className:"w-full md:mt-1 ",children:[t.jsx("thead",{className:" border-b border-gray-300  ",children:t.jsxs("tr",{className:"",children:[t.jsx("th",{className:"",children:t.jsx("p",{className:" mx-6 my-2 font-lexend font-medium whitespace-nowrap",children:"#"})}),t.jsx("th",{children:t.jsx("p",{className:"mx-1.5 my-2 text-start font-lexend font-medium  whitespace-nowrap",children:"Complaint No"})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint Type",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Department",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Date and Time ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Raised by ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Zone ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Ward ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Street ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Assigned JE ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Priority ",t.jsx(n,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Status ",t.jsx(n,{})]})})]})}),t.jsx("tbody",{children:Ae.map((e,s)=>t.jsxs("tr",{className:" border-b border-gray-300  ",children:[t.jsx("td",{className:"",children:t.jsx("div",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap",children:h+s+1<10?`0${h+s+1}`:h+s+1})}),t.jsx("td",{children:t.jsx("p",{className:"border-2 w-28 border-slate-900 rounded-lg text-center py-1 my-1  capitalize text-slate-900",onClick:()=>re("/view3",{state:{grievanceId:e.grievance_id,deptName:e.dept_name}}),children:e.grievance_id})}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.complaint_type_title})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.dept_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.complaint})]}),t.jsx("td",{children:t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:$e(e.createdAt)})}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.public_user_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.zone_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.ward_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.street_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.assign_username?e.assign_username:"Yet to be assigned"})]}),t.jsx("td",{children:t.jsx("p",{className:`border-2 w-26 rounded-full text-center py-1.5 mx-2 text-sm font-medium capitalize  ${e.priority==="High"?"text-red-500 border-red-500":e.priority==="Medium"?"text-sky-500 border-sky-500":e.priority==="Low"?"text-green-500 border-green-500":""}`,children:e.priority})}),t.jsx("td",{children:t.jsx("p",{className:"border-2 w-28 rounded-full text-center py-1 tex-sm font-normal mx-2 capitalize  ",style:{borderColor:V[e.status]||"gray",color:V[e.status]||"black",fontSize:14},children:e.status})})]},s))})]})})]}),t.jsx("div",{className:" my-3 mb-5 mx-7",children:t.jsx(ke,{Length:U.length,currentPage:u,totalPages:L,firstIndex:h,lastIndex:v,paginate:l,hasNextPage:v>=q.length})})]})})};export{Le as default};
