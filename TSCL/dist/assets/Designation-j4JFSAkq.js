import{i as Q,k as v,l as W,o as X,j as e,b as D,B as _,r as n,d as M,q as Ee,t as ve,n as Ie,p as Oe}from"./index-BtER-45x.js";import{R as P,P as Pe}from"./Pagination-DzgA0zaw.js";import{D as Te}from"./DeleteModal-DIXAd6oL.js";import{S as Ce,D as Ae,E as ke}from"./DocumentDownload-ByZD_dy4.js";import{S as ee}from"./SavaCancel-DGVOLgqI.js";import{A as m}from"./ApiClient-Bw8baX-p.js";import{F as Ge,B as Fe}from"./FileUploadButton-BEzXyeJt.js";import{H as Be}from"./HeaderButton-Dt07NwBn.js";import"./index-DcKunLyf.js";import"./index-BzhkxZBX.js";import"./index-kPZ_e412.js";const Ue=Q().shape({org_name:v().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:v().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:v().required("Designation is required")}),ze=({ExistingOrganiZations:a,ExistingDepartments:I,toggleModal:w,handlerefresh:T})=>{const{register:g,formState:{errors:i},handleSubmit:h}=W({resolver:X(Ue),mode:"all"}),S=async o=>{const p={...o,status:"active",created_by_user:sessionStorage.getItem("name")};try{const l=await D.post(m.POST_DESIGANATION.url,p,{headers:m.POST_DESIGANATION.headers});l.status===200?(_.success("Designatiom created Successfully"),w(),T()):(console.error("Error in posting data",l),_.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[460px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-8 pb-2",children:"Add Desgination"})}),e.jsxs("form",{onSubmit:h(S),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...g("org_name"),children:[e.jsx("option",{value:"",children:"Select Organization"}),a.map(o=>e.jsx("option",{value:o.org_name,children:o.org_name},o.org_id))]}),i.org_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.org_name.message})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...g("dept_name"),children:[e.jsx("option",{value:"",children:"Select Department"}),I.map(o=>e.jsx("option",{value:o.dept_name,children:o.dept_name},o.dept_id))]}),i.dept_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.dept_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Designation"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Designation Name",...g("designation")}),i.designation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.designation.message})]})]}),e.jsx(ee,{onCancel:w})]})]})})},Me=Q().shape({org_name:v().test("not-select","Please select an Organization",a=>a!==""&&a!=="Select  Organization"),dept_name:v().test("not-select","Please select an Department",a=>a!==""&&a!=="Select  Department"),designation:v().required("Designation is required"),status:v().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),Le=({ExistingOrganiZations:a,ExistingDepartments:I,toggleModal:w,handlerefresh:T,desgId:g})=>{const[i,h]=n.useState(null),[S,o]=n.useState(null),{register:p,formState:{errors:l},handleSubmit:G,setValue:j,watch:V}=W({resolver:X(Me),mode:"all"});n.useEffect(()=>{(async()=>{try{const b=m.FETCH_DESIGNATION(g),u=await D.get(b.url,{headers:b.headers}),x=M(u.data.data);j("org_name",x.org_name),h(x.org_name),j("dept_name",x.dept_name),o(x.dept_name),j("designation",x.designation),j("status",x.status)}catch(b){console.error("Error fetching data",b)}})()},[g,j]);const F=async r=>{const b={...r};try{const u=m.UPDATE_DESIGNATION(g),x=await D.post(u.url,b,{headers:u.headers});x.status===200?(_.success("Desgination Updated Successfully"),h(null),o(null),w(),T()):(console.error("Error in posting data",x),_.error("Failed to Upload"))}catch(u){console.error("Error in posting data",u)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:e.jsxs("div",{className:"bg-white w-[522px] h-[420px] font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Desgination"})}),e.jsxs("form",{onSubmit:G(F),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"org_name",children:"Organization Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"org_name",...p("org_name"),onChange:r=>h(r.target.value),children:[e.jsx("option",{value:i,disabled:!0,children:i}),a.map(r=>e.jsx("option",{value:r.org_name,children:r.org_name},r.org_id))]}),l.org_name&&e.jsx("p",{className:"text-red-500",children:l.org_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"dept_name",children:"Department Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...p("dept_name"),onChange:r=>o(r.target.value),children:[e.jsx("option",{value:S,disabled:!0,children:S}),I.map(r=>e.jsx("option",{value:r.dept_name,children:r.dept_name},r.dept_id))]}),l.dept_name&&e.jsx("p",{className:"text-red-500",children:l.dept_name.message})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"designation",children:"Desgination"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"designation",type:"text",placeholder:"Desgination Name",...p("designation")}),l.designation&&e.jsx("p",{className:"text-red-500",children:l.designation.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...p("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),l.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:l.status.message})]})]}),e.jsx(ee,{onCancel:w})]})]})})},Ve=`designation,dept_name,org_name,status,created_by_user
Designation,Department,Organization,active,admin`,at=({permissions:a})=>{const I=a==null?void 0:a.includes("create"),w=a==null?void 0:a.includes("edit"),T=a==null?void 0:a.includes("delete"),g=a==null?void 0:a.includes("download"),[i,h]=n.useState(!1),[S,o]=n.useState(!1),[p,l]=n.useState(!1),[G,j]=n.useState(null),[V,F]=n.useState(null),[r,b]=n.useState(null),[u,x]=n.useState(null),[B,te]=n.useState(""),[U,ae]=n.useState(1),[C]=n.useState(8),[R,se]=n.useState(1),[Re,ne]=n.useState([]),[N,q]=n.useState([]),[$,re]=n.useState(null);sessionStorage.getItem("token");const[oe,H]=n.useState(null),[Z,Y]=n.useState("Bulk Upload"),[le,ce]=n.useState(null),L=t=>{re($===t?null:t)},ie=t=>$===t;n.useEffect(()=>{A(),he(),pe()},[B,U]);const de=t=>{t>0&&t<=R&&ae(t)},A=()=>{D.get(m.GET_DESIGNATION.url,{headers:m.GET_DESIGNATION.headers}).then(t=>{const s=M(t.data.data);q(s);const y=s.filter(c=>Object.values(c).some(d=>d.toString().toLowerCase().includes(B.toLowerCase())));se(Math.ceil(y.length/C));const f=U*C,E=f-C;ne(y.slice(E,f))})},me=()=>{h(!i)},xe=()=>{o(!S),F(null)},ge=()=>{h(!i)},J=()=>{l(!p),j(null)},he=async()=>{try{const t=await D.get(m.GET_ORG_DESIGNATIONACTIVE.url,{headers:m.GET_ORG_DESIGNATIONACTIVE.headers}),s=M(t.data.data);b(s)}catch(t){console.error("Error fetching existing Organisations:",t)}},pe=async()=>{try{const t=await D.get(m.GET_DEPT_DESIGNATIONACTIVE.url,{headers:m.GET_DEPT_DESIGNATIONACTIVE.headers}),s=M(t.data.data);x(s)}catch(t){console.error("Error fetching existing Departments:",t)}},z=U*C,k=z-C,K=N.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(B.toLowerCase()))),ue=K.slice().reverse().slice(k,z),fe=async()=>{try{const t=m.DELETE_DESIGNATION(G);await D.delete(t.url,{headers:t.headers}),J(),A(),q(N.filter(s=>N.desgination_id!==G)),_.success("Deleted successfully")}catch{_.error("Failed to delete")}},je=t=>{H(t.target.files[0]),Y("Upload")},be=()=>{Z==="Bulk Upload"?document.getElementById("fileInput").click():Ne(oe)},Ne=async t=>{try{const s=new FormData;s.append("file",t),(await D.post(m.UPLOAD_DESIGNATION.url,s,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(Y("Bulk Upload"),H(null),A(),_.success("Data Uploaded Successfully")):_.error("Data failed to Upload")}catch(s){console.log(s)}},ye=t=>{ce(t.target.value)},De=async t=>{if(t==="csv"){const s=N.map(d=>({desgination_id:d.desgination_id,designation:d.designation,dept_name:d.dept_name,org_name:d.org_name,status:d.status,created_by_user:d.created_by_user})),y=[Object.keys(s[0]).join(","),...s.map(d=>Object.values(d).join(","))].join(`
`),f=new Blob([y],{type:"text/csv;charset=utf-8;"}),E=window.URL.createObjectURL(f),c=document.createElement("a");c.setAttribute("href",E),c.setAttribute("download","Designation_data.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}else if(t==="pdf")try{const y=Math.ceil(N.length/30),f=new ke("l","mm","a4");let E=0;for(let c=1;c<=y;c++){const d=(c-1)*30,we=Math.min(d+30,N.length),Se=N.slice(d,we).map(O=>[O.desgination_id,O.designation,O.dept_name,O.org_name,O.status,O.created_by_user]);f.text(`Page ${c}`,10,E+10),f.autoTable({startY:E+15,head:[["Designation ID","Designation","DeptName","OrgName","Status","createdBy"]],body:Se,theme:"striped"}),c<y&&(f.addPage(),E=10)}f.save("Designation_data.pdf")}catch(s){console.error("Error exporting data:",s)}},_e=()=>{Oe(Ve)};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsx(Ce,{value:B,onChange:t=>te(t.target.value),placeholder:"Search Designation"}),I&&e.jsx(Ge,{onChange:je,buttonText:Z,accept:".csv",onClick:be}),g&&e.jsx(Ae,{selectedDoc:le,onChange:ye,exportData:De})]}),e.jsx(Be,{title:"Designation",hasCreatePermission:I,onClick:()=>h(!0)}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 overflow-x-auto h-3/5 no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Designation ",e.jsx(P,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-3 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Department Name ",e.jsx(P,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5 my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["Org Name ",e.jsx(P,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold  whitespace-nowrap",children:["Status ",e.jsx(P,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(P,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(P,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-semibold font-lexend  whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:ue.map((t,s)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center text-gray-800",children:k+s+1<10?`0${k+s+1}`:k+s+1})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.designation})}),e.jsx("td",{children:e.jsxs("div",{className:"flex  gap-2 items-center justify-start mx-3 my-3  text-sm text-gray-800",children:[e.jsx("img",{src:Ee,alt:"logo",className:"w-8 h-8"}),e.jsxs("p",{className:"font-lexend whitespace-nowrap capitalize   text-gray-800",children:[" ",t.dept_name]})]})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"capitalize mx-3 my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.org_name})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize mx-1.5  my-2  font-lexend text-start whitespace-nowrap text-sm text-gray-800",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-800 ",children:ve(t.createdAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Ie,{onClick:()=>L(s)}),ie(s)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[w&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{o(!0),F(t.desgination_id),L()},children:"Edit"}),T&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{l(!0),j(t.desgination_id),L()},children:"Delete"})]})]})})]},s))})]})}),e.jsxs("div",{className:" my-3 mb-5 mx-7",children:[e.jsx(Fe,{handleDownload:_e}),e.jsx(Pe,{Length:N.length,currentPage:U,totalPages:R,firstIndex:k,lastIndex:z,paginate:de,hasNextPage:z>=K.length})]})]})}),i&&e.jsx(ze,{toggleModal:me,toggleCloseModal:ge,ExistingOrganiZations:r,ExistingDepartments:u,handlerefresh:A}),S&&e.jsx(Le,{toggleModal:xe,handlerefresh:A,ExistingOrganiZations:r,ExistingDepartments:u,desgId:V}),p&&e.jsx(Te,{toggleDeleteModal:J,delete:fe})]})};export{at as default};
