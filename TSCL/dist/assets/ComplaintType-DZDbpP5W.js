import{i as F,k as v,r as a,m as U,o as q,j as e,b as w,B as E,d as z,q as Y,s as le}from"./index-Cb3AN3R3.js";import{R as N}from"./index-C-hq6bKM.js";import{S as B}from"./SavaCancel-CuKZ8TfL.js";import{A as u}from"./ApiClient-w4qWO__2.js";import{D as re}from"./DeleteModal-De28Bu6M.js";import{P as oe}from"./Pagination-ClPqWgoN.js";import{S as ne}from"./SearchHeader-Cu036AJA.js";import"./index-Du0g9a49.js";import"./index-BK6gNoz8.js";const ce=F().shape({complaint_type:v().required("complaint_type is required")}),de=s=>{const[p,c]=a.useState(!1),{register:d,formState:{errors:i},handleSubmit:o,watch:g}=U({resolver:q(ce),mode:"all"}),y=async h=>{const f={...h,status:"active",created_by_user:localStorage.getItem("name")};try{c(!0);const r=await w.post(u.POST_COMPLAINTTYPE.url,f,{headers:u.POST_COMPLAINTTYPE.headers});r.status===200?(E.success(" created Successfully"),c(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",r),c(!1),E.error("Failed to Upload"))}catch(r){console.error("Error in posting data",r),c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Complaint Type"})}),e.jsxs("form",{onSubmit:o(y),children:[e.jsxs("div",{className:"mx-6 my-10",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...d("complaint_type")}),i.complaint_type&&e.jsx("p",{className:"text-red-500",children:i.complaint_type.message})]}),e.jsx(B,{onCancel:s.toggleModal,isLoading:p})]})]})})},ie=F().shape({complaint_type:v().required("complaint_type is required"),status:v().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),me=s=>{const{comptId:p}=s,[c,d]=a.useState(!1),{register:i,formState:{errors:o},handleSubmit:g,watch:y,setValue:h}=U({resolver:q(ie),mode:"all"});a.useEffect(()=>{(async()=>{try{const n=u.FETCH_COMPLAINTTYPE(p),m=await w.get(n.url,{headers:n.headers}),x=z(m.data.data);h("complaint_type",x.complaint_type),h("status",x.status)}catch(n){console.error("Error fetching data",n)}})()},[p,h]);const f=async r=>{const n={...r};try{d(!0);const m=u.UPDATE_COMPLAINTTYPE(p),x=await w.post(m.url,n,{headers:m.headers});x.status===200?(E.success(" created Successfully"),d(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",x),d(!1),E.error("Failed to Upload"))}catch(m){console.error("Error in posting data",m),d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Edit Complaint Type"})}),e.jsxs("form",{onSubmit:g(f),children:[e.jsxs("div",{className:"mx-6 my-4",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...i("complaint_type")}),o.complaint_type&&e.jsx("p",{className:"text-red-500",children:o.complaint_type.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-4",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...i("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),o.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-2 mb-2 ",children:o.status.message})]}),e.jsx(B,{onCancel:s.toggleModal,isLoading:c})]})]})})},we=({permissions:s})=>{const p=s==null?void 0:s.includes("create"),c=s==null?void 0:s.includes("edit"),d=s==null?void 0:s.includes("delete"),[i,o]=a.useState(!1),[g,y]=a.useState(!1),[h,f]=a.useState(null),[r,n]=a.useState(!1),[m,x]=a.useState(null),[C,V]=a.useState(""),[T,$]=a.useState(1),[j]=a.useState(8),[I,G]=a.useState(1),[xe,R]=a.useState([]),[D,H]=a.useState([]),[M,J]=a.useState(null);localStorage.getItem("token");const _=t=>{J(M===t?null:t)},K=t=>M===t;a.useEffect(()=>{S()},[C,T]);const Q=t=>{t>0&&t<=I&&$(t)},S=()=>{w.get(u.GET_COMPLAINTTYPE.url,{headers:u.GET_COMPLAINTTYPE.headers}).then(t=>{const l=z(t.data.data);H(l);const O=l.filter(se=>Object.values(se).some(ae=>ae.toString().toLowerCase().includes(C.toLowerCase())));G(Math.ceil(O.length/j));const k=T*j,te=k-j;R(O.slice(te,k))}).catch(t=>{console.error(t)})},W=()=>{o(!i)},X=()=>{y(!g),f(null)},A=()=>{n(!r),x(null)},P=T*j,b=P-j,L=D.filter(t=>Object.values(t).some(l=>l.toString().toLowerCase().includes(C.toLowerCase()))),Z=L.slice().reverse().slice(b,P),ee=async()=>{try{const t=u.DELETE_COMPLAINTTYPE(m);await w.delete(t.url,{headers:t.headers}),A(),S(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(a.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen mt-10",children:[e.jsx(ne,{title:"Complaint Type",hasCreatePermission:p,onClick:()=>o(!0),searchValue:C,setSearchValue:V}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto  no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Complaint Type",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Status",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["UpdatedAt ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 font-semibold font-lexend whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:Z.map((t,l)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-center whitespace-nowrap text-sm text-gray-700",children:b+l+1<10?`0${b+l+1}`:b+l+1})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.complaint_type})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:Y(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:Y(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(le,{onClick:()=>_(l)}),K(l)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[c&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{y(!0),f(t.compliant_type_id),_()},children:"Edit"}),d&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{n(!0),x(t.compliant_type_id),_()},children:"Delete"})]})]})})]},l))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsx(oe,{Length:D.length,currentPage:T,totalPages:I,firstIndex:b,lastIndex:P,paginate:Q,hasNextPage:P>=L.length})})]})}),i&&e.jsx(de,{toggleModal:W,handlerefresh:S}),g&&e.jsx(me,{toggleModal:X,handlerefresh:S,comptId:h}),r&&e.jsx(re,{toggleDeleteModal:A,delete:ee})]})};export{we as default};
