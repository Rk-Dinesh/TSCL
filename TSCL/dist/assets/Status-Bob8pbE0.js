import{c as O,a as w,u as L,o as R,j as e,b as N,A as v,B as D,r as a,d as U,I as re,F as le,f as q,e as ne}from"./index-B-0fny-6.js";import{R as _}from"./index-BhEqOQck.js";import{D as oe}from"./DeleteModal-B8xG_S-n.js";import"./index-DcwmNplq.js";const ce=/^#([0-9A-F]{3}){1,2}$/i,ie=O().shape({status_name:w().required("status is required"),color:w().matches(ce,"Enter a valid hex color code").required("Color is required")}),de=s=>{const{register:d,formState:{errors:c},handleSubmit:u,watch:o}=L({resolver:R(ie),mode:"all"}),p=async g=>{const i={...g,status:"active",created_by_user:"admin"};try{const h=sessionStorage.getItem("token"),x=await N.post(`${v}/status/post`,i,{headers:{Authorization:`Bearer ${h}`}});x.status===200?(D.success(" created Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",x),D.error("Failed to Upload"))}catch(h){console.error("Error in posting data",h)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Status"})}),e.jsxs("form",{onSubmit:u(p),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"status_name",children:"Status"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"status_name",type:"text",placeholder:"Status",...d("status_name")}),c.status_name&&e.jsx("p",{className:"text-red-500",children:c.status_name.message})]}),e.jsxs("div",{className:"mx-6 my-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"color",children:"Color"}),e.jsx("input",{className:"w-1/2 rounded-full outline-none bg-transparent",id:"color",type:"color",list:"allowed-colors",...d("color")}),e.jsxs("datalist",{id:"allowed-colors",children:[e.jsx("option",{value:"#111827"}),e.jsx("option",{value:"#14532d"}),e.jsx("option",{value:"#eab308"}),e.jsx("option",{value:"#1e40af"}),e.jsx("option",{value:"#65a30d"})]}),c.color&&e.jsx("p",{className:"text-red-500",children:c.color.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},xe=/^#([0-9A-F]{3}){1,2}$/i,me=O().shape({status_name:w().required("status is required"),color:w().matches(xe,"Enter a valid hex color code").required("Color is required"),status:w().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),ue=s=>{const{status_id:d}=s,c=sessionStorage.getItem("token"),{register:u,formState:{errors:o},handleSubmit:p,watch:g,setValue:i}=L({resolver:R(me),mode:"all"});a.useEffect(()=>{(async()=>{try{const m=await N.get(`${v}/status/getbyid?status_id=${d}`,{headers:{Authorization:`Bearer ${c}`}}),l=U(m.data.data);i("status_name",l.status_name),i("color",l.color),i("status",l.status)}catch(m){console.error("Error fetching data",m)}})()},[d,i]);const h=async x=>{const m={...x};try{const l=await N.post(`${v}/status/update?status_id=${d}`,m,{headers:{Authorization:`Bearer ${c}`}});l.status===200?(D.success(" Updated Successfully"),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",l),D.error("Failed to Upload"))}catch(l){console.error("Error in posting data",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 ",children:"Edit status"})}),e.jsxs("form",{onSubmit:p(h),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"status_name",children:"Status"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"status_name",type:"text",placeholder:"status ",...u("status_name")}),o.status_name&&e.jsx("p",{className:"text-red-500",children:o.status_name.message})]}),e.jsxs("div",{className:"mx-6 my-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"color",children:"Color"}),e.jsx("input",{className:"w-1/2 rounded-full outline-none bg-transparent",id:"color",type:"color",list:"allowed-colors",...u("color")}),e.jsxs("datalist",{id:"allowed-colors",children:[e.jsx("option",{value:"#111827"}),e.jsx("option",{value:"#14532d"}),e.jsx("option",{value:"#eab308"}),e.jsx("option",{value:"#1e40af"}),e.jsx("option",{value:"#65a30d"})]}),o.color&&e.jsx("p",{className:"text-red-500",children:o.color.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-4",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...u("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),o.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-2 mb-2 ",children:o.status.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:s.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},fe=({permissions:s})=>{const d=s==null?void 0:s.includes("create"),c=s==null?void 0:s.includes("edit"),u=s==null?void 0:s.includes("delete"),[o,p]=a.useState(!1),[g,i]=a.useState(!1),[h,x]=a.useState(null),[m,l]=a.useState(!1),[T,A]=a.useState(null),[S,V]=a.useState(""),[n,G]=a.useState(1),[b]=a.useState(8),[j,H]=a.useState(1),[he,J]=a.useState([]),[M,K]=a.useState([]),[I,Q]=a.useState(null),E=sessionStorage.getItem("token"),$=t=>{Q(I===t?null:t)},W=t=>I===t;a.useEffect(()=>{k()},[S,n]);const f=t=>{t>0&&t<=j&&G(t)},k=()=>{N.get(`${v}/status/get`,{headers:{Authorization:`Bearer ${E}`}}).then(t=>{const r=U(t.data.data);K(r);const z=r.filter(se=>Object.values(se).some(ae=>ae.toString().toLowerCase().includes(S.toLowerCase())));H(Math.ceil(z.length/b));const B=n*b,te=B-b;J(z.slice(te,B))}).catch(t=>{console.error(t)})},X=()=>{p(!o)},Y=()=>{i(!g),x(null)},F=()=>{l(!m),A(null)},C=n*b,y=C-b,P=M.filter(t=>Object.values(t).some(r=>r.toString().toLowerCase().includes(S.toLowerCase()))),Z=P.slice().reverse().slice(y,C),ee=async()=>{try{await N.delete(`${v}/status/delete?status_id=${T}`,{headers:{Authorization:`Bearer ${E}`}}),F(),k(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(a.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen mt-10",children:[e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 flex-wrap gap-3",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:" Status"}),e.jsxs("div",{className:"flex items-center  gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-2 py-1.5 rounded-full ",children:[e.jsx(re,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Type",value:S,onChange:t=>V(t.target.value)})]}),d&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-1.5 w-fit justify-between px-3 md:text-base text-sm",onClick:()=>p(!0),children:[e.jsx(le,{})," Add Status"]})]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto  no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Status Name",e.jsx(_,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(_,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(_,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["UpdatedAt ",e.jsx(_,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 font-semibold font-lexend whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:Z.map((t,r)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-center whitespace-nowrap text-sm text-gray-700",children:y+r+1<10?`0${y+r+1}`:y+r+1})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status_name})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:q(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:q(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(ne,{onClick:()=>$(r)}),W(r)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[c&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{i(!0),x(t.status_id),$()},children:"Edit"}),u&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{l(!0),A(t.status_id),$()},children:"Delete"})]})]})})]},r))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[y+1," to ",Math.min(C,M.length)]})," ","of"," ",e.jsxs("span",{className:"text-gray-900",children:[M.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>f(1),disabled:n===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(n-1),disabled:n===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:j},(t,r)=>r+1).slice(Math.max(0,n-2),Math.min(j,n+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>f(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${n===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(n+1),disabled:C>=P.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(j),disabled:n===j,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),o&&e.jsx(de,{toggleModal:X,handlerefresh:k}),g&&e.jsx(ue,{toggleModal:Y,handlerefresh:k,status_id:h}),m&&e.jsx(oe,{toggleDeleteModal:F,delete:ee})]})};export{fe as default};
