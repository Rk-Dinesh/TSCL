import{c as O,a as M,u as L,o as q,j as e,b as N,A as v,B as k,r as s,d as U,I as re,F as le,f as B,e as ne}from"./index-B-0fny-6.js";import{R as w}from"./index-BhEqOQck.js";import{D as oe}from"./DeleteModal-B8xG_S-n.js";import"./index-DcwmNplq.js";const ce=O().shape({complaint_type:M().required("complaint_type is required")}),ie=a=>{const{register:x,formState:{errors:m},handleSubmit:h,watch:o}=L({resolver:q(ce),mode:"all"}),u=async g=>{const c={...g,status:"active",created_by_user:"admin"};try{const p=sessionStorage.getItem("token"),i=await N.post(`${v}/complainttype/post`,c,{headers:{Authorization:`Bearer ${p}`}});i.status===200?(k.success(" created Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",i),k.error("Failed to Upload"))}catch(p){console.error("Error in posting data",p)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Complaint Type"})}),e.jsxs("form",{onSubmit:h(u),children:[e.jsxs("div",{className:"mx-6 my-10",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...x("complaint_type")}),m.complaint_type&&e.jsx("p",{className:"text-red-500",children:m.complaint_type.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},de=O().shape({complaint_type:M().required("complaint_type is required"),status:M().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),xe=a=>{const{comptId:x}=a,m=sessionStorage.getItem("token"),{register:h,formState:{errors:o},handleSubmit:u,watch:g,setValue:c}=L({resolver:q(de),mode:"all"});s.useEffect(()=>{(async()=>{try{const d=await N.get(`${v}/complainttype/getbyid?compliant_type_id=${x}`,{headers:{Authorization:`Bearer ${m}`}}),n=U(d.data.data);c("complaint_type",n.complaint_type),c("status",n.status)}catch(d){console.error("Error fetching data",d)}})()},[x,c]);const p=async i=>{const d={...i};try{const n=await N.post(`${v}/complainttype/update?compliant_type_id=${x}`,d,{headers:{Authorization:`Bearer ${m}`}});n.status===200?(k.success(" created Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",n),k.error("Failed to Upload"))}catch(n){console.error("Error in posting data",n)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[330px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Edit Complaint Type"})}),e.jsxs("form",{onSubmit:u(p),children:[e.jsxs("div",{className:"mx-6 my-4",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-4",htmlFor:"complaint_type",children:"Complaint Type"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint_type",type:"text",placeholder:"Complaint Type",...h("complaint_type")}),o.complaint_type&&e.jsx("p",{className:"text-red-500",children:o.complaint_type.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3 mx-10 my-4",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...h("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),o.status&&e.jsx("p",{className:"text-red-500 text-xs text-center -mt-2 mb-2 ",children:o.status.message})]}),e.jsxs("div",{className:"flex justify-end  mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",type:"submit",children:"Save"})]})]})]})})},ye=({permissions:a})=>{const x=a==null?void 0:a.includes("create"),m=a==null?void 0:a.includes("edit"),h=a==null?void 0:a.includes("delete"),[o,u]=s.useState(!1),[g,c]=s.useState(!1),[p,i]=s.useState(null),[d,n]=s.useState(!1),[V,A]=s.useState(null),[C,R]=s.useState(""),[l,G]=s.useState(1),[y]=s.useState(8),[b,H]=s.useState(1),[me,J]=s.useState([]),[D,K]=s.useState([]),[$,Q]=s.useState(null),E=sessionStorage.getItem("token"),I=t=>{Q($===t?null:t)},W=t=>$===t;s.useEffect(()=>{S()},[C,l]);const f=t=>{t>0&&t<=b&&G(t)},S=()=>{N.get(`${v}/complainttype/get`,{headers:{Authorization:`Bearer ${E}`}}).then(t=>{const r=U(t.data.data);K(r);const z=r.filter(ae=>Object.values(ae).some(se=>se.toString().toLowerCase().includes(C.toLowerCase())));H(Math.ceil(z.length/y));const F=l*y,te=F-y;J(z.slice(te,F))}).catch(t=>{console.error(t)})},X=()=>{u(!o)},Y=()=>{c(!g),i(null)},T=()=>{n(!d),A(null)},_=l*y,j=_-y,P=D.filter(t=>Object.values(t).some(r=>r.toString().toLowerCase().includes(C.toLowerCase()))),Z=P.slice().reverse().slice(j,_),ee=async()=>{try{await N.delete(`${v}/complainttype/delete?compliant_type_id=${V}`,{headers:{Authorization:`Bearer ${E}`}}),T(),S(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(s.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen mt-10",children:[e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 flex-wrap gap-3",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:" Complaint Type"}),e.jsxs("div",{className:"flex items-center  gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-2 py-1.5 rounded-full ",children:[e.jsx(re,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Type",value:C,onChange:t=>R(t.target.value)})]}),x&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-1.5 w-fit justify-between px-3 md:text-base text-sm",onClick:()=>u(!0),children:[e.jsx(le,{})," Add Complaint Type"]})]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto  no-scrollbar",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Complaint Type",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font- whitespace-nowrap",children:["Status",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedBy ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["CreatedAt ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center mx-1.5  my-2 font-lexend justify-start font-semibold whitespace-nowrap",children:["UpdatedAt ",e.jsx(w,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 font-semibold font-lexend whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:Z.map((t,r)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend text-center whitespace-nowrap text-sm text-gray-700",children:j+r+1<10?`0${j+r+1}`:j+r+1})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.complaint_type})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend text-start whitespace-nowrap text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:B(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:B(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(ne,{onClick:()=>I(r)}),W(r)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[m&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{c(!0),i(t.compliant_type_id),I()},children:"Edit"}),h&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{n(!0),A(t.compliant_type_id),I()},children:"Delete"})]})]})})]},r))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[j+1," to ",Math.min(_,D.length)]})," ","of"," ",e.jsxs("span",{className:"text-gray-900",children:[D.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>f(1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(l-1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:b},(t,r)=>r+1).slice(Math.max(0,l-2),Math.min(b,l+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>f(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${l===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(l+1),disabled:_>=P.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>f(b),disabled:l===b,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),o&&e.jsx(ie,{toggleModal:X,handlerefresh:S}),g&&e.jsx(xe,{toggleModal:Y,handlerefresh:S,comptId:p}),d&&e.jsx(oe,{toggleDeleteModal:T,delete:ee})]})};export{ye as default};
