import{i as G,k as g,r as l,m as J,o as K,j as e,b as S,A as k,B as v,d as Q,s as Ne,v as _e}from"./index-Cb3AN3R3.js";import{R as C}from"./index-C-hq6bKM.js";import{S as W}from"./SavaCancel-CuKZ8TfL.js";import{D as we}from"./DeleteModal-De28Bu6M.js";import{S as Pe,D as Se,E as ke}from"./DocumentDownload-A0b-q8L_.js";import{B as De}from"./BulkUploadButton-C25cRLG1.js";import{P as Ie}from"./Pagination-ClPqWgoN.js";import{F as Ue}from"./FileUploadButton-DWkzr3As.js";import{H as Ce}from"./HeaderButton-By5upfsz.js";import"./index-Du0g9a49.js";import"./index-CmROlnnr.js";import"./index-BK6gNoz8.js";const Ee=G().shape({public_user_name:g().trim().required("User Name is required"),phone:g().test("len","Phone Number must be 10 characters",s=>s.length===10).required("Phone Number is required"),email:g().email("Invalid Email Id").required("Email Id is required"),address:g().required("Address is required"),pincode:g().test("len","Pincode must be 6 characters",s=>s.length===6).required("Pincode is required")}),Ae=s=>{const[f,u]=l.useState(!1),{register:x,formState:{errors:r},handleSubmit:h,setValue:o,watch:D}=J({resolver:K(Ee),mode:"all"}),m=async E=>{const P={...E,login_password:"tscl@123",user_status:"active",verification_status:"active"},y=localStorage.getItem("token");try{u(!0);const d=await S.post(`${k}/public-user/post`,P,{headers:{Authorization:`Bearer ${y}`}});d.status===200?(v.success("Public User created Successfully"),u(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",d),u(!1),v.error("Failed to Upload"))}catch(d){console.error("Error in posting data",d),u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsx("div",{className:"bg-white w-fit h-fit  font-lexend m-2",children:e.jsxs("form",{onSubmit:h(m),children:[e.jsxs("div",{className:"border-b-2 border-gray-300 mx-10 my-5",children:[e.jsxs("div",{className:" grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"block text-black text-lg font-medium mb-2 col-span-1 whitespace-nowrap",htmlFor:"public_user_name",children:"Name"}),e.jsx("input",{type:"text",id:"public_user_name",className:"mx-2 font-lexend px-2 text-sm text-end outline-none col-span-2",placeholder:"User Name",...x("public_user_name")})]}),r.public_user_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:r.public_user_name.message})]}),e.jsxs("div",{className:" flex flex-col gap-3 mx-10 my-1 ",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"Phone",children:"Phone :"}),e.jsx("input",{type:"text",id:"phone",className:"w-6/5 text-end outline-none col-span-2",placeholder:"Phone Number",...x("phone")})]}),r.phone&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:r.phone.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"email",children:"Email Id :"}),e.jsx("input",{type:"email",id:"email",className:" text-end outline-none col-span-2",placeholder:"abc@gmail.com",...x("email")})]}),r.email&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:r.email.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"address",children:"Address :"}),e.jsx("input",{type:"text",id:"address",className:" text-end outline-none col-span-2",placeholder:"Address",...x("address")})]}),r.address&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:r.address.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"pincode",children:"Pincode :"}),e.jsx("input",{type:"text",id:"pincode",className:" text-end outline-none col-span-2",placeholder:"Pincode ",...x("pincode")})]}),r.pincode&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:r.pincode.message})]})]}),e.jsx("div",{className:"py-6",children:e.jsx(W,{onCancel:s.toggleModal,isLoading:f})})]})})})},Fe=G().shape({public_user_name:g().required("User Name is required"),address:g().required("Address is required"),pincode:g().required("Pincode is required"),user_status:g().test("not-select","Please select an Status",s=>s!==""&&s!=="Status")}),$e=s=>{const{userId:f}=s,u=localStorage.getItem("token"),[x,r]=l.useState(!1),{register:h,formState:{errors:o},handleSubmit:D,setValue:m,watch:E}=J({resolver:K(Fe),mode:"all"});l.useEffect(()=>{(async()=>{try{const d=await S.get(`${k}/public-user/getbyid?public_user_id=${f}`,{headers:{Authorization:`Bearer ${u}`}}),i=Q(d.data.data);m("public_user_name",i.public_user_name),m("address",i.address),m("pincode",i.pincode),m("user_status",i.user_status)}catch(d){console.error("Error fetching data",d)}})()},[f,m]);const P=async y=>{const d={...y};try{r(!0);const i=await S.post(`${k}/public-user/update?public_user_id=${f}`,d,{headers:{Authorization:`Bearer ${u}`}});i.status===200?(v.success("Public User Updated Successfully"),r(!1),s.toggleModal(),s.handlerefresh()):(console.error("Error in posting data",i),r(!1),v.error("Failed to Upload"))}catch(i){console.error("Error in posting data",i),r(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsx("div",{className:"bg-white w-fit h-fit  font-lexend m-2",children:e.jsxs("form",{onSubmit:D(P),children:[e.jsxs("div",{className:"border-b-2 border-gray-300 mx-10 my-5",children:[e.jsxs("div",{className:" grid grid-cols-3 gap-3",children:[e.jsx("label",{className:"block text-black text-lg font-medium mb-2 col-span-1 whitespace-nowrap",htmlFor:"public_user_name",children:"Name"}),e.jsx("input",{type:"text",id:"public_user_name",className:"mx-2 font-lexend px-2 text-sm text-end outline-none col-span-2",placeholder:"User Name",...h("public_user_name")})]}),o.public_user_name&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:o.public_user_name.message})]}),e.jsxs("div",{className:" flex flex-col gap-3 mx-10 my-1 ",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"address",children:"Address :"}),e.jsx("input",{type:"text",id:"address",className:" text-end outline-none col-span-2",placeholder:"Address",...h("address")})]}),o.address&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:o.address.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-1",htmlFor:"pincode",children:"Pincode :"}),e.jsx("input",{type:"text",id:"pincode",className:" text-end outline-none col-span-2",placeholder:"Pincode ",...h("pincode")})]}),o.pincode&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:o.pincode.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:" grid grid-cols-3",children:[e.jsx("label",{className:" text-black text-lg font-medium mb-2 col-span-2",htmlFor:"user_status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"user_status",...h("user_status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),o.user_status&&e.jsx("p",{className:"text-red-500 text-xs text-end ",children:o.user_status.message})]})]}),e.jsx("div",{className:"py-6",children:e.jsx(W,{onCancel:s.toggleModal,isLoading:x})})]})})})},Be=`public_user_name,phone,email,address,pincode,login_password,verification_status,user_status,role
user,1234567890,email@gmail.com, Address,123456,password,verified,status,user`,We=({permissions:s})=>{const f=s==null?void 0:s.includes("create"),u=s==null?void 0:s.includes("edit"),x=s==null?void 0:s.includes("delete"),r=s==null?void 0:s.includes("download"),[h,o]=l.useState(!1),[D,m]=l.useState(!1),[E,P]=l.useState(null),[y,d]=l.useState(!1),[i,M]=l.useState(null),[A,X]=l.useState(""),[F,q]=l.useState(1),[N,Z]=l.useState(10),[L,ee]=l.useState(1),[Me,te]=l.useState([]),[_,se]=l.useState([]),[z,ae]=l.useState(null),O=localStorage.getItem("token"),[le,V]=l.useState(null),[T,R]=l.useState("Bulk Upload"),[re,ne]=l.useState(null),B=t=>{ae(z===t?null:t)},ce=t=>z===t;l.useEffect(()=>{I()},[A,F,N]);const de=t=>{t>0&&t<=L&&q(t)},I=()=>{S.get(`${k}/public-user/get`,{headers:{Authorization:`Bearer ${O}`}}).then(t=>{const a=Q(t.data.data);se(a);const b=a.filter(c=>Object.values(c).some(n=>n.toString().toLowerCase().includes(A.toLowerCase())));ee(Math.ceil(b.length/N));const p=F*N,w=p-N;te(b.slice(w,p))}).catch(t=>{console.error(t)})},oe=()=>{o(!h)},ie=()=>{m(!D),P(null)},H=()=>{d(!y),M(null)},$=F*N,U=$-N,Y=_.filter(t=>Object.values(t).some(a=>a.toString().toLowerCase().includes(A.toLowerCase()))),me=Y.slice().reverse().slice(U,$),ue=async()=>{try{await S.delete(`${k}/public-user/delete?public_user_id=${i}`,{headers:{Authorization:`Bearer ${O}`}}),H(),I(),v.success("Deleted successfully")}catch{v.error("Failed to delete")}},xe=t=>{V(t.target.files[0]),R("Upload")},he=()=>{T==="Bulk Upload"?document.getElementById("fileInput").click():pe(le)},pe=async t=>{try{const a=new FormData;a.append("file",t),(await S.post(`${k}/public-user/uploadcsv`,a,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(R("Bulk Upload"),V(null),I(),v.success("Data Uploaded Successfully")):v.error("Data failed to Upload")}catch(a){console.log(a)}},ge=t=>{ne(t.target.value)},fe=async t=>{if(t==="csv"){const a=_.map(n=>({public_user_id:n.public_user_id,public_user_name:n.public_user_name,phone:n.phone,email:n.email,address:n.address,pincode:n.pincode,verification_status:n.verification_status,user_status:n.user_status})),b=[Object.keys(a[0]).join(","),...a.map(n=>Object.values(n).join(","))].join(`
`),p=new Blob([b],{type:"text/csv;charset=utf-8;"}),w=window.URL.createObjectURL(p),c=document.createElement("a");c.setAttribute("href",w),c.setAttribute("download","User_data.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}else if(t==="pdf")try{const b=Math.ceil(_.length/30),p=new ke("l","mm","a4");let w=0;for(let c=1;c<=b;c++){const n=(c-1)*30,ve=Math.min(n+30,_.length),ye=_.slice(n,ve).map(j=>[j.public_user_id,j.public_user_name,j.phone,j.email,j.address,j.pincode,j.verification_status,j.user_status]);p.text(`Page ${c}`,10,w+10),p.autoTable({startY:w+15,head:[["UserId","UserName","Phone","Email","Address","Pincode","VerificationStatus"]],body:ye,theme:"striped"}),c<b&&(p.addPage(),w=10)}p.save("User_data.pdf")}catch(a){console.error("Error exporting data:",a)}},be=()=>{_e(Be)},je=t=>{const a=parseInt(t.target.value,10);Z(a),q(1)};return e.jsxs(l.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-2 mx-8 flex-wrap",children:[e.jsx(Pe,{value:A,onChange:t=>X(t.target.value),placeholder:"Search User"}),f&&e.jsx(Ue,{onChange:xe,buttonText:T,accept:".csv",onClick:he}),r&&e.jsx(Se,{selectedDoc:re,onChange:ge,exportData:fe})]}),e.jsx(Ce,{title:"Public User",hasCreatePermission:f,onClick:()=>o(!0)}),e.jsxs("div",{className:`bg-white  mx-4 rounded-lg overflow-x-auto mt-1  p-3 ${_.length<6?"h-3/5":"h-fit"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mx-3",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"font-medium text-gray-600",children:"Page Entries"}),e.jsxs("select",{id:"itemsPerPage",value:N,onChange:je,className:" p-1 outline-none text-sm rounded px-2",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]}),e.jsx("div",{className:"overflow-x-auto ",children:e.jsxs("table",{className:"w-full  mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Public Username ",e.jsx(C,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-3  my-2 font-lexend font-semibold whitespace-nowrap",children:["Phone",e.jsx(C,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Email",e.jsx(C,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Status",e.jsx(C,{})]})}),e.jsx("th",{children:e.jsxs("div",{className:"flex gap-2 items-center justify-start mx-1  my-2 font-lexend font-semibold whitespace-nowrap",children:["Verification Status",e.jsx(C,{})]})}),e.jsx("th",{children:e.jsx("div",{className:"mx-3 my-3 font-lexend font-semibold whitespace-nowrap text-center",children:"Action"})})]})}),e.jsx("tbody",{children:me.map((t,a)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("p",{className:"text-center text-sm mx-1 my-2 font-lexend whitespace-nowrap text-gray-700",children:U+a+1<10?`0${U+a+1}`:U+a+1})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.public_user_name})}),e.jsx("td",{children:e.jsx("p",{className:" mx-3  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.phone})}),e.jsx("td",{children:e.jsx("p",{className:"text-start text-sm mx-1  my-2 font-lexend  whitespace-nowrap capitalize text-gray-700",children:t.email})}),e.jsx("td",{children:e.jsx("p",{className:" mx-2  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.user_status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1  my-2 font-lexend whitespace-nowrap text-sm  capitalize text-gray-700",children:t.verification_status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Ne,{onClick:()=>B(a)}),ce(a)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[u&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{m(!0),P(t.public_user_id),B()},children:"Edit"}),x&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{d(!0),M(t.public_user_id),B()},children:"Delete"})]})]})})]},a))})]})})]}),e.jsxs("div",{className:" my-2 mb-5 mx-7",children:[e.jsx(De,{handleDownload:be}),e.jsx(Ie,{Length:_.length,currentPage:F,totalPages:L,firstIndex:U,lastIndex:$,paginate:de,hasNextPage:$>=Y.length})]})]})}),h&&e.jsx(Ae,{toggleModal:oe,handlerefresh:I}),D&&e.jsx($e,{toggleModal:ie,handlerefresh:I,userId:E}),y&&e.jsx(we,{toggleDeleteModal:H,delete:ue})]})};export{We as default};
