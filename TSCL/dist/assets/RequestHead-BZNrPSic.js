import{r as a,p as De,b as c,A as o,d,j as t,f as ke,e as $e}from"./index-B-0fny-6.js";import{R as r}from"./index-BhEqOQck.js";const Te=()=>{const[N,Me]=a.useState(""),[l,J]=a.useState(1),[p]=a.useState(10),[u,F]=a.useState(1),[Pe,G]=a.useState([]),[L,K]=a.useState([]),[R,Q]=a.useState([]),[Z,X]=a.useState([]),[W,ee]=a.useState([]),[H,te]=a.useState([]),[U,se]=a.useState([]),[S,ae]=a.useState([]),[V,ne]=a.useState([]),i=sessionStorage.getItem("token"),le=sessionStorage.getItem("dept"),re=De(),[Y,ie]=a.useState("All"),[O,ce]=a.useState({}),[A,_]=a.useState(null),[f,C]=a.useState(null),[j,y]=a.useState(null),[z,w]=a.useState(null),[D,k]=a.useState(null),[$,M]=a.useState(null),[P,E]=a.useState(null),[b,I]=a.useState(null);a.useEffect(()=>{c.get(`${o}/new-grievance/get`,{headers:{Authorization:`Bearer ${i}`}}).then(e=>{const s=d(e.data.data);ae(s);const m=s.filter(T=>Object.values(T).some(B=>B.toString().toLowerCase().includes(N.toLowerCase())));F(Math.ceil(m.length/p));const x=l*p,h=x-p;G(m.slice(h,x))}).catch(e=>{console.error(e)}),me(),oe(),de(),xe(),he(),ue(),pe()},[N,l]);const oe=async()=>{try{const e=await c.get(`${o}/zone/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);ee(s)}catch(e){console.error("Error fetching existing Dept:",e)}},de=async()=>{try{const e=await c.get(`${o}/ward/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);te(s)}catch(e){console.error("Error fetching existing Dept:",e)}},xe=async()=>{try{const e=await c.get(`${o}/street/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);se(s)}catch(e){console.error("Error fetching existing Dept:",e)}},me=async()=>{try{const e=await c.get(`${o}/department/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);X(s)}catch(e){console.error("Error fetching existing Dept:",e)}},he=async()=>{try{const e=await c.get(`${o}/status/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data),m=s.reduce((x,h)=>(x[h.status_name]=h.color,x),{});K(s),ce(m)}catch(e){console.error("Error fetching existing ActiveStatus:",e)}},pe=async()=>{try{const e=await c.get(`${o}/user/getbydept?dept_name=${le}`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);ne(s)}catch(e){sconsole.error("Error fetching existing ActiveStatus:",e)}},ue=async()=>{try{const e=await c.get(`${o}/complainttype/get`,{headers:{Authorization:`Bearer ${i}`}}),s=d(e.data.data);Q(s)}catch(e){console.error("Error fetching existing Complainttype:",e)}},n=e=>{e>0&&e<=u&&J(e)},v=l*p,g=v-p,q=S.filter(e=>Object.values(e).some(s=>s.toString().toLowerCase().includes(N.toLowerCase()))),ge=e=>{ie(e),_(null),C(null),y(null),k(null),M(null),E(null),I(null),n(1)},fe=e=>{_(e==="All"?null:e),n(1)},je=e=>{e==="All"?C(null):(C(e),y(null),w(null)),n(1)},ye=e=>{e==="All"?y(null):(y(e),w(null)),n(1)},we=e=>{w(e==="All"?null:e),n(1)},be=e=>{k(e==="All"?null:e),n(1)},ve=e=>{M(e==="All"?null:e),n(1)},Ne=e=>{E(e==="All"?null:e),n(1)},Se=e=>{I(e==="All"?null:e),n(1)},Ae=q.slice().reverse().filter(e=>{const s=Y==="All"?!0:"",m=A===null?!0:e.dept_name===A,x=f===null?!0:e.zone_name===f,h=j===null?!0:e.ward_name===j,T=z===null?!0:e.street_name===z,B=D===null?!0:e.status===D,_e=$===null?!0:e.complaint_type_title===$,Ce=P===null?!0:e.priority===P,ze=b===null?!0:b==="Yet to be Assigned"?!e.assign_username:e.assign_username===b;return s&&B&&m&&x&&h&&T&&_e&&Ce&&ze}).slice(g,v);return t.jsx("div",{className:"overflow-y-auto no-scrollbar",children:t.jsxs("div",{className:"  font-lexend h-screen ",children:[t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 mx-4",children:[t.jsx("button",{className:`w-20  py-1 ${Y==="All"?"bg-primary text-white":"bg-white text-black"} rounded-full`,onClick:()=>ge("All"),children:"All"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>fe(e.target.value),value:A||"",children:[t.jsx("option",{hidden:!0,children:"Department"}),t.jsx("option",{value:"All",children:"All"}),Z&&Z.map(e=>t.jsx("option",{value:e.dept_name,children:e.dept_name},e.dept_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>je(e.target.value),value:f||"",children:[t.jsx("option",{hidden:!0,children:"Zone"}),t.jsx("option",{value:"All",children:"All"}),W&&W.map(e=>t.jsx("option",{value:e.zone_name,children:e.zone_name},e.zone_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>ye(e.target.value),value:j||"",children:[t.jsx("option",{hidden:!0,children:"ward"}),t.jsx("option",{value:"All",children:"All"}),H&&H.filter(e=>e.zone_name===f).map(e=>t.jsx("option",{value:e.ward_name,children:e.ward_name},e.ward_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>we(e.target.value),value:z||"",children:[t.jsx("option",{hidden:!0,children:"Area"}),t.jsx("option",{value:"All",children:"All"}),U&&U.filter(e=>e.ward_name===j).map(e=>t.jsx("option",{value:e.street_name,children:e.street_name},e.street_id))]})})]}),t.jsxs("div",{className:"bg-white h-4/5 mx-3 rounded-lg mt-4  p-3",children:[t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center md:gap-6 gap-2 md:mt-2 mx-3",children:[t.jsx("div",{className:"flex flex-wrap gap-3",children:t.jsx("p",{className:"md:text-lg text-sm whitespace-nowrap",children:"View Report"})}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>Se(e.target.value),value:b||"",children:[t.jsx("option",{hidden:!0,children:"Select Assign"}),t.jsx("option",{value:"All",children:"All"}),t.jsx("option",{value:"Yet to be Assigned",children:"Yet to be Assigned"}),V&&V.map(e=>t.jsx("option",{value:e.user_name,children:e.user_name},e.user_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>Ne(e.target.value),value:P||"",children:[t.jsx("option",{hidden:!0,children:"Priority"}),t.jsx("option",{value:"All",children:"All"}),t.jsx("option",{value:"High",children:"High"}),t.jsx("option",{value:"Medium",children:"Medium"}),t.jsx("option",{value:"Low",children:"Low"})]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>be(e.target.value),value:D||"",children:[t.jsx("option",{hidden:!0,children:"Status"}),t.jsx("option",{value:"All",children:"All"}),L&&L.map(e=>t.jsx("option",{value:e.status_name,children:e.status_name},e.status_id))]})}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:t.jsxs("select",{className:"block w-full  px-1 md:py-2 py-1.5 text-center  text-sm bg-primary text-white  border border-none rounded-full  hover:border-gray-200 outline-none capitalize",onChange:e=>ve(e.target.value),value:$||"",children:[t.jsx("option",{hidden:!0,children:"Complaint Type"}),t.jsx("option",{value:"All",children:"All"}),R&&R.map(e=>t.jsx("option",{value:e.complaint_type,children:e.complaint_type},e.compliant_type_id))]})})]})]}),t.jsx("div",{className:" rounded-lg  md:py-3 py-1 overflow-x-auto no-scrollbar",children:t.jsxs("table",{className:"w-full md:mt-1 ",children:[t.jsx("thead",{className:" border-b border-gray-300  ",children:t.jsxs("tr",{className:"",children:[t.jsx("th",{className:"",children:t.jsx("p",{className:" mx-6 my-2 font-lexend font-medium whitespace-nowrap",children:"#"})}),t.jsx("th",{children:t.jsx("p",{className:"mx-1.5 my-2 text-start font-lexend font-medium  whitespace-nowrap",children:"Complaint No"})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint Type",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Department",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Date and Time ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Raised by ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Zone ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Ward ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Street ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Assigned JE ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Priority ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Status ",t.jsx(r,{})]})}),t.jsx("th",{children:t.jsx("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:"Action"})})]})}),t.jsx("tbody",{children:Ae.map((e,s)=>t.jsxs("tr",{className:" border-b border-gray-300  ",children:[t.jsx("td",{className:"",children:t.jsx("div",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap",children:g+s+1<10?`0${g+s+1}`:g+s+1})}),t.jsx("td",{children:t.jsx("p",{className:"border-2 w-28 border-slate-900 rounded-lg text-center py-1 my-1  capitalize text-slate-900",children:e.grievance_id})}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.complaint_type_title})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.dept_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.complaint})]}),t.jsx("td",{children:t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:ke(e.createdAt)})}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.public_user_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.zone_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.ward_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.street_name})]}),t.jsxs("td",{children:[" ",t.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:e.assign_username?e.assign_username:"Yet to be assigned"})]}),t.jsx("td",{children:t.jsx("p",{className:`border w-26 rounded-full text-center py-1.5 mx-2 text-sm font-normal capitalize text-white  ${e.priority==="High"?"bg-red-500":e.priority==="Medium"?"bg-green-500":e.priority==="Low"?"bg-sky-500":""}`,children:e.priority})}),t.jsx("td",{children:t.jsx("p",{className:"border-2 w-28 rounded-full text-center py-1 tex-sm font-normal mx-2 capitalize  ",style:{borderColor:O[e.status]||"gray",color:O[e.status]||"black",fontSize:14},children:e.status})}),t.jsx("td",{children:t.jsx("div",{className:"mx-3 my-3 whitespace-nowrap",onClick:()=>re("/view",{state:{grievanceId:e.grievance_id,deptName:e.dept_name}}),children:t.jsx($e,{})})})]},s))})]})})]}),t.jsx("div",{className:" mt-4 mb-5 mx-7",children:t.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center ","aria-label":"Table navigation",children:[t.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",t.jsxs("span",{className:"text-gray-700",children:[g+1," to ",Math.min(v,S.length)]})," ","of ",t.jsxs("span",{className:"text-gray-900",children:[S.length," entries"]})]}),t.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[t.jsx("li",{children:t.jsx("button",{onClick:()=>n(1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),t.jsx("li",{children:t.jsx("button",{onClick:()=>n(l-1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:u},(e,s)=>s+1).slice(Math.max(0,l-2),Math.min(u,l+1)).map(e=>t.jsx("li",{children:t.jsx("button",{onClick:()=>n(e),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${l===e?"bg-primary text-white":"bg-white text-black"}`,children:e})},e)),t.jsx("li",{children:t.jsx("button",{onClick:()=>n(l+1),disabled:v>=q.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),t.jsx("li",{children:t.jsx("button",{onClick:()=>n(u),disabled:l===u,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})})};export{Te as default};
