import{r as s,u as F,b as y,A as b,d as w,j as e,F as q,t as G}from"./index-BcYsGqVu.js";import{R as c}from"./index-D7OJULEB.js";const Q=({permissions:n})=>{const _=n==null?void 0:n.includes("create");n==null||n.includes("edit"),n==null||n.includes("delete");const[f,H]=s.useState(""),[r,A]=s.useState(1),[d]=s.useState(10),[x,z]=s.useState(1),[J,I]=s.useState([]),[g,P]=s.useState([]),j=sessionStorage.getItem("token"),N=F(),[$,D]=s.useState([]);s.useState([]);const[m,R]=s.useState("All"),[v,T]=s.useState({}),[U,E]=s.useState([]);s.useEffect(()=>{const t=async()=>{try{const l=await y.get(`${b}/new-grievance/get`,{headers:{Authorization:`Bearer ${j}`}}),i=w(l.data.data);P(i);const p=i.filter(O=>Object.values(O).some(V=>V.toString().toLowerCase().includes(f.toLowerCase())));z(Math.ceil(p.length/d));const k=r*d,B=k-d;I(p.slice(B,k))}catch{}},a=async()=>{try{const l=await y.get(`${b}/complainttype/getactive`,{headers:{Authorization:`Bearer ${j}`}}),i=w(l.data.data);D(i)}catch(l){console.error("Error fetching existing Complainttype:",l)}};t(),a(),L()},[f,r,m]);const L=async()=>{try{const t=await y.get(`${b}/status/get`,{headers:{Authorization:`Bearer ${j}`}}),a=w(t.data.data),l=a.reduce((i,p)=>(i[p.status_name]=p.color,i),{});E(a),T(l)}catch(t){console.error("Error fetching existing ActiveStatus:",t)}},o=t=>{t>0&&t<=x&&A(t)},u=r*d,h=u-d,C=g.filter(t=>Object.values(t).some(a=>a.toString().toLowerCase().includes(f.toLowerCase()))),M=C.slice().reverse().filter(t=>m==="All"?!0:t.complaint_type_title===m).slice(h,u),S=t=>{R(t),o(1)};return e.jsx("div",{className:"overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"  font-lexend h-screen ",children:[e.jsxs("div",{className:"flex justify-between items-center my-4 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-lg text-sm ",children:"New Grievance"}),_&&e.jsxs("button",{className:"flex flex-row-2 gap-2 font-medium font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-2 px-3 justify-between md:text-base text-sm",onClick:()=>N("/form",{state:{grievanceId:g.grievance_id}}),children:[e.jsx(q,{})," Add Report"]})]}),e.jsxs("div",{className:"bg-white h-4/5 mx-3 rounded-lg mt-5  p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center md:gap-6 gap-2 md:mt-2 mx-3",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsx("p",{className:"text-lg  whitespace-nowrap",children:"View Report"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[$.map((t,a)=>e.jsx("div",{children:e.jsx("button",{className:`px-2 py-1.5 capitalize ${m===t.complaint_type?"bg-primary text-white":"bg-blue-100 text-primary"} rounded-full`,onClick:()=>S(t.complaint_type),children:t.complaint_type})},a)),e.jsx("button",{className:`w-20 py-1.5 ${m==="All"?"bg-primary text-white":"bg-blue-100 text-primary"} rounded-full`,onClick:()=>S("All"),children:"All"})]})]}),e.jsx("div",{className:" rounded-lg  py-3 overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full mt-2 ",children:[e.jsx("thead",{className:" border-b border-gray-300  ",children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend  font-medium whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 text-start font-lexend font-medium  whitespace-nowrap",children:"Complaint No"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Raised by ",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint Type ",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Department",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Assigned JE ",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Date and Time ",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Priority ",e.jsx(c,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Status ",e.jsx(c,{})]})})]})}),e.jsx("tbody",{children:M.map((t,a)=>e.jsxs("tr",{className:" border-b border-gray-300  ",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap text-gray-700",children:h+a+1<10?`0${h+a+1}`:h+a+1})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 border-slate-900 rounded-lg text-center py-1 my-1  text-slate-900 ",onClick:()=>N("/view",{state:{grievanceId:t.grievance_id}}),children:t.grievance_id})}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.public_user_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.complaint_type_title})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.dept_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.assign_username?t.assign_username:"Yet to be assigned"})]}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:G(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:`border-2 w-26 rounded-full text-center py-1.5 mx-2 text-sm font-medium capitalize  ${t.priority==="High"?"text-red-500 border-red-500":t.priority==="Medium"?"text-sky-500 border-sky-500":t.priority==="Low"?"text-green-500 border-green-500":""}`,children:t.priority})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 rounded-full text-center py-1 tex-sm font-normal mx-2 capitalize  ",style:{borderColor:v[t.status]||"gray",color:v[t.status]||"black",fontSize:14},children:t.status})})]},a))})]})})]}),e.jsx("div",{className:" mt-4 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center ","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[h+1," to ",Math.min(u,g.length)]})," ","of ",e.jsxs("span",{className:"text-gray-900",children:[g.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>o(1),disabled:r===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>o(r-1),disabled:r===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:x},(t,a)=>a+1).slice(Math.max(0,r-2),Math.min(x,r+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>o(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${r===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>o(r+1),disabled:u>=C.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>o(x),disabled:r===x,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})})};export{Q as default};
