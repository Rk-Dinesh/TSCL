import{r as a,u as q,b as f,A as j,d as y,j as e,s as G}from"./index-B-YhHBab.js";import{R as l,P as J}from"./Pagination-DoNtECT-.js";import{H as U}from"./HeaderButton-DsXCe15j.js";import"./index-D011Getu.js";const ee=({permissions:n})=>{const A=n==null?void 0:n.includes("create");n==null||n.includes("edit"),n==null||n.includes("delete");const[p,Y]=a.useState(""),[m,P]=a.useState(1),[i]=a.useState(10),[g,z]=a.useState(1),[F,k]=a.useState([]),[w,I]=a.useState([]),u=sessionStorage.getItem("token"),N=q(),[$,D]=a.useState([]);a.useState([]);const[o,E]=a.useState("All"),[b,L]=a.useState({}),[K,R]=a.useState([]);a.useEffect(()=>{const t=async()=>{try{const r=await f.get(`${j}/new-grievance/get`,{headers:{Authorization:`Bearer ${u}`}}),c=y(r.data.data);I(c);const x=c.filter(O=>Object.values(O).some(V=>V.toString().toLowerCase().includes(p.toLowerCase())));z(Math.ceil(x.length/i));const _=m*i,M=_-i;k(x.slice(M,_))}catch{}},s=async()=>{try{const r=await f.get(`${j}/complainttype/getactive`,{headers:{Authorization:`Bearer ${u}`}}),c=y(r.data.data);D(c)}catch(r){console.error("Error fetching existing Complainttype:",r)}};t(),s(),T()},[p,m,o]);const T=async()=>{try{const t=await f.get(`${j}/status/get`,{headers:{Authorization:`Bearer ${u}`}}),s=y(t.data.data),r=s.reduce((c,x)=>(c[x.status_name]=x.color,c),{});R(s),L(r)}catch(t){console.error("Error fetching existing ActiveStatus:",t)}},v=t=>{t>0&&t<=g&&P(t)},h=m*i,d=h-i,C=w.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(p.toLowerCase()))),B=C.slice().reverse().filter(t=>o==="All"?!0:t.complaint_type_title===o).slice(d,h),S=t=>{E(t),v(1)},H=()=>{N("/form")};return e.jsx("div",{className:"overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"  font-lexend h-screen ",children:[e.jsx(U,{title:"Grievances",hasCreatePermission:A,onClick:H}),e.jsxs("div",{className:"bg-white h-4/5 mx-3 rounded-lg mt-3  p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center md:gap-6 gap-2 md:mt-2 mx-3",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsx("p",{className:"text-lg  whitespace-nowrap",children:"View Report"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[$.map((t,s)=>e.jsx("div",{children:e.jsx("button",{className:`px-2 py-1.5 capitalize ${o===t.complaint_type?"bg-primary text-white":"bg-blue-100 text-primary"} rounded-full`,onClick:()=>S(t.complaint_type),children:t.complaint_type})},s)),e.jsx("button",{className:`w-20 py-1.5 ${o==="All"?"bg-primary text-white":"bg-blue-100 text-primary"} rounded-full`,onClick:()=>S("All"),children:"All"})]})]}),e.jsx("div",{className:" rounded-lg  py-3 overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full mt-2 ",children:[e.jsx("thead",{className:" border-b border-gray-300  ",children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-3 my-2 font-lexend  font-medium whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsx("p",{className:"mx-1.5 my-2 text-start font-lexend font-medium  whitespace-nowrap",children:"Complaint No"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Raised by ",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Complaint Type ",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Department",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Assigned JE ",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Date and Time ",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-2 my-2 font-lexend font-medium  whitespace-nowrap",children:["Priority ",e.jsx(l,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-center mx-1.5 my-2 font-lexend font-medium  whitespace-nowrap",children:["Status ",e.jsx(l,{})]})})]})}),e.jsx("tbody",{children:B.map((t,s)=>e.jsxs("tr",{className:" border-b border-gray-300  ",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap text-gray-700",children:d+s+1<10?`0${d+s+1}`:d+s+1})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 border-slate-900 rounded-lg text-center py-1 my-1  text-slate-900 ",onClick:()=>N("/view",{state:{grievanceId:t.grievance_id}}),children:t.grievance_id})}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.public_user_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.complaint_type_title})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:"capitalize text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:t.dept_name})]}),e.jsxs("td",{children:[" ",e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.assign_username?t.assign_username:"Yet to be assigned"})]}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm text-gray-700",children:G(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:`border-2 w-26 rounded-full text-center py-1.5 mx-2 text-sm font-medium capitalize  ${t.priority==="High"?"text-red-500 border-red-500":t.priority==="Medium"?"text-sky-500 border-sky-500":t.priority==="Low"?"text-green-500 border-green-500":""}`,children:t.priority})}),e.jsx("td",{children:e.jsx("p",{className:"border-2 w-28 rounded-full text-center py-1 tex-sm font-normal mx-2 capitalize  ",style:{borderColor:b[t.status]||"gray",color:b[t.status]||"black",fontSize:14},children:t.status})})]},s))})]})})]}),e.jsx("div",{className:" mt-4 mb-5 mx-7",children:e.jsx(J,{Length:w.length,currentPage:m,totalPages:g,firstIndex:d,lastIndex:h,paginate:v,hasNextPage:h>=C.length})})]})})};export{ee as default};
