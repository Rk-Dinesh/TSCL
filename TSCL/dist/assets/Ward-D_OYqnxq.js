import{c as q,a as D,r as s,u as R,o as T,j as e,b as _,A as S,B as Z,d as W,I as ce,F as U,k as ie,R as v,h as V,i as xe,D as me}from"./index-C-tKFev5.js";const he=q().shape({zone_name:D().test("not-select","Please select an Zone",a=>a!==""&&a!=="Select Zone"),ward_name:D().required("ward_name is required")}),ue=a=>{const{ExistingZones:h}=a,[b,j]=s.useState(null),[u,g]=s.useState(null),{register:d,formState:{errors:i},handleSubmit:y,watch:x}=R({resolver:T(he),mode:"all"});s.useEffect(()=>{if(u){const l=h.find(m=>m.zone_name===u);l&&j(l.zone_id)}},[u,h]);const N=async l=>{const m={...l,zone_id:b,status:"active",created_by_user:"admin"};try{const f=sessionStorage.getItem("token"),n=await _.post(`${S}/ward/post`,m,{headers:{Authorization:`Bearer ${f}`}});n.status===200?(Z.success("Ward created Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",n),Z.error("Failed to Upload"))}catch(f){console.error("Error in posting data",f)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-10 pb-2",children:"Add Ward"})}),e.jsxs("form",{onSubmit:y(N),children:[e.jsxs("div",{className:"mx-6 my-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"zone_name",children:"Zone Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"zone_name",...d("zone_name"),onChange:l=>g(l.target.value),children:[e.jsx("option",{value:"",children:"Select Zone"}),h.map(l=>e.jsx("option",{value:l.zone_name,children:l.zone_name},l.zone_id))]}),i.zone_name&&e.jsx("p",{className:"text-red-500",children:i.zone_name.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3",htmlFor:"ward_name",children:"Ward Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"ward_name",type:"text",placeholder:" Ward Name",...d("ward_name")}),i.ward_name&&e.jsx("p",{className:"text-red-500",children:i.ward_name.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleCloseModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},ge=q().shape({zone_name:D().test("not-select","Please select an Zone",a=>a!==""&&a!=="Select Zone"),ward_name:D().required("ward_name is required"),status:D().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),pe=a=>{const h=sessionStorage.getItem("token"),{ExistingZones:b,wardId:j}=a,[u,g]=s.useState(null),[d,i]=s.useState(null),{register:y,formState:{errors:x},handleSubmit:N,watch:l,setValue:m}=R({resolver:T(ge),mode:"all"});s.useEffect(()=>{(async()=>{try{const p=await _.get(`${S}/ward/getbyid?ward_id=${j}`,{headers:{Authorization:`Bearer ${h}`}}),o=W(p.data.data);i(o.zone_name),m("ward_name",o.ward_name),m("status",o.status),m("zone_name",o.zone_name)}catch(p){console.error("Error fetching data",p)}})()},[j,m]),s.useEffect(()=>{if(d){const n=b.find(p=>p.zone_name===d);n&&g(n.zone_id)}},[d,b]);const f=async n=>{const p={...n,zone_id:u};try{const o=await _.post(`${S}/ward/update?ward_id=${j}`,p,{headers:{Authorization:`Bearer ${h}`}});o.status===200?(Z.success("Ward Updated Successfully"),g(null),g(null),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",o),Z.error("Failed to Upload"))}catch(o){console.error("Error in posting data",o)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white w-[522px] h-[368px]  font-lexend m-2",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-10",children:e.jsx("h1",{className:"text-xl font-medium pt-6 pb-2",children:"Edit Ward"})}),e.jsxs("form",{onSubmit:N(f),children:[e.jsxs("div",{className:"mx-6 my-2",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"zone_name",children:"Zone Name"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"zone_name",...y("zone_name"),onChange:n=>i(n.target.value),children:[e.jsx("option",{value:d,disabled:!0,children:d}),b.map(n=>e.jsx("option",{value:n.zone_name,children:n.zone_name},n.zone_id))]}),x.zone_name&&e.jsx("p",{className:"text-red-500",children:x.zone_name.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-2",htmlFor:"ward_name",children:"Ward Name"}),e.jsx("input",{className:"appearance-none border rounded-lg w-full py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"ward_name",type:"text",placeholder:" Ward Name",...y("ward_name")}),x.ward_name&&e.jsx("p",{className:"text-red-500",children:x.ward_name.message})]}),e.jsxs("div",{className:" grid grid-cols-3 mx-3 my-3 ",children:[e.jsx("label",{className:" text-gray-900 text-base font-normal  col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"   text-sm text-black border border-gray-900 rounded-lg  border-none outline-none",id:"status",...y("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),x.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:x.status.message})]})]}),e.jsxs("div",{className:"flex justify-end mx-10 gap-5 ",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:a.toggleModal,children:"cancel"}),e.jsx("button",{className:" text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Save"})]})]})]})})},je=({permissions:a})=>{const h=a==null?void 0:a.includes("create"),b=a==null?void 0:a.includes("edit"),j=a==null?void 0:a.includes("delete"),[u,g]=s.useState(!1),[d,i]=s.useState(!1),[y,x]=s.useState(null),[N,l]=s.useState(!1),[m,f]=s.useState(null),[n,p]=s.useState(null),[o,G]=s.useState(""),[c,H]=s.useState(1),[w]=s.useState(8),[z,J]=s.useState(1),[fe,K]=s.useState([]),[A,Q]=s.useState([]),[P,X]=s.useState(null),I=sessionStorage.getItem("token"),$=t=>{X(P===t?null:t)},Y=t=>P===t;s.useEffect(()=>{E(),se()},[o,c,w,I]);const k=t=>{t>0&&t<=z&&H(t)},E=async()=>{try{const t=await _.get(`${S}/ward/get`,{headers:{Authorization:`Bearer ${I}`}}),r=W(t.data.data);Q(r);const L=r.filter(oe=>Object.values(oe).some(de=>de.toString().toLowerCase().includes(o.toLowerCase())));J(Math.ceil(L.length/w));const O=c*w,le=O-w;K(L.slice(le,O))}catch(t){console.error(t)}},ee=()=>{g(!u)},te=()=>{i(!d),x(null)},ae=()=>{g(!u)},F=()=>{l(!N),f(null)},se=async()=>{try{const t=await _.get(`${S}/zone/getactive`,{headers:{Authorization:`Bearer ${I}`}}),r=W(t.data.data);p(r)}catch(t){console.error("Error fetching existing roles:",t)}},M=c*w,C=M-w,B=A.filter(t=>Object.values(t).some(r=>r.toString().toLowerCase().includes(o.toLowerCase()))),ne=B.slice(C,M),re=async()=>{try{await _.delete(`${S}/ward/delete?ward_id=${m}`,{headers:{Authorization:`Bearer ${I}`}}),F(),E(),toast.success("Deleted successfully")}catch{toast.error("Failed to delete")}};return e.jsxs(s.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-full",children:[e.jsx(ce,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Ward",value:o,onChange:t=>G(t.target.value)})]}),h&&e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 border-blue-500 font-lexend bg-slate-100 text-blue-500 rounded-full px-3 py-1.5 justify-center",children:[" ",e.jsx(U,{}),"Bulk Upload"]})}),e.jsx("a",{href:"#",children:e.jsxs("button",{className:"flex gap-2 items-center border-2 bg-slate-100  font-lexend text-black rounded-full px-3 py-1.5 w-28 justify-between",children:[" ","CSV ",e.jsx(ie,{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:"Ward"}),h&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full py-2 px-3 justify-between md:text-base text-sm",onClick:()=>g(!0),children:[e.jsx(U,{})," Add Ward"]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3  h-3/5 ",children:e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full mt-3 ",children:[e.jsx("thead",{className:" border-b-2 border-gray-300",children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Ward ",e.jsx(v,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Zone ",e.jsx(v,{})]})}),e.jsx("th",{className:"",children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5 my-2 font-lexend font-semibold",children:["Status ",e.jsx(v,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedBy ",e.jsx(v,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["CreatedAt",e.jsx(v,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold",children:["UpdatedAt",e.jsx(v,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"text-center mx-1.5 my-3 font-semibold font-lexend",children:"Action"})})]})}),e.jsx("tbody",{children:ne.map((t,r)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{className:"",children:e.jsx("div",{className:"items-center mx-6 my-2 font-lexend whitespace-nowrap text-sm text-center text-gray-700",children:C+r+1<10?`0${C+r+1}`:C+r+1})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"text-start mx-1.5 my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.ward_name})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"text-start mx-1.5 my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.zone_name})}),e.jsx("td",{className:"",children:e.jsx("p",{className:"text-start mx-1.5 my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsx("p",{className:"text-start mx-1.5  my-2  font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:V(t.createdAt)})}),e.jsx("td",{children:e.jsx("p",{className:" text-start mx-1.5  my-2 font-lexend whitespace-nowrap text-sm capitalize text-gray-700",children:V(t.updatedAt)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(xe,{onClick:()=>$(r)}),Y(r)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[b&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{i(!0),x(t.ward_id),$()},children:"Edit"}),j&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{l(!0),f(t.ward_id),$()},children:"Delete"})]})]})})]},r))})]})})}),e.jsx("div",{className:" my-3 mb-5 mx-7",children:e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[C+1," to ",Math.min(M,A.length)]})," ","of ",e.jsxs("span",{className:"text-gray-900",children:[A.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>k(1),disabled:c===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>k(c-1),disabled:c===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:z},(t,r)=>r+1).slice(Math.max(0,c-2),Math.min(z,c+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>k(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${c===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>k(c+1),disabled:M>=B.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>k(z),disabled:c===z,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})})]})}),u&&e.jsx(ue,{toggleModal:ee,toggleCloseModal:ae,ExistingZones:n,handlerefresh:E}),d&&e.jsx(pe,{toggleModal:te,handlerefresh:E,ExistingZones:n,wardId:y}),N&&e.jsx(me,{toggleDeleteModal:F,delete:re})]})};export{je as default};
