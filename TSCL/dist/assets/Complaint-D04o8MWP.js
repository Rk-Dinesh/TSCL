import{c as G,a as d,r as i,u as ie,o as ce,j as e,n as de,b as D,A as S,B as C,d as Y,I as Pe,F as re,e as Le}from"./index-B-0fny-6.js";import{R as N}from"./index-BhEqOQck.js";import{D as Te}from"./DeleteModal-B8xG_S-n.js";import{P as Me,a as $e}from"./index-DcwmNplq.js";import{H as Re,E as Ie}from"./jspdf.plugin.autotable-CHAoQbKv.js";const H=[{id:1,title:"Complaint Details"},{id:2,title:"Escalation Details"}],ne=G().shape({complaint_type_title:d().required("complaint_type is required"),dept_name:d().test("not-select","select an Department",a=>a!==""&&a!=="Select an Department"),tat_type:d().test("not-select","select an TAT Type",a=>a!==""&&a!=="Select Type"),tat_duration:d().required("Duration is required"),priority:d().required("Priority is required")}),ze=G().shape({escalation_type:d().test("not-select","select an Type",a=>a!==""&&a!=="Select Type"),escalation_l1:d().required("L1 duration is required"),role_l1:d().test("not-select","select an L1 role",a=>a!==""&&a!=="Select an Role"),escalation_l2:d().optional(),role_l2:d().optional(),escalation_l3:d().optional(),role_l3:d().optional()}),Ae=a=>{const[c,E]=i.useState(0),{ExistingDept:$,ExistingRoles:F}=a;let _;switch(c){case 0:_=ne;break;case 1:_=ze;break;default:_=ne}i.useEffect(()=>{},[c]);const{register:h,formState:{errors:r},handleSubmit:R}=ie({resolver:ce(_),mode:"all"}),P=async x=>{if(c!==H.length-1)E(c+1);else{const j={...x,status:"active",created_by_user:"admin"};try{const w=sessionStorage.getItem("token"),k=await D.post(`${S}/complaint/post`,j,{headers:{Authorization:`Bearer ${w}`}});k.status===200?(C.success("Complaint created Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",k),C.error("Failed to Upload"))}catch(w){console.error("Error in posting data",w)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center flex-wrap",children:e.jsx("div",{className:"overflow-hidden shadow-lg bg-white flex items-end justify-between relative font-alegerya mx-2 ",children:e.jsx("div",{className:"min-w-[390px] min-h-[350px] ",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center px-5 text-white bg-primary h-12 flex-wrap",children:[e.jsx("p",{className:"",children:"New Complaint"}),e.jsx("button",{onClick:a.toggleModal,className:"",children:e.jsx(de,{className:"text-2xl"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-9 relative justify-center mx-60 py-1 rounded-full bg-slate-200 mt-4",children:H.map((x,j)=>e.jsxs("div",{className:"relative items-center item flex last:flex-none group",children:[e.jsx("div",{className:`${c>=j?"bg-black text-white":"bg-white text-slate-900"} transition duration-150 icon-box h-8 w-8 rounded-full flex flex-col items-center justify-center relative z-[66] text-base font-medium`,children:e.jsx("span",{children:j+1})}),j!==H.length-1&&e.jsx("div",{className:`${c>j?"bg-green-900":"bg-[#E0EAFF]"} absolute top-1/2 h-[2px] w-full z-[65]`})]},j))}),e.jsx("div",{className:"conten-box mx-8 my-4",children:e.jsxs("form",{onSubmit:R(P),children:[c===0&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Create Complaint"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"complaint_type_title",children:"Complaint"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline  col-span-2",id:"complaint_type_title",type:"text",placeholder:"Complaint",...h("complaint_type_title")}),r.complaint_type_title&&e.jsx("p",{className:"text-red-500 text-sm text-start -mt-3",children:r.complaint_type_title.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"dept_name",children:"Department"}),e.jsxs("select",{className:"col-span-2  block outline-none px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("dept_name"),id:"dept_name",children:[e.jsx("option",{value:"",children:"Select an Department"}),$.map(x=>e.jsx("option",{value:x.dept_name,children:x.dept_name},x.dept_id))]}),r.dept_name&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.dept_name.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_type",children:"TAT Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("tat_type"),id:"tat_type",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),r.tat_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.tat_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_duration",children:"Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"tat_duration",type:"text",placeholder:"Duration",...h("tat_duration")}),r.tat_duration&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.tat_duration.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"priority",children:"Priority"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("priority"),id:"priority",children:[e.jsx("option",{value:"",children:"Select Priority"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),r.priority&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.priority.message})]})]})}),c===1&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Escalation Details"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_type",children:"Escalation Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("escalation_type"),id:"escalation_type",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),r.escalation_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.escalation_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l1",children:"L1 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l1",type:"text",placeholder:"L1 Duration",...h("escalation_l1")}),r.escalation_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.escalation_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l1",children:"L1 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l1"),id:"role_l1",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(x=>e.jsx("option",{value:x.role_name,children:x.role_name},x.role_id))]}),r.role_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.role_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l2",children:"L2 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l2",type:"text",placeholder:"L2 Duration",...h("escalation_l2")}),r.escalation_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.escalation_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l2",children:"L2 Role"}),e.jsxs("select",{className:"col-span-2  outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l2"),id:"role_l2",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(x=>e.jsx("option",{value:x.role_name,children:x.role_name},x.role_id))]}),r.role_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.role_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l3",children:"L3 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l3",type:"text",placeholder:"L3 Duration",...h("escalation_l3")}),r.escalation_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.escalation_l3.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l3",children:"L3 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50 dark:bg-white dark:border-gray-200 dark:placeholder-gray-400 dark:text-black hover:border-gray-200",...h("role_l3"),id:"role_l3",children:[e.jsx("option",{value:"",children:"Select an Role"}),F.map(x=>e.jsx("option",{value:x.role_name,children:x.role_name},x.role_id))]}),r.role_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:r.role_l3.message})]})]})}),e.jsxs("div",{className:"footer flex justify-between items-center py-4 px-12",children:[e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-4 py-1.5 rounded-full",type:"button",onClick:()=>E(c-1),disabled:c===0,children:"Previous"})}),e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-6 py-1.5 rounded-full",type:"submit",children:c===H.length-1?"Save":"Next"})})]})]})})]})]})})})})},V=[{id:1,title:"Complaint Details"},{id:2,title:"Escalation Details"}],oe=G().shape({complaint_type_title:d().required("complaint_type is required"),dept_name:d().test("not-select","select an Department",a=>a!==""&&a!=="Select an Department"),tat_type:d().test("not-select","select an TAT Type",a=>a!==""&&a!=="Select Type"),tat_duration:d().required("Duration is required"),priority:d().required("Priority is required")}),Be=G().shape({escalation_type:d().test("not-select","select an Type",a=>a!==""&&a!=="Select Type"),escalation_l1:d().required("L1 duration is required"),role_l1:d().test("not-select","select an L1 role",a=>a!==""&&a!=="Select an Role"),escalation_l2:d().optional(),role_l2:d().optional(),escalation_l3:d().optional(),role_l3:d().optional(),status:d().test("not-select","Please select an Status",a=>a!==""&&a!=="Status")}),Ue=a=>{const[c,E]=i.useState(0),[$,F]=i.useState(null),[_,h]=i.useState(null),[r,R]=i.useState(null),[P,x]=i.useState(null),j=sessionStorage.getItem("token"),{ExistingDept:w,ExistingRoles:k,comptId:I}=a;let L;switch(c){case 0:L=oe;break;case 1:L=Be;break;default:L=oe}i.useEffect(()=>{},[c]);const{register:g,formState:{errors:n},handleSubmit:J,setValue:p}=ie({resolver:ce(L),mode:"all"});i.useEffect(()=>{(async()=>{try{const b=await D.get(`${S}/complaint/getbyid?complaint_id=${I}`,{headers:{Authorization:`Bearer ${j}`}}),o=Y(b.data.data);p("complaint_type_title",o.complaint_type_title),p("dept_name",o.dept_name),F(o.dept_name),p("tat_type",o.tat_type),p("tat_duration",o.tat_duration),p("priority",o.priority),p("escalation_type",o.escalation_type),p("escalation_l1",o.escalation_l1),p("role_l1",o.role_l1),h(o.role_l1),p("escalation_l2",o.escalation_l2),p("role_l2",o.role_l2),R(o.role_l2),p("escalation_l3",o.escalation_l3),p("role_l3",o.role_l3),x(o.role_l3),p("status",o.status)}catch(b){console.error("Error fetching data",b)}})()},[I,p]);const K=async l=>{if(c!==V.length-1)E(c+1);else{const b={...l};try{const o=await D.post(`${S}/complaint/update?complaint_id=${I}`,b,{headers:{Authorization:`Bearer ${j}`}});o.status===200?(C.success("Complaint Updated Successfully"),a.toggleModal(),a.handlerefresh()):(console.error("Error in posting data",o),C.error("Failed to Upload"))}catch(o){console.error("Error in posting data",o)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center flex-wrap",children:e.jsx("div",{className:"overflow-hidden shadow-lg bg-white flex items-end justify-between relative font-alegerya mx-2 ",children:e.jsx("div",{className:"min-w-[390px] min-h-[350px] ",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center px-5 text-white bg-primary h-12 flex-wrap",children:[e.jsx("p",{className:"",children:"New Complaint"}),e.jsx("button",{onClick:a.toggleModal,className:"",children:e.jsx(de,{className:"text-2xl"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-9 relative justify-center mx-60 py-1 rounded-full bg-slate-200 mt-4",children:V.map((l,b)=>e.jsxs("div",{className:"relative items-center item flex last:flex-none group",children:[e.jsx("div",{className:`${c>=b?"bg-black text-white":"bg-white text-slate-900"} transition duration-150 icon-box h-8 w-8 rounded-full flex flex-col items-center justify-center relative z-[66] text-base font-medium`,children:e.jsx("span",{children:b+1})}),b!==V.length-1&&e.jsx("div",{className:`${c>b?"bg-green-900":"bg-[#E0EAFF]"} absolute top-1/2 h-[2px] w-full z-[65]`})]},b))}),e.jsx("div",{className:"conten-box mx-8 my-4",children:e.jsxs("form",{onSubmit:J(K),children:[c===0&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Create Complaint"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"complaint_type_title",children:"Complaint"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline  col-span-2",id:"complaint_type_title",type:"text",placeholder:"Complaint",...g("complaint_type_title")}),n.complaint_type_title&&e.jsx("p",{className:"text-red-500 text-sm text-start -mt-3",children:n.complaint_type_title.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"dept_name",children:"Department"}),e.jsxs("select",{className:"col-span-2  block outline-none px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("dept_name"),id:"dept_name",children:[e.jsx("option",{value:$,children:$}),w.map(l=>e.jsx("option",{value:l.dept_name,children:l.dept_name},l.dept_id))]}),n.dept_name&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.dept_name.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_type",children:"TAT Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("tat_type"),id:"tat_type",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),n.tat_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.tat_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"tat_duration",children:"Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"tat_duration",type:"text",placeholder:"Duration",...g("tat_duration")}),n.tat_duration&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.tat_duration.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"priority",children:"Priority"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("priority"),id:"priority",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Priority"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),n.priority&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.priority.message})]})]})}),c===1&&e.jsx("div",{children:e.jsxs("div",{className:"pt-2 font-alegerya flex flex-col gap-3 my-4",children:[e.jsx("div",{className:"",children:e.jsx("h4",{className:"text-xl font-medium text-slate-800 ml-2",children:"Escalation Details"})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_type",children:"Escalation Type"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("escalation_type"),id:"escalation_type",children:[e.jsx("option",{value:"",hidden:!0,children:"Select Type"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"day",children:"Days"})]}),n.escalation_type&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.escalation_type.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l1",children:"L1 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l1",type:"text",placeholder:"L1 Duration",...g("escalation_l1")}),n.escalation_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.escalation_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l1",children:"L1 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("role_l1"),id:"role_l1",children:[e.jsx("option",{value:_,disabled:!0,children:_}),k.map(l=>e.jsx("option",{value:l.role_name,children:l.role_name},l.role_id))]}),n.role_l1&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.role_l1.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l2",children:"L2 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l2",type:"text",placeholder:"L2 Duration",...g("escalation_l2")}),n.escalation_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.escalation_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l2",children:"L2 Role"}),e.jsxs("select",{className:"col-span-2  outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("role_l2"),id:"role_l2",children:[e.jsx("option",{value:r,disabled:!0,children:r}),k.map(l=>e.jsx("option",{value:l.role_name,children:l.role_name},l.role_id))]}),n.role_l2&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.role_l2.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"escalation_l3",children:"L3 Duration"}),e.jsx("input",{className:"appearance-none border rounded-lg py-2 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline col-span-2",id:"escalation_l3",type:"text",placeholder:"L3 Duration",...g("escalation_l3")}),n.escalation_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.escalation_l3.message})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"role_l3",children:"L3 Role"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",...g("role_l3"),id:"role_l3",children:[e.jsx("option",{value:P,disabled:!0,children:P}),k.map(l=>e.jsx("option",{value:l.role_name,children:l.role_name},l.role_id))]}),n.role_l3&&e.jsx("p",{className:"text-red-500 text-sm text-center -mt-3",children:n.role_l3.message})]}),e.jsxs("div",{className:" grid grid-cols-3 items-center gap-3",children:[e.jsx("label",{className:"block text-gray-500 text-base text-start font-normal mb-2 mx-8 col-span-1",htmlFor:"status",children:"Status:"}),e.jsxs("select",{className:"col-span-2 outline-none block px-1 py-3 text-sm text-black border border-gray-200 rounded-lg bg-gray-50     hover:border-gray-200",id:"status",...g("status"),children:[e.jsx("option",{value:"",hidden:!0,children:"Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]}),n.status&&e.jsx("p",{className:"text-red-500 text-xs text-center mb-3 ",children:n.status.message})]})]})}),e.jsxs("div",{className:"footer flex justify-between items-center py-4 px-12",children:[e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-4 py-1.5 rounded-full",type:"button",onClick:()=>E(c-1),disabled:c===0,children:"Previous"})}),e.jsx("div",{className:"flex gap-4 items-center justify-center",children:e.jsx("button",{className:"bg-primary text-white px-6 py-1.5 rounded-full",type:"submit",children:c===V.length-1?"Save":"Next"})})]})]})})]})]})})})})},qe=`complaint_type_title,dept_name,tat_type,tat_duration,priority,escalation_type,escalation_l1,role_l1,escalation_l2,role_l2,escalation_l3,role_l3,status,created_by_user
Title,Department,duration,Type,Priority,Type,duration1,role1,duration2,role2,duration3,role3,status,admin
`,Qe=({permissions:a})=>{const c=a==null?void 0:a.includes("create"),E=a==null?void 0:a.includes("edit"),$=a==null?void 0:a.includes("delete"),F=a==null?void 0:a.includes("download"),[_,h]=i.useState(!1),[r,R]=i.useState(!1),[P,x]=i.useState(!1),[j,w]=i.useState(null),[k,I]=i.useState(null),[L,g]=i.useState(null),[n,J]=i.useState(null),[p,K]=i.useState(""),[l,b]=i.useState(1),[o]=i.useState(8),[z,xe]=i.useState(1),[Oe,me]=i.useState([]),[T,pe]=i.useState([]),[X,he]=i.useState(null),q=sessionStorage.getItem("token"),[ge,Z]=i.useState(null),[ee,te]=i.useState("Bulk Upload"),[Q,ue]=i.useState(null),W=t=>{he(X===t?null:t)},ye=t=>X===t;i.useEffect(()=>{B(),je(),be()},[p,l]);const A=t=>{t>0&&t<=z&&b(t)},B=()=>{D.get(`${S}/complaint/get`,{headers:{Authorization:`Bearer ${q}`}}).then(t=>{const s=Y(t.data.data);pe(s);const f=s.filter(y=>Object.values(y).some(m=>m.toString().toLowerCase().includes(p.toLowerCase())));xe(Math.ceil(f.length/o));const v=l*o,M=v-o;me(f.slice(M,v))}).catch(t=>{console.error(t)})},be=async()=>{try{const t=await D.get(`${S}/role/getactive`,{headers:{Authorization:`Bearer ${q}`}}),s=Y(t.data.data);g(s)}catch(t){console.error("Error fetching existing Roles:",t)}},je=async()=>{try{const t=await D.get(`${S}/department/getactive`,{headers:{Authorization:`Bearer ${q}`}}),s=Y(t.data.data);J(s)}catch(t){console.error("Error fetching existing Department:",t)}},fe=()=>{h(!_)},_e=()=>{R(!r),I(null)},ae=()=>{x(!P),w(null)},O=l*o,U=O-o,le=T.filter(t=>Object.values(t).some(s=>s.toString().toLowerCase().includes(p.toLowerCase()))),Ne=le.slice().reverse().slice(U,O),ve=async()=>{try{await D.delete(`${S}/complaint/delete?complaint_id=${j}`,{headers:{Authorization:`Bearer ${q}`}}),ae(),B(),C.success("Deleted successfully")}catch{C.error("Failed to delete")}},we=t=>{Z(t.target.files[0]),te("Upload")},ke=()=>{ee==="Bulk Upload"?document.getElementById("fileInput").click():De(ge)},De=async t=>{try{const s=new FormData;s.append("file",t),(await D.post(`${S}/complaint/uploadcsv`,s,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(te("Bulk Upload"),Z(null),B(),C.success("Data Uploaded Successfully")):C.error("Data failed to Upload")}catch(s){console.log(s)}},Se=t=>{ue(t.target.value)},se=async t=>{if(t==="csv"){const s=T.map(m=>({complaint_id:m.complaint_id,complaint_type_title:m.complaint_type_title,dept_name:m.dept_name,tat_type:m.tat_type,tat_duration:m.tat_duration,priority:m.priority,escalation_type:m.escalation_type,escalation_l1:m.escalation_l1,role_l1:m.role_l1,escalation_l2:m.escalation_l2,role_l2:m.role_l2,escalation_l3:m.escalation_l3,role_l3:m.role_l3,status:m.status,created_by_user:m.created_by_user})),f=[Object.keys(s[0]).join(","),...s.map(m=>Object.values(m).join(","))].join(`
`),v=new Blob([f],{type:"text/csv;charset=utf-8;"}),M=window.URL.createObjectURL(v),y=document.createElement("a");y.setAttribute("href",M),y.setAttribute("download","Complaint_data.csv"),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)}else if(t==="pdf")try{const f=Math.ceil(T.length/30),v=new Ie("l","mm","a4");let M=0;for(let y=1;y<=f;y++){const m=(y-1)*30,Ee=Math.min(m+30,T.length),Fe=T.slice(m,Ee).map(u=>[u.complaint_id,u.complaint_type_title,u.dept_name,u.tat_type,u.tat_duration,u.priority,u.escalation_type,u.escalation_l1,u.role_l1,u.escalation_l2,u.role_l2,u.escalation_l3,u.role_l3,u.status,u.created_by_user]);v.text(`Page ${y}`,10,M+10),v.autoTable({startY:M+15,head:[["complaint_id","complaint_type_title","dept_name","tat_type","tat_duration","priority","escalation_type","escalation_l1","role_l1","escalation_l2","role_l2","escalation_l3","role_l3","Status","createdBy"]],body:Fe,theme:"striped"}),y<f&&(v.addPage(),M=10)}v.save("Complaint_data.pdf")}catch(s){console.error("Error exporting data:",s)}},Ce=()=>{const t=new Blob([qe],{type:"text/csv"}),s=URL.createObjectURL(t),f=document.createElement("a");f.href=s,f.download="bulkupload_template.csv",f.click(),URL.revokeObjectURL(s)};return e.jsxs(i.Fragment,{children:[e.jsx("div",{className:"  bg-blue-100 overflow-y-auto no-scrollbar",children:e.jsxs("div",{className:"h-screen",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-end gap-3 p-2 mt-3 mx-8 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-full",children:[e.jsx(Pe,{className:"text-xl"}),e.jsx("input",{type:"search",className:"outline-none bg-transparent text-base",placeholder:"Search Complaint",value:p,onChange:t=>K(t.target.value)})]}),c&&e.jsxs("div",{className:"relative text-center   hover:text-white py-1.5 rounded-full",children:[e.jsx("input",{type:"file",id:"fileInput",className:"hidden",onChange:we,accept:".csv"}),e.jsxs("button",{className:"flex items-center gap-2 justify-center border-primary border-2 font-normal text-base w-36 py-1.5  rounded-full text-primary hover:text-white hover:bg-primary  ",onClick:ke,children:[e.jsx(re,{}),ee]})]}),F&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("form",{children:e.jsxs("select",{className:"block w-full py-2 px-2  text-sm border-2 text-gray-400  border-gray-300 rounded-full bg-gray-50 outline-none",onChange:Se,children:[e.jsx("option",{hidden:!0,children:"Download"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"pdf",children:"PDF"})]})}),Q===null&&e.jsx(Re,{className:"text-2xl text-gray-500"}),Q==="csv"&&e.jsx(Me,{className:"text-3xl text-gray-500",onClick:()=>se("csv")}),Q==="pdf"&&e.jsx($e,{className:"text-3xl text-gray-500",onClick:()=>se("pdf")})]})]}),e.jsxs("div",{className:"flex justify-between items-center my-2 mx-8 gap-1 flex-wrap",children:[e.jsx("h1",{className:"md:text-xl text-lg font-medium ",children:"Complaint "}),c&&e.jsxs("button",{className:"flex flex-row-2 gap-2  font-lexend items-center border-2 bg-blue-500 text-white rounded-full p-2.5 w-fit justify-between md:text-base text-sm",onClick:()=>h(!0),children:[e.jsx(re,{})," Add Complaint"]})]}),e.jsx("div",{className:"bg-white mx-4 rounded-lg my-3 overflow-x-auto h-3/5 no-scrollbar",children:e.jsxs("table",{className:"w-full  ",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-300 py-1",children:[e.jsx("th",{className:"py-2",children:e.jsx("p",{className:" mx-6 my-2 font-lexend font-semibold whitespace-nowrap",children:"#"})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Complaint ",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Department",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["TAT Type",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Duration",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Priority",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-1",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-2",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Escalation-3",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["Status",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsxs("p",{className:"flex gap-2 items-center justify-start mx-1.5  my-2 font-lexend font-semibold whitespace-nowrap",children:["CreatedBy",e.jsx(N,{})]})}),e.jsx("th",{children:e.jsx("p",{className:"mx-3 my-3 text-center font-lexend font-semibold whitespace-nowrap",children:"Action"})})]})}),e.jsx("tbody",{children:Ne.map((t,s)=>e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("td",{children:e.jsxs("p",{className:"text-center text-sm mx-3 my-2 font-lexend whitespace-nowrap text-gray-700",children:[" ",U+s+1<10?`0${U+s+1}`:U+s+1]})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.complaint_type_title})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2  font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.dept_name})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2  font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.tat_type})}),e.jsx("td",{children:e.jsx("p",{className:" mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.tat_duration})}),e.jsx("td",{children:e.jsx("p",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.priority})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start text-sm font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap  bg-gray-100 px-2 py-1 rounded-full capitalize text-gray-700",children:t.escalation_l1}),e.jsx("p",{className:"  whitespace-nowrap text-start text-sm capitalize  text-gray-700",children:t.role_l1})]})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start  font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap bg-gray-100 px-2 py-1 rounded-full text-start text-sm capitalize text-gray-700",children:t&&t.escalation_l2?t.escalation_l2:"---"}),e.jsx("p",{className:" whitespace-nowrap text-sm capitalize text-gray-700",children:t&&t.role_l2?t.role_l2:"---"})]})}),e.jsx("td",{children:e.jsxs("div",{className:"mx-1.5 my-3 flex gap-3 items-center justify-start  font-lexend",children:[e.jsx("p",{className:" whitespace-nowrap bg-gray-100 px-2 py-1 rounded-full text-start text-sm capitalize text-gray-700",children:t&&t.escalation_l3?t.escalation_l3:"---"}),e.jsx("p",{className:" whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t&&t.role_l3?t.role_l3:"---"})]})}),e.jsx("td",{children:e.jsx("div",{className:"mx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.status})}),e.jsx("td",{children:e.jsx("p",{className:"fmx-1.5  my-2 font-lexend whitespace-nowrap text-start text-sm capitalize text-gray-700",children:t.created_by_user})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-start mx-1.5 my-3",children:[e.jsx(Le,{onClick:()=>W(s)}),ye(s)&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg ml-1",children:[E&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{R(!0),I(t.complaint_id),W()},children:"Edit"}),$&&e.jsx("button",{className:"block px-3 py-1.5 text-sm text-black hover:bg-gray-200 w-full text-left",onClick:()=>{x(!0),w(t.complaint_id),W()},children:"Delete"})]})]})})]},s))})]})}),e.jsxs("div",{className:" my-3 mb-5 mx-7",children:[e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"bg-primary px-3 py-2 rounded-full text-white text-sm font-alegerya",onClick:Ce,children:"Bulk Upload Template"})}),e.jsxs("nav",{className:"flex items-center flex-column flex-wrap md:flex-row md:justify-between justify-center pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-700 mb-4 md:mb-0 block w-full md:inline md:w-auto text-center font-alegerya",children:["Showing"," ",e.jsxs("span",{className:"text-gray-700",children:[U+1," to ",Math.min(O,T.length)]})," ","of"," ",e.jsxs("span",{className:"text-gray-900",children:[T.length," entries"]})]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8 font-alegerya",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>A(1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-s-lg hover:bg-paginate-bg hover:text-primary-hover",children:"<<"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(l-1),disabled:l===1,className:"flex items-center justify-center px-3 h-8 ms-0 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Back"})}),Array.from({length:z},(t,s)=>s+1).slice(Math.max(0,l-2),Math.min(z,l+1)).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>A(t),className:`flex items-center justify-center px-3 h-8 leading-tight border border-paginate-br hover:text-white hover:bg-primary ${l===t?"bg-primary text-white":"bg-white text-black"}`,children:t})},t)),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(l+1),disabled:O>=le.length,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br hover:bg-paginate-bg hover:text-primary-hover",children:"Next"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>A(z),disabled:l===z,className:"flex items-center justify-center px-3 h-8 leading-tight text-primary bg-paginate-bg border border-paginate-br rounded-e-lg hover:bg-paginate-bg hover:text-primary-hover",children:">>"})})]})]})]})]})}),_&&e.jsx(Ae,{toggleModal:fe,handlerefresh:B,ExistingDept:n,ExistingRoles:L}),r&&e.jsx(Ue,{toggleModal:_e,handlerefresh:B,ExistingDept:n,ExistingRoles:L,comptId:k}),P&&e.jsx(Te,{toggleDeleteModal:ae,delete:ve})]})};export{Qe as default};
