import{i as E,k as h,r as l,m as $,o as C,b as i,A as m,d as g,j as e,B as f}from"./index-Cb3AN3R3.js";const F=E().shape({dept_name:h().test("not-select","Please select an Department",s=>s!==""&&s!=="Select  Department"),complaint:h().test("not-select","Please select an complaint",s=>s!==""&&s!=="Select  complaint")}),I=s=>{const{selectedRows:u,toggleTModal:d,handlerefresh:b}=s,p=localStorage.getItem("token"),[y,j]=l.useState([]),[c,N]=l.useState([]),[S,k]=l.useState([]),{register:x,formState:{errors:r},handleSubmit:v,watch:A}=$({resolver:C(F),mode:"all"});l.useEffect(()=>{w(),D()},[]);const w=async()=>{try{const t=await i.get(`${m}/department/getactive`,{headers:{Authorization:`Bearer ${p}`}}),a=g(t.data.data);j(a)}catch(t){console.error("Error fetching existing Department:",t)}},D=async()=>{try{const t=await i.get(`${m}/complaint/getactive`,{headers:{Authorization:`Bearer ${p}`}}),a=g(t.data.data);N(a)}catch(t){console.error("Error fetching existing Department:",t)}},T=t=>{if(t){const a=t.target.value,n=c==null?void 0:c.filter(o=>o.dept_name===a);k(n)}else setFilteredWards([])},_=async t=>{const a={grievanceIds:u,transferDetails:{...t},user:localStorage.getItem("name")};try{const n=localStorage.getItem("token"),o=await i.post(`${m}/new-grievance/updatemanytransfer`,a,{headers:{Authorization:`Bearer ${n}`}});o.status===200?(f.success("Bulk-Ticket Transfer Successfull"),d(),b()):(console.error("Error in posting data",o),f.error("Failed to Upload"))}catch(n){console.error("Error in posting data",n)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex  justify-center items-center  ",children:e.jsxs("div",{className:"bg-white  h-fit  font-lexend m-2 rounded-sm w-[500px]",children:[e.jsx("div",{className:"border-b-2 border-gray-300 mx-6",children:e.jsx("h1",{className:"text-xl font-medium pt-6 ",children:"Ticket Transfer"})}),e.jsx("form",{onSubmit:v(_),children:e.jsxs("div",{className:"  py-2 mx-6 my-3 gap-5 ",children:[e.jsxs("div",{className:"mb-3 flex items-baseline gap-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3 w-2/6",htmlFor:"dept_name",children:"Department"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-4/6 py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"dept_name",...x("dept_name"),onChange:T,children:[e.jsx("option",{value:"",children:"Select Department"}),y.map((t,a)=>e.jsx("option",{value:t.dept_name,children:t.dept_name},a))]})]}),r.dept_name&&e.jsx("p",{className:"text-red-500 text-end text-sm mb-2 -mt-2",children:r.dept_name.message}),e.jsxs("div",{className:"mb-3 flex items-baseline gap-3",children:[e.jsx("label",{className:"block text-gray-900 text-base font-normal mb-3 w-2/6",htmlFor:"complaint",children:"Complaint Type"}),e.jsxs("select",{className:"appearance-none border rounded-lg w-4/6 py-1.5 px-3 text-gray-500 leading-relaxed focus:outline-none focus:shadow-outline",id:"complaint",...x("complaint"),children:[e.jsx("option",{value:"",children:"Select complaint"}),S.map((t,a)=>e.jsx("option",{value:t.complaint_type_title,children:t.complaint_type_title},a))]})]}),r.complaint&&e.jsx("p",{className:"text-red-500 text-end text-sm mb-2 -mt-2",children:r.complaint.message}),e.jsxs("div",{className:"flex justify-end py-3 mx-10 my-3 gap-5",children:[e.jsx("div",{className:"border border-primary text-primary bg-none font-lexend rounded-3xl px-5 py-1.5",onClick:d,children:"Cancel"}),e.jsx("button",{className:"text-white bg-primary font-lexend rounded-3xl px-5 py-1.5",children:"Transfer"})]})]})})]})})};export{I as M};
